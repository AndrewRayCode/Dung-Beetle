/**
 *
 * Copyright (c) 2008, Opera Software ASA
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, 
 * with or without modification, are permitted provided 
 * that the following conditions are met:
 *
 *  - Redistributions of source code must retain the above copyright notice, 
 *    this list of conditions and the following disclaimer.
 *
 *  - Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 *
 *  - Neither the name of Opera Software nor the names of its contributors 
 *    may be used to endorse or promote products derived from this software 
 *    without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 * POSSIBILITY OF SUCH DAMAGE.
 * 
 **/



window.ui_strings||(window.ui_strings={})
window.ui_strings.lang_code="en";ui_strings.M_VIEW_LABEL_COMPOSITE_SCRIPTS='Scripts';ui_strings.M_VIEW_LABEL_COMPOSITE_DOM='DOM';ui_strings.M_VIEW_LABEL_COMPOSITE_ERROR_CONSOLE='Error Console';ui_strings.M_VIEW_LABEL_COMPOSITE_EXPORTS='Export';ui_strings.M_VIEW_LABEL_NETWORK='Network';ui_strings.M_VIEW_LABEL_SCRIPTS='Scripts';ui_strings.M_VIEW_LABEL_ENVIRONMENT='Environment';ui_strings.M_VIEW_LABEL_SOURCE='Source';ui_strings.M_VIEW_LABEL_COMMAND_LINE='Command Line';ui_strings.M_VIEW_LABEL_CALLSTACK='Call Stack';ui_strings.M_VIEW_LABEL_THREAD_LOG='Thread Log';ui_strings.M_VIEW_LABEL_FRAME_INSPECTION='Inspection';ui_strings.M_VIEW_LABEL_OBJECT_INSPECTION='Object Inspection';ui_strings.M_VIEW_LABEL_DOCUMENTS='Documents';ui_strings.M_VIEW_LABEL_STYLESHEETS='Stylesheets';ui_strings.M_VIEW_LABEL_DOM='DOM';ui_strings.M_VIEW_LABEL_STYLESHEET='Stylesheet';ui_strings.M_VIEW_LABEL_STYLES='Styles';ui_strings.M_VIEW_LABEL_DOM_ATTR='Properties';ui_strings.M_VIEW_LABEL_LAYOUT='Layout';ui_strings.M_VIEW_LABEL_ERROR_ALL='All';ui_strings.M_VIEW_LABEL_ERROR_SCRIPT='JavaScript';ui_strings.M_VIEW_LABEL_ERROR_JAVA='Java';ui_strings.M_VIEW_LABEL_ERROR_M2='Mail';ui_strings.M_VIEW_LABEL_ERROR_NETWORK='Network';ui_strings.M_VIEW_LABEL_ERROR_XML='XML';ui_strings.M_VIEW_LABEL_ERROR_HTML='HTML';ui_strings.M_VIEW_LABEL_ERROR_CSS='CSS';ui_strings.M_VIEW_LABEL_ERROR_XSLT='XSLT';ui_strings.M_VIEW_LABEL_ERROR_SVG='SVG';ui_strings.M_VIEW_LABEL_ERROR_BITTORRENT='Bittorrent';ui_strings.M_VIEW_LABEL_ERROR_VOICE='Voice';ui_strings.M_VIEW_LABEL_ERROR_WIDGET='Widget';ui_strings.M_VIEW_LABEL_ERROR_DRAGONFLY='Opera Dragonfly';ui_strings.M_VIEW_LABEL_COMPUTED_STYLE='Computed Style';ui_strings.M_VIEW_LABEL_STYLES='Styles';ui_strings.M_VIEW_LABEL_CONSOLE='Console';ui_strings.M_VIEW_LABEL_EXPORT='Export';ui_strings.M_VIEW_LABEL_REQUEST_LOG='Request log';ui_strings.M_VIEW_LABEL_RAW_REQUEST_INFO='Raw request';ui_strings.M_VIEW_LABEL_RAW_RESPONSE_INFO='Raw response';ui_strings.M_VIEW_LABEL_REQUEST_HEADERS='Request headers';ui_strings.M_VIEW_LABEL_RESPONSE_HEADERS='Response headers';ui_strings.M_VIEW_LABEL_REQUEST_INFO='Request info';ui_strings.M_VIEW_LABEL_RESPONSE_BODY='Response body';ui_strings.M_VIEW_LABEL_REQUEST_SUMMARY='Request summary';ui_strings.M_VIEW_LABEL_VIEWS='Views';ui_strings.S_SWITCH_SHOW_TAB_ALL='Show Tab All';ui_strings.S_SWITCH_SHOW_TAB_SCRIPT='Show Tab Script';ui_strings.S_SWITCH_SHOW_TAB_JAVA='Show Tab Java';ui_strings.S_SWITCH_SHOW_TAB_M2='Show Tab Mail';ui_strings.S_SWITCH_SHOW_TAB_NETWORK='Show Tab Network';ui_strings.S_SWITCH_SHOW_TAB_XML='Show Tab XML';ui_strings.S_SWITCH_SHOW_TAB_HTML='Show Tab HTML';ui_strings.S_SWITCH_SHOW_TAB_CSS='Show Tab CSS';ui_strings.S_SWITCH_SHOW_TAB_XSLT='Show Tab XSLT';ui_strings.S_SWITCH_SHOW_TAB_SVG='Show Tab SVG';ui_strings.S_SWITCH_SHOW_TAB_BITTORRENT='Show Tab Bittorrent';ui_strings.S_SWITCH_SHOW_TAB_VOICE='Show Tab Voice';ui_strings.S_SWITCH_SHOW_TAB_WIDGET='Show Tab Widget';ui_strings.S_SWITCH_SHOW_TAB_DRAGONFLY='Show Tab Opera Dragonfly';ui_strings.S_SWITCH_UPDATE_GLOBAL_SCOPE='Automatically update global scope';ui_strings.S_SWITCH_FIND_ELEMENT_BY_CLICKING='Find element by clicking';ui_strings.S_SWITCH_HIGHLIGHT_BY_MOUSE_OVER='Highlight by mouse hover';ui_strings.S_SWITCH_UPDATE_DOM_ON_NODE_REMOVE='Update DOM when a node is removed';ui_strings.S_SWITCH_USE_LOWER_CASE_TAG_NAMES='Use lower case tag names for text/html';ui_strings.S_SWITCH_SHOW_COMMENT_NODES='Show comment nodes';ui_strings.S_SWITCH_SHOW_ATTRIBUTES='Show attributes';ui_strings.S_SWITCH_SHOW_WHITE_SPACE_NODES='Show white space nodes';ui_strings.S_SWITCH_SHOW_DOM_INTREE_VIEW='Show DOM in tree view';ui_strings.S_SWITCH_USE_SHORTHAND_PROPERTIES='Use shorthand for properties';ui_strings.S_SWITCH_HIDE_INITIAL_VALUES='Hide initial values in computed styles';ui_strings.S_SWITCH_HIDE_SHORTHANDS='Hide shorthand for computed styles';ui_strings.S_SWITCH_HIDE_EMPTY_STRINGS='Hide empty strings and null values';ui_strings.S_SWITCH_REMOTE_DEBUG='Remote Debug';ui_strings.S_SWITCH_SHOW_VIEWS_MENU="Show Views menu";ui_strings.S_SWITCH_RELOAD_SCRIPTS_AUTOMATICALLY="Reload documents automatically on selecting a window"
ui_strings.S_SWITCH_DETACH_WINDOW="Undock into separate window";ui_strings.S_SWITCH_ATTACH_WINDOW="Dock to main window";ui_strings.S_SWITCH_SHOW_INITIAL_VALUES='Hide initial values in computed styles';ui_strings.S_SWITCH_SHOW_SHORTHANDS='Hide shorthands in computed styles view';ui_strings.S_SWITCH_CREATE_SHORTHANDS='Use shorthands for properties';ui_strings.S_SWITCH_SHOW_SIBLINGS_IN_BREAD_CRUMB='Show Siblings in Breadcrumb';ui_strings.S_SWITCH_SHOW_ID_AND_CLASSES_IN_BREAD_CRUMB="Show id's and classes in Breadcrumb";ui_strings.S_SWITCH_SHOW_ONLY_NORMAL_AND_GADGETS_TYPE_WINDOWS="Show only normal windows and widgets ( unchecked Dragonfly will show any type of Opera window )";ui_strings.S_SWITCH_SCROLL_INTO_VIEW_ON_FIRST_SPOTLIGHT='Scroll into View on first Spotlight';ui_strings.S_SWITCH_SHOW_ECMA_ERRORS_IN_COMMAND_LINE="Show ECMA Script Errors of the Error Console";ui_strings.S_SWITCH_EXPAND_ALL='Expand all';ui_strings.S_BUTTON_LABEL_CONTINUE='Continue (F8)';ui_strings.S_BUTTON_LABEL_STEP_OVER='Step Over (F10)';ui_strings.S_BUTTON_LABEL_STEP_INTO='Step Into (F11)';ui_strings.S_BUTTON_LABEL_STEP_OUT='Step Out (Shift F11)';ui_strings.S_BUTTON_LABEL_STOP_AT_THREAD='Stop at new script';ui_strings.S_BUTTON_LABEL_AT_EXCEPTION='Stop at exception';ui_strings.S_BUTTON_LABEL_AT_ERROR='Stop at error';ui_strings.S_BUTTON_LABEL_AT_ABORT='Stop at abort';ui_strings.S_BUTTON_LABEL_RELOAD_HOST='Reload the selected window in the browser';ui_strings.S_BUTTON_LABEL_SELECT_WINDOW="Select the window you'd like to debug";ui_strings.S_BUTTON_LABEL_GET_THE_WOHLE_TREE='Expand the DOM tree';ui_strings.S_BUTTON_LABEL_EXPORT_DOM='Export current DOM view';ui_strings.S_BUTTON_LABEL_HIDE_DEFAULT_PROPS_IN_GLOBAL_SCOPE='Hide default properties in global scope';ui_strings.S_BUTTON_LABEL_LOG_THREADS='Log threads';ui_strings.S_BUTTON_LABEL_CLEAR_LOG='Clear thread log';ui_strings.S_BUTTON_LABEL_EXPORT_LOG='Export thread log';ui_strings.S_BUTTON_LABEL_SETTINGS='Settings';ui_strings.S_BUTTON_LABEL_CLEAR_LOG='Clear Log';ui_strings.S_BUTTON_LABEL_CLOSE_WINDOW='Close Window';ui_strings.S_BUTTON_TEXT_APPLY='Apply';ui_strings.S_BUTTON_CLEAR_REQUEST_LOG='Clear request log';ui_strings.S_BUTTON_SHOW_REQUEST_SUMMARY='Summary';ui_strings.S_BUTTON_SHOW_REQUEST_HEADERS='Headers';ui_strings.S_BUTTON_SHOW_REQUEST_RAW='Raw';ui_strings.S_MENU_SELECT_ACTIVE_WINDOW='Select Active Window';ui_strings.S_MENU_RELOAD_DEBUG_CONTEXT='Reload Debug Context';ui_strings.S_LABEL_STATUS_INDICATOR='Status indicator for the browser and the debugger';ui_strings.S_LABEL_PORT='Port';ui_strings.S_SELECT_WINDOW_EMPTY='Select a window';ui_strings.S_INPUT_DEFAULT_TEXT_SEARCH='Search';ui_strings.S_INPUT_DEFAULT_TEXT_FILTER='Quick find';ui_strings.S_COLUMN_LABEL_FILE="File";ui_strings.S_COLUMN_LABEL_LINE="Line";ui_strings.S_COLUMN_LABEL_ERROR="Error";ui_strings.S_SPEC_LINK_LABEL="spec";ui_strings.S_HTTP_LABEL_URL="URL";ui_strings.S_HTTP_LABEL_RESPONSE="Response";ui_strings.S_HTTP_LABEL_METHOD="Method";ui_strings.S_HTTP_LABEL_HOST="Host";ui_strings.S_HTTP_LABEL_PATH="Path";ui_strings.S_HTTP_LABEL_QUERY_ARGS="Query arguments";ui_strings.S_INFO_RELOAD_FOR_SCRIPT='Click the reload button above to fetch the scripts for the selected window';ui_strings.S_INFO_WINDOW_HAS_NO_RUNTIME='This window has no runtime';ui_strings.S_INFO_RUNTIME_HAS_NO_SCRIPTS='This document has no scripts';ui_strings.S_INFO_DOCUMENT_HAS_NO_STYLESHEETS='This document has no stylesheet';ui_strings.S_INFO_STYLESHEET_HAS_NO_RULES='This stylesheet has no rules';ui_strings.S_INFO_DOCUMNENT_LOADING='Opera Dragonfly is loading ...';ui_strings.M_SETTING_LABEL_GENERAL='General';ui_strings.S_INFO_WRONG_START="Opera Dragonfly cannot be used in this way.\n"+"Either set the current url in\n\n"+"   opera:config > Developer Tools > Developer Tools URL\n\n"+"or setup a debugger environment with a proxy and server."
ui_strings.S_INFO_WAITING_FOR_CONNECTION="Opera Dragonfly is waiting for a connection on port %s.\n"+"Please enter opera:debug in your device's URL field to connect.";ui_strings.S_INFO_SERVICE_NOT_AVAILABLE="Service is not available: %s";ui_strings.S_INFO_NO_RUNTIME_SELECTED="Select a runtime";ui_strings.S_INFO_NO_COMPATIBLE_VERSION="There is no compatible Opera Dragonfly version.";ui_strings.S_CONFIRM_LOAD_COMPATIBLE_VERSION="The protocol version of Opera does not match the one which Opera Dragonfly is using.\n\nTry to load a compatible version?";ui_strings.S_TEXT_CALL_STACK_FRAME_LINE="%(FUNCTION_NAME)s: Line %(LINE_NUMBER)s (Script ID %(SCRIPT_ID)s)";ui_strings.M_VIEW_SUB_LABEL_METRICS="Metrics";ui_strings.M_VIEW_SUB_LABEL_PARENT_OFFSETS="Parent Offsets";ui_strings.M_VIEW_SUB_LABEL_OFFSET_VALUES="Offset Values";ui_strings.S_TEXT_ENVIRONMENT_PROTOCOL_VERSION="Protocol Version";ui_strings.S_TEXT_ENVIRONMENT_OPERATING_SYSTEM="Operating System";ui_strings.S_TEXT_ENVIRONMENT_PLATFORM="Platform";ui_strings.S_TEXT_ENVIRONMENT_USER_AGENT="User Agent";ui_strings.S_TEXT_ENVIRONMENT_DRAGONFLY_VERSION="Opera Dragonfly Version";ui_strings.S_TEXT_ENVIRONMENT_REVISION_NUMBER="Revision Number";ui_strings.S_TEXT_ECMA_SCRIPT_TYPE_INLINE="Inline";ui_strings.S_TEXT_ECMA_SCRIPT_TYPE_LINKED="Linked";ui_strings.S_TEXT_ECMA_SCRIPT_TYPE_UNKNOWN="Unknown";ui_strings.S_TEXT_ECMA_SCRIPT_SCRIPT_ID="Script id";ui_strings.S_TEXT_STATUS_SEARCH="Matches for \"%(SEARCH_TERM)s\": Match %(SEARCH_COUNT_INDEX)s out of %(SEARCH_COUNT_TOTAL)s";ui_strings.S_TEXT_STATUS_SEARCH_NO_MATCH="No match for \"%(SEARCH_TERM)s\"";ui_strings.S_TEXT_NO_REQUEST_SELECTED="No request selected.";ui_strings.DRAGONFLY_INFO_MESSAGE="Opera Dragonfly info message:\n";ui_strings.S_HTTP_REQUEST_IN_PROGRESS="Request in progress";ui_strings.S_NONE="None";window.ui_strings||(window.ui_strings={})
window.ui_strings.lang_code="en";ui_strings.M_VIEW_LABEL_COMPOSITE_SCRIPTS='Scripts';ui_strings.M_VIEW_LABEL_COMPOSITE_DOM='DOM';ui_strings.M_VIEW_LABEL_COMPOSITE_ERROR_CONSOLE='Error Console';ui_strings.M_VIEW_LABEL_COMPOSITE_EXPORTS='Export';ui_strings.M_VIEW_LABEL_NETWORK='Network';ui_strings.M_VIEW_LABEL_SCRIPTS='Scripts';ui_strings.M_VIEW_LABEL_ENVIRONMENT='Environment';ui_strings.M_VIEW_LABEL_SOURCE='Source';ui_strings.M_VIEW_LABEL_COMMAND_LINE='Command Line';ui_strings.M_VIEW_LABEL_CALLSTACK='Call Stack';ui_strings.M_VIEW_LABEL_THREAD_LOG='Thread Log';ui_strings.M_VIEW_LABEL_FRAME_INSPECTION='Inspection';ui_strings.M_VIEW_LABEL_OBJECT_INSPECTION='Object Inspection';ui_strings.M_VIEW_LABEL_DOCUMENTS='Documents';ui_strings.M_VIEW_LABEL_STYLESHEETS='Stylesheets';ui_strings.M_VIEW_LABEL_DOM='DOM';ui_strings.M_VIEW_LABEL_STYLESHEET='Stylesheet';ui_strings.M_VIEW_LABEL_STYLES='Styles';ui_strings.M_VIEW_LABEL_DOM_ATTR='Properties';ui_strings.M_VIEW_LABEL_LAYOUT='Layout';ui_strings.M_VIEW_LABEL_ERROR_ALL='All';ui_strings.M_VIEW_LABEL_ERROR_SCRIPT='JavaScript';ui_strings.M_VIEW_LABEL_ERROR_JAVA='Java';ui_strings.M_VIEW_LABEL_ERROR_M2='Mail';ui_strings.M_VIEW_LABEL_ERROR_NETWORK='Network';ui_strings.M_VIEW_LABEL_ERROR_XML='XML';ui_strings.M_VIEW_LABEL_ERROR_HTML='HTML';ui_strings.M_VIEW_LABEL_ERROR_CSS='CSS';ui_strings.M_VIEW_LABEL_ERROR_XSLT='XSLT';ui_strings.M_VIEW_LABEL_ERROR_SVG='SVG';ui_strings.M_VIEW_LABEL_ERROR_BITTORRENT='Bittorrent';ui_strings.M_VIEW_LABEL_ERROR_VOICE='Voice';ui_strings.M_VIEW_LABEL_ERROR_WIDGET='Widget';ui_strings.M_VIEW_LABEL_ERROR_DRAGONFLY='Opera Dragonfly';ui_strings.M_VIEW_LABEL_COMPUTED_STYLE='Computed Style';ui_strings.M_VIEW_LABEL_STYLES='Styles';ui_strings.M_VIEW_LABEL_CONSOLE='Console';ui_strings.M_VIEW_LABEL_EXPORT='Export';ui_strings.M_VIEW_LABEL_REQUEST_LOG='Request log';ui_strings.M_VIEW_LABEL_RAW_REQUEST_INFO='Raw request';ui_strings.M_VIEW_LABEL_RAW_RESPONSE_INFO='Raw response';ui_strings.M_VIEW_LABEL_REQUEST_HEADERS='Request headers';ui_strings.M_VIEW_LABEL_RESPONSE_HEADERS='Response headers';ui_strings.M_VIEW_LABEL_REQUEST_INFO='Request info';ui_strings.M_VIEW_LABEL_RESPONSE_BODY='Response body';ui_strings.M_VIEW_LABEL_REQUEST_SUMMARY='Request summary';ui_strings.M_VIEW_LABEL_VIEWS='Views';ui_strings.S_SWITCH_SHOW_TAB_ALL='Show Tab All';ui_strings.S_SWITCH_SHOW_TAB_SCRIPT='Show Tab Script';ui_strings.S_SWITCH_SHOW_TAB_JAVA='Show Tab Java';ui_strings.S_SWITCH_SHOW_TAB_M2='Show Tab Mail';ui_strings.S_SWITCH_SHOW_TAB_NETWORK='Show Tab Network';ui_strings.S_SWITCH_SHOW_TAB_XML='Show Tab XML';ui_strings.S_SWITCH_SHOW_TAB_HTML='Show Tab HTML';ui_strings.S_SWITCH_SHOW_TAB_CSS='Show Tab CSS';ui_strings.S_SWITCH_SHOW_TAB_XSLT='Show Tab XSLT';ui_strings.S_SWITCH_SHOW_TAB_SVG='Show Tab SVG';ui_strings.S_SWITCH_SHOW_TAB_BITTORRENT='Show Tab Bittorrent';ui_strings.S_SWITCH_SHOW_TAB_VOICE='Show Tab Voice';ui_strings.S_SWITCH_SHOW_TAB_WIDGET='Show Tab Widget';ui_strings.S_SWITCH_SHOW_TAB_DRAGONFLY='Show Tab Opera Dragonfly';ui_strings.S_SWITCH_UPDATE_GLOBAL_SCOPE='Automatically update global scope';ui_strings.S_SWITCH_FIND_ELEMENT_BY_CLICKING='Find element by clicking';ui_strings.S_SWITCH_HIGHLIGHT_BY_MOUSE_OVER='Highlight by mouse hover';ui_strings.S_SWITCH_UPDATE_DOM_ON_NODE_REMOVE='Update DOM when a node is removed';ui_strings.S_SWITCH_USE_LOWER_CASE_TAG_NAMES='Use lower case tag names for text/html';ui_strings.S_SWITCH_SHOW_COMMENT_NODES='Show comment nodes';ui_strings.S_SWITCH_SHOW_ATTRIBUTES='Show attributes';ui_strings.S_SWITCH_SHOW_WHITE_SPACE_NODES='Show white space nodes';ui_strings.S_SWITCH_SHOW_DOM_INTREE_VIEW='Show DOM in tree view';ui_strings.S_SWITCH_USE_SHORTHAND_PROPERTIES='Use shorthand for properties';ui_strings.S_SWITCH_HIDE_INITIAL_VALUES='Hide initial values in computed styles';ui_strings.S_SWITCH_HIDE_SHORTHANDS='Hide shorthand for computed styles';ui_strings.S_SWITCH_HIDE_EMPTY_STRINGS='Hide empty strings and null values';ui_strings.S_SWITCH_REMOTE_DEBUG='Remote Debug';ui_strings.S_SWITCH_SHOW_VIEWS_MENU="Show Views menu";ui_strings.S_SWITCH_RELOAD_SCRIPTS_AUTOMATICALLY="Reload documents automatically on selecting a window"
ui_strings.S_SWITCH_DETACH_WINDOW="Undock into separate window";ui_strings.S_SWITCH_ATTACH_WINDOW="Dock to main window";ui_strings.S_SWITCH_SHOW_INITIAL_VALUES='Hide initial values in computed styles';ui_strings.S_SWITCH_SHOW_SHORTHANDS='Hide shorthands in computed styles view';ui_strings.S_SWITCH_CREATE_SHORTHANDS='Use shorthands for properties';ui_strings.S_SWITCH_SHOW_SIBLINGS_IN_BREAD_CRUMB='Show Siblings in Breadcrumb';ui_strings.S_SWITCH_SHOW_ID_AND_CLASSES_IN_BREAD_CRUMB="Show id's and classes in Breadcrumb";ui_strings.S_SWITCH_SHOW_ONLY_NORMAL_AND_GADGETS_TYPE_WINDOWS="Show only normal windows and widgets ( unchecked Dragonfly will show any type of Opera window )";ui_strings.S_SWITCH_SCROLL_INTO_VIEW_ON_FIRST_SPOTLIGHT='Scroll into View on first Spotlight';ui_strings.S_SWITCH_SHOW_ECMA_ERRORS_IN_COMMAND_LINE="Show ECMA Script Errors of the Error Console";ui_strings.S_SWITCH_EXPAND_ALL='Expand all';ui_strings.S_BUTTON_LABEL_CONTINUE='Continue (F8)';ui_strings.S_BUTTON_LABEL_STEP_OVER='Step Over (F10)';ui_strings.S_BUTTON_LABEL_STEP_INTO='Step Into (F11)';ui_strings.S_BUTTON_LABEL_STEP_OUT='Step Out (Shift F11)';ui_strings.S_BUTTON_LABEL_STOP_AT_THREAD='Stop at new script';ui_strings.S_BUTTON_LABEL_AT_EXCEPTION='Stop at exception';ui_strings.S_BUTTON_LABEL_AT_ERROR='Stop at error';ui_strings.S_BUTTON_LABEL_AT_ABORT='Stop at abort';ui_strings.S_BUTTON_LABEL_RELOAD_HOST='Reload the selected window in the browser';ui_strings.S_BUTTON_LABEL_SELECT_WINDOW="Select the window you'd like to debug";ui_strings.S_BUTTON_LABEL_GET_THE_WOHLE_TREE='Expand the DOM tree';ui_strings.S_BUTTON_LABEL_EXPORT_DOM='Export current DOM view';ui_strings.S_BUTTON_LABEL_HIDE_DEFAULT_PROPS_IN_GLOBAL_SCOPE='Hide default properties in global scope';ui_strings.S_BUTTON_LABEL_LOG_THREADS='Log threads';ui_strings.S_BUTTON_LABEL_CLEAR_LOG='Clear thread log';ui_strings.S_BUTTON_LABEL_EXPORT_LOG='Export thread log';ui_strings.S_BUTTON_LABEL_SETTINGS='Settings';ui_strings.S_BUTTON_LABEL_CLEAR_LOG='Clear Log';ui_strings.S_BUTTON_LABEL_CLOSE_WINDOW='Close Window';ui_strings.S_BUTTON_TEXT_APPLY='Apply';ui_strings.S_BUTTON_CLEAR_REQUEST_LOG='Clear request log';ui_strings.S_BUTTON_SHOW_REQUEST_SUMMARY='Summary';ui_strings.S_BUTTON_SHOW_REQUEST_HEADERS='Headers';ui_strings.S_BUTTON_SHOW_REQUEST_RAW='Raw';ui_strings.S_MENU_SELECT_ACTIVE_WINDOW='Select Active Window';ui_strings.S_MENU_RELOAD_DEBUG_CONTEXT='Reload Debug Context';ui_strings.S_LABEL_STATUS_INDICATOR='Status indicator for the browser and the debugger';ui_strings.S_LABEL_PORT='Port';ui_strings.S_SELECT_WINDOW_EMPTY='Select a window';ui_strings.S_INPUT_DEFAULT_TEXT_SEARCH='Search';ui_strings.S_INPUT_DEFAULT_TEXT_FILTER='Quick find';ui_strings.S_COLUMN_LABEL_FILE="File";ui_strings.S_COLUMN_LABEL_LINE="Line";ui_strings.S_COLUMN_LABEL_ERROR="Error";ui_strings.S_SPEC_LINK_LABEL="spec";ui_strings.S_HTTP_LABEL_URL="URL";ui_strings.S_HTTP_LABEL_RESPONSE="Response";ui_strings.S_HTTP_LABEL_METHOD="Method";ui_strings.S_HTTP_LABEL_HOST="Host";ui_strings.S_HTTP_LABEL_PATH="Path";ui_strings.S_HTTP_LABEL_QUERY_ARGS="Query arguments";ui_strings.S_INFO_RELOAD_FOR_SCRIPT='Click the reload button above to fetch the scripts for the selected window';ui_strings.S_INFO_WINDOW_HAS_NO_RUNTIME='This window has no runtime';ui_strings.S_INFO_RUNTIME_HAS_NO_SCRIPTS='This document has no scripts';ui_strings.S_INFO_DOCUMENT_HAS_NO_STYLESHEETS='This document has no stylesheet';ui_strings.S_INFO_STYLESHEET_HAS_NO_RULES='This stylesheet has no rules';ui_strings.S_INFO_DOCUMNENT_LOADING='Opera Dragonfly is loading ...';ui_strings.M_SETTING_LABEL_GENERAL='General';ui_strings.S_INFO_WRONG_START="Opera Dragonfly cannot be used in this way.\n"+"Either set the current url in\n\n"+"   opera:config > Developer Tools > Developer Tools URL\n\n"+"or setup a debugger environment with a proxy and server."
ui_strings.S_INFO_WAITING_FOR_CONNECTION="Opera Dragonfly is waiting for a connection on port %s.\n"+"Please enter opera:debug in your device's URL field to connect.";ui_strings.S_INFO_SERVICE_NOT_AVAILABLE="Service is not available: %s";ui_strings.S_INFO_NO_RUNTIME_SELECTED="Select a runtime";ui_strings.S_INFO_NO_COMPATIBLE_VERSION="There is no compatible Opera Dragonfly version.";ui_strings.S_CONFIRM_LOAD_COMPATIBLE_VERSION="The protocol version of Opera does not match the one which Opera Dragonfly is using.\n\nTry to load a compatible version?";ui_strings.S_TEXT_CALL_STACK_FRAME_LINE="%(FUNCTION_NAME)s: Line %(LINE_NUMBER)s (Script ID %(SCRIPT_ID)s)";ui_strings.M_VIEW_SUB_LABEL_METRICS="Metrics";ui_strings.M_VIEW_SUB_LABEL_PARENT_OFFSETS="Parent Offsets";ui_strings.M_VIEW_SUB_LABEL_OFFSET_VALUES="Offset Values";ui_strings.S_TEXT_ENVIRONMENT_PROTOCOL_VERSION="Protocol Version";ui_strings.S_TEXT_ENVIRONMENT_OPERATING_SYSTEM="Operating System";ui_strings.S_TEXT_ENVIRONMENT_PLATFORM="Platform";ui_strings.S_TEXT_ENVIRONMENT_USER_AGENT="User Agent";ui_strings.S_TEXT_ENVIRONMENT_DRAGONFLY_VERSION="Opera Dragonfly Version";ui_strings.S_TEXT_ENVIRONMENT_REVISION_NUMBER="Revision Number";ui_strings.S_TEXT_ECMA_SCRIPT_TYPE_INLINE="Inline";ui_strings.S_TEXT_ECMA_SCRIPT_TYPE_LINKED="Linked";ui_strings.S_TEXT_ECMA_SCRIPT_TYPE_UNKNOWN="Unknown";ui_strings.S_TEXT_ECMA_SCRIPT_SCRIPT_ID="Script id";ui_strings.S_TEXT_STATUS_SEARCH="Matches for \"%(SEARCH_TERM)s\": Match %(SEARCH_COUNT_INDEX)s out of %(SEARCH_COUNT_TOTAL)s";ui_strings.S_TEXT_STATUS_SEARCH_NO_MATCH="No match for \"%(SEARCH_TERM)s\"";ui_strings.S_TEXT_NO_REQUEST_SELECTED="No request selected.";ui_strings.DRAGONFLY_INFO_MESSAGE="Opera Dragonfly info message:\n";ui_strings.S_HTTP_REQUEST_IN_PROGRESS="Request in progress";ui_strings.S_NONE="None";if(!this.JSON){JSON=function(){function f(n){return n<10?'0'+n:n;}
Date.prototype.toJSON=function(){return this.getUTCFullYear()+'-'+f(this.getUTCMonth()+1)+'-'+f(this.getUTCDate())+'T'+f(this.getUTCHours())+':'+f(this.getUTCMinutes())+':'+f(this.getUTCSeconds())+'Z';};var escapeable=/["\\\x00-\x1f\x7f-\x9f]/g,gap,indent,meta={'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'},rep;function quote(string){return escapeable.test(string)?'"'+string.replace(escapeable,function(a){var c=meta[a];if(typeof c==='string'){return c;}
c=a.charCodeAt();return'\\u00'+Math.floor(c/16).toString(16)+(c%16).toString(16);})+'"':'"'+string+'"';}
function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==='object'&&typeof value.toJSON==='function'){value=value.toJSON(key);}
if(typeof rep==='function'){value=rep.call(holder,key,value);}
switch(typeof value){case'string':return quote(value);case'number':return isFinite(value)?String(value):'null';case'boolean':case'null':return String(value);case'object':if(!value){return'null';}
gap+=indent;partial=[];if(typeof value.length==='number'&&!(value.propertyIsEnumerable('length'))){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||'null';}
v=partial.length===0?'[]':gap?'[\n'+gap+partial.join(',\n'+gap)+'\n'+mind+']':'['+partial.join(',')+']';gap=mind;return v;}
if(typeof rep==='object'){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==='string'){v=str(k,value,rep);if(v){partial.push(quote(k)+(gap?': ':':')+v);}}}}else{for(k in value){v=str(k,value,rep);if(v){partial.push(quote(k)+(gap?': ':':')+v);}}}
v=partial.length===0?'{}':gap?'{\n'+gap+partial.join(',\n'+gap)+'\n'+mind+'}':'{'+partial.join(',')+'}';gap=mind;return v;}}
return{stringify:function(value,replacer,space){var i;gap='';indent='';if(space){if(typeof space==='number'){for(i=0;i<space;i+=1){indent+=' ';}}else if(typeof space==='string'){indent=space;}}
if(!replacer){rep=function(key,value){if(!Object.hasOwnProperty.call(this,key)){return undefined;}
return value;};}else if(typeof replacer==='function'||(typeof replacer==='object'&&typeof replacer.length==='number')){rep=replacer;}else{throw new Error('JSON.stringify');}
return str('',{'':value});},parse:function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==='object'){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v;}else{delete value[k];}}}}
return reviver.call(holder,key,value);}
if(/^[\],:{}\s]*$/.test(text.replace(/\\["\\\/bfnrtu]/g,'@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']').replace(/(?:^|:|,)(?:\s*\[)+/g,''))){j=eval('('+text+')');return typeof reviver==='function'?walk({'':j},''):j;}
throw new SyntaxError('JSON.parse');},quote:quote};}();}
Element.prototype.___add=Document.prototype.___add=function(){if(arguments.length){if(arguments[0]){var doc=this.nodeType==9?this:this.ownerDocument;var i=0,ele=(typeof arguments[0])=='string'?doc.createElement(arguments[i++]):this;var prop='',is_array=false,arg=arguments[i];while((is_array=arg instanceof Array)||
(((typeof arg=='string')||(typeof arg=='number'))&&(((arguments.length-i)%2)||arguments[i+1]instanceof Array))){if(is_array){ele.___add.apply(ele,arg);}
else if(arg){ele.appendChild(doc.createTextNode(arg));}
arg=arguments[++i];}
for(;arguments[i];i+=2){if(/string/.test(typeof arguments[i+1])){ele.setAttribute(arguments[i],arguments[i+1]);}
else
{ele[arguments[i]]=arguments[i+1];}}
if(this.nodeType==1&&(this!=ele)){this.appendChild(ele);}
return ele;}
else
{return this.appendChild(doc.createTextNode(arguments[1]));}}
return null;}
Element.prototype.___add_inner=Document.prototype.___add_inner=function(){if(arguments.length){if(arguments[0]){var i=1;var prop='',is_array=false,arg=arguments[i];var head="<"+arguments[0];var content='';var attrs=' ';while((is_array=arg instanceof Array)||
(((typeof arg=='string')||(typeof arg=='number'))&&(((arguments.length-i)%2)||arguments[i+1]instanceof Array))){if(is_array){content+=Element.prototype.___add_inner.apply(null,arg);}
else if(arg){content+=arg.replace(/</g,"&lt;").replace(/>/g,"&gt;");}
arg=arguments[++i];}
for(;arguments[i];i+=2){attrs+=arguments[i]+"=\u0022"+arguments[i+1]+"\u0022";}
head+=attrs+">"+content+"</"+arguments[0]+">";if(this&&this.nodeType==1){this.innerHTML+=head;}
return head;}}
return '';}
Element.prototype.render=Document.prototype.render=function(template){return this.___add.apply(this,template);}
Element.prototype.renderInner=Document.prototype.renderInner=function(template){return this.___add_inner.apply(this,template);}
Element.prototype.clearAndRender=function(template){this.innerHTML='';return this.___add.apply(this,template);}
Element.prototype.addClass=function(name){if(!(new RegExp('\\b'+name+'\\b')).test(this.className)){this.className=(this.className?this.className+' ':'')+name;}
return this;}
Element.prototype.removeClass=function(name){var re=new RegExp(name+' ?| ?'+name);if(re.test(this.className)){this.className=this.className.replace(re,'');}
return this;}
Element.prototype.hasClass=function(name){return(new RegExp('(?:^| +)'+name+'(?: +|$)')).test(this.className)}
Element.prototype.swapClass=function(from,to){if(this.hasClass(from)){this.removeClass(from);this.addClass(to);}}
Element.prototype.getNextSiblingElement=function(){var next=this.nextSibling;while(next&&next.nodeType!=1){next=next.nextSibling;}
return next;}
Element.prototype.getTop=function(){var c=this,o_p=null,top=c.offsetTop;while(o_p=c.offsetParent){top+=o_p.offsetTop;c=o_p;}
return top;}
Element.prototype.insertAfter=function(node,target){var nextElement=target.nextSibling;while(nextElement&&nextElement.nodeType!=1){nextElement=nextElement.nextSibling;}
if(nextElement){this.insertBefore(node,nextElement);}
else
{this.appendChild(node);}}
Element.prototype.getChildElements=function(){var children=this.childNodes,ret=[],c=null,i=0;for(;c=children[i];i++){if(c.nodeType==1){ret[ret.length]=c;}}
return ret;}
Element.prototype.releaseEvent=function(name,custom_props){var event=document.createEvent('Events'),prop='';event.initEvent(name,true,true);if(custom_props){for(prop in custom_props){event[prop]=custom_props[prop];}}
this.dispatchEvent(event);}
Element.prototype.getWidth=function(e){var style=window.getComputedStyle(this,null);return this.offsetWidth
-parseInt(style['paddingLeft'])
-parseInt(style['paddingRight'])
-parseInt(style['borderLeftWidth'])
-parseInt(style['borderRightWidth']);}
Element.prototype.spliceInnerHTML=function(str){this.insertAdjacentHTML('afterEnd',str);}
Element.prototype.getFirst=function(nodeName){return this.getElementsByTagName(nodeName)[0];}
Element.prototype.getLast=function(nodeName){var all=this.getElementsByTagName(nodeName);return all[all.length-1];}
Element.prototype.getPreviousSameNamed=function(current){var
nodeName=current&&current.nodeName,all=this.getElementsByTagName(nodeName),cur=null,i=0;for(;(cur=all[i])&&cur!=current;i++);return cur&&all[i-1]||null;}
Element.prototype.getNextSameNamed=function(current){var
nodeName=current&&current.nodeName,all=this.getElementsByTagName(nodeName),cur=null,i=0;for(;(cur=all[i])&&cur!=current;i++);return cur&&all[i+1]||null;}
Element.prototype.getNextSameNamedSibling=function(target){var
next=this.nextSibling,name=this.nodeName;while(next&&next.nodeName!=name){next=next.nextSibling;}
return next;}
Element.prototype.getPreviousSameNamedSibling=function(target){var
previous=this.previousSibling,name=this.nodeName;while(previous&&previous.nodeName!=name){previous=previous.previousSibling;}
return previous;}
Element.prototype.getNextWithFilter=function(root_context,filter){var cursor=this;while((cursor=cursor.getNextInFlow(root_context))&&!filter(cursor,this));return cursor;}
Element.prototype.getPreviousWithFilter=function(root_context,filter){var cursor=this;while((cursor=cursor.getPreviousInFlow(root_context))&&!filter(cursor,this));return cursor;}
Element.prototype.getNextInFlow=function(root_context){var
next=this.firstElementChild||this.nextElementSibling,cursor=this;while(!next&&(cursor=cursor.parentNode)&&cursor!=root_context){next=cursor.nextElementSibling;}
return next;}
Element.prototype.getPreviousInFlow=function(root_context){var
previous=this.previousElementSibling,parent=this.parentNode,cursor=previous;while(cursor&&cursor.lastElementChild&&(cursor=cursor.lastElementChild));return cursor||previous||parent!=root_context&&parent||null;}
Element.prototype.scrollSoftIntoView=function(){var scrollContainer=this.offsetParent;var min_top=20;if(scrollContainer&&scrollContainer.offsetHeight<scrollContainer.scrollHeight){if(this.offsetTop<scrollContainer.scrollTop+min_top){scrollContainer.scrollTop=this.offsetTop-min_top;}
else if(this.offsetTop+this.offsetHeight>scrollContainer.scrollTop+scrollContainer.offsetHeight-min_top){scrollContainer.scrollTop=this.offsetTop+this.offsetHeight-scrollContainer.offsetHeight+min_top;}}}
Element.prototype.scrollSoftIntoContainerView=function(){var scrollContainer=this.offsetParent;while(scrollContainer&&scrollContainer!=document.body&&scrollContainer.nodeName!="container"){scrollContainer=scrollContainer.offsetParent;}
var min_top=20;if(scrollContainer&&scrollContainer.offsetHeight<scrollContainer.scrollHeight){if(this.offsetTop<scrollContainer.scrollTop+min_top){scrollContainer.scrollTop=this.offsetTop-min_top;}
else if(this.offsetTop+this.offsetHeight>scrollContainer.scrollTop+scrollContainer.offsetHeight-min_top){scrollContainer.scrollTop=this.offsetTop+this.offsetHeight-scrollContainer.offsetHeight+min_top;}}}
Node.prototype.getNodeData=function(nodeName){var node=this.getElementsByTagName(nodeName)[0];if(node){return node.textContent.replace(/</g,'&lt;');}
return null;}
Node.prototype.getAttributeFromNode=function(nodeName,attr){var node=this.getElementsByTagName(nodeName)[0];if(node){return node.getAttribute(attr);}
return null;};NodeList.prototype.indexOf=function(item){for(var cursor=null,i=0;cursor=this[i];i++){if(cursor==item){return i;}}
return -1;}
StyleSheetList.prototype.getPropertyValue=function(selector,property){var sheet=null,i=0,j=0,rules=null,rule=null;for(;sheet=this[i];i++){rules=sheet.cssRules;for(j=0;(rule=rules[j])&&!(rule.type==1&&rule.selectorText==selector);j++);if(rule){return rule.style.getPropertyValue(property);}}
return '';};(function(){if(!document.getElementsByClassName){Document.prototype.getElementsByClassName=Element.prototype.getElementsByClassName=function(){var eles=this.getElementsByTagName("*"),ele=null,ret=[],c_n='',cursor=null,i=0,j=0;for(;c_n=arguments[i];i++){arguments[i]=new RegExp('(?:^| +)'+c_n+'(?: +|$)');}
for(i=0;ele=eles[i];i++){c_n=ele.className;for(j=0;(cursor=arguments[j])&&cursor.test(c_n);j++);if(!cursor){ret[ret.length]=ele;}}
return ret;}}})();var messages=new function(){var __listeners={};this.addListener=function(key,cb){if(__listeners[key]){__listeners[key].push(cb);}
else
{__listeners[key]=[cb];}}
this.removeListener=function(key,cb){var cur=null,listeners=__listeners[key],i=0;if(listeners){for(;cur=listeners[i];i++){if(cur==cb){listeners.splice(i,1);i--;}}}}
this.post=function(key,msg){msg=msg||{};var listeners=__listeners[key],cb=null,i=0;msg.type=key;if(listeners){for(;cb=listeners[i];i++){cb(msg);}}}}
var proxy=new function(){var self=this;this.configure=function(host,port){if(host)__host=host;if(port)__port=port;this.GET("/services",parseConfigureResponse)}
var parseConfigureResponse=function(xml,xhr){var service_elts=xml.getElementsByTagName("service");var services=new Array();for(var i=0;i<service_elts.length;i++){services.push(service_elts[i].getAttribute("name"));}
self.services=services;self.onsetup(xhr);}
this.onsetup=function(){}
this.enable=function(service_name){var i;for(i=0;i<this.services.length&&this.services[i]!=service_name;i++);if(i==this.services.length){return false;}
proxy.GET("/enable/"+service_name,function(){});return true;}
this.GET=function(msg,cb){var x=new XMLHttpRequest;x.onload=function(){if(this.status!=200){throw "Message failed, Status: "+this.status+", msg: "+msg;}
self.onReceive(x);var xml=this.responseXML;if(xml.documentElement==null){if(client){client.onquit();return;}
else
{throw "Message failed, GET, empty document: "+this.responseText;}}
if(cb){cb(xml,x)}
else
{throw "Loop broken: "+this.responseText;}}
x.open("GET","http://"+__host+":"+__port+msg);x.send("");}
this.POST=function(msg,data,cb){var x=new XMLHttpRequest;x.onload=function(){if(this.status!=200){throw "Message failed, Status: "+this.status;}
var xml=this.responseXML;if(xml.documentElement==null){throw "Message failed, POST, empty document: "+this.responseText;}
if(cb)cb(xml);if(ini.debug){debug.output('POST response: '+this.responseText);}}
x.open("POST","http://"+__host+":"+__port+msg);x.send(data);}
this.onTimeout=function(){}
this.onReceive=function(x){}
var __host="127.0.0.1";var __port="8002";this.services=[]};var Timeouts=function(){var timeouts=[];this.set=function(){this.clear();timeouts[timeouts.length]=setTimeout.apply(window,arguments);}
this.clear=function(){while(timeouts.length){clearTimeout(timeouts.pop());}}};var TextSearch=function(){const
DEFAULT_STYLE="background-color:#ff0; color:#000;",HIGHLIGHT_STYLE="background-color:#0f0; color:#000;",DEFAULT_SCROLL_MARGIN=50,SEARCH_DELAY=50,MIN_TERM_LENGTH=3;var
self=this,search_term='',input_search_term='',search_results=[],cursor=-1,container=null,__input=null,timeouts=new Timeouts(),span_set_default_style=function(span){span.style.cssText=DEFAULT_STYLE;},span_set_highlight_style=function(span){span.style.cssText=HIGHLIGHT_STYLE;},check_parent=function(hit){return hit[0].parentElement;},search_node=function(node){var
text_content=container.textContent.toLowerCase(),search_term_length=search_term.length,match=text_content.indexOf(search_term),last_match=match!=-1&&match+search_term_length||0,consumed_total_length=0,to_consume_hit_length=0,span=null,search_result=null,consume_node=function(node){if(node&&(match!=-1||to_consume_hit_length)){switch(node.nodeType){case 1:{consume_node(node.firstChild);break;}
case 3:{if(to_consume_hit_length){if(node.nodeValue.length>=to_consume_hit_length){node.splitText(to_consume_hit_length);}
to_consume_hit_length-=node.nodeValue.length;search_result[search_result.length]=span=document.createElement('span');node.parentNode.replaceChild(span,node);span.appendChild(node);span.style.cssText=DEFAULT_STYLE;consumed_total_length+=node.nodeValue.length;node=span;}
else
{if(match-consumed_total_length<node.nodeValue.length){node.splitText(match-consumed_total_length);if((match=text_content.indexOf(search_term,last_match))!=-1){last_match=match+search_term_length;}
to_consume_hit_length=search_term_length;search_result=search_results[search_results.length]=[];}
consumed_total_length+=node.nodeValue.length;}}}
consume_node(node.nextSibling);}};consume_node(container);},update_status_bar=function(){if(topCell.statusbar){topCell.statusbar.updateInfo(ui_strings.S_TEXT_STATUS_SEARCH.
replace("%(SEARCH_TERM)s",search_term).
replace("%(SEARCH_COUNT_TOTAL)s",search_results.length).
replace("%(SEARCH_COUNT_INDEX)s",(cursor+1)));}};this.search=function(new_search_term,old_cursor){var cur=null,i=0,parent=null,search_hit=null,j=0;if(new_search_term!=search_term){search_term=new_search_term;if(search_results){for(;cur=search_results[i];i++){for(j=0;search_hit=cur[j];j++){if(parent=search_hit.parentNode){parent.replaceChild(search_hit.firstChild,search_hit);parent.normalize();}}}}
search_results=[];cursor=-1;if(search_term.length>=MIN_TERM_LENGTH){if(container){search_node(container);if(old_cursor&&search_results[old_cursor]){cursor=old_cursor;search_results[cursor].style.cssText=HIGHLIGHT_STYLE;update_status_bar();}
else
{if(topCell.statusbar){topCell.statusbar.updateInfo(ui_strings.S_TEXT_STATUS_SEARCH_NO_MATCH.
replace("%(SEARCH_TERM)s",new_search_term));}
self.highlight(true);}}}
else if(topCell.statusbar){topCell.statusbar.updateInfo('');}}}
this.searchDelayed=function(new_search_term){timeouts.set(this.search,SEARCH_DELAY,(input_search_term=new_search_term).toLowerCase());}
this.update=function(){var new_search_term=search_term;if(search_term.length>=MIN_TERM_LENGTH){search_term='';this.search(new_search_term);}}
this.highlight=function(check_position){if(search_results.length){if(cursor>=0){search_results[cursor].forEach(span_set_default_style);}
if(check_position){cursor=0;while(search_results[cursor]&&this.getRealOffsetTop(search_results[cursor][0])<0){cursor++;}}
else
{cursor++;}
if(cursor>search_results.length-1){cursor=0;}
search_results[cursor].forEach(span_set_highlight_style);if(!check_position||this.getRealOffsetTop(search_results[cursor][0])>DEFAULT_SCROLL_MARGIN){container.scrollTop+=this.getRealOffsetTop(search_results[cursor][0])-DEFAULT_SCROLL_MARGIN;}
update_status_bar();}}
this.getRealOffsetTop=function(ele){return ele.getBoundingClientRect().top-container.getBoundingClientRect().top;}
this.revalidateSearch=function(){if(container&&search_term){var new_search_term=search_term;search_term='';this.search(new_search_term,cursor);}}
this.setContainer=function(cont){if(container!=cont){container=cont;}}
this.setFormInput=function(input){__input=input;if(search_term){var new_search_term=search_term;__input.value=input_search_term;__input.parentNode.firstChild.textContent='';search_term='';this.searchDelayed(new_search_term);}}
this.cleanup=function(){search_results=[];cursor=-1;__input=container=null;}};var VirtualTextSearch=function(){const
DEFAULT_STYLE="background-color:#ff0; color:#000;",HIGHLIGHT_STYLE="background-color:#0f0; color:#000;",DEFAULT_SCROLL_MARGIN=50,SEARCH_DELAY=50;var
self=this,search_term='',cursor=-1,container=null,source_container=null,source_container_parentNode=null,timeouts=new Timeouts(),__script=null,__offset=-1,__length=0,__hit=[],__input=null,__last_match_cursor=0,search_node=function(node){var cur_node=node&&node.firstChild,pos=0,hit=null,span=null,length=0;while(cur_node&&__offset>-1){switch(cur_node.nodeType){case 1:{search_node(cur_node);break;}
case 3:{if(cur_node.nodeValue.length>__offset){pos=__offset;hit=cur_node.splitText(pos);if((length=hit.nodeValue.length)>=__length){length=__length;__offset=-1;}
else
{__length-=length;__offset=0;}
cur_node=hit.splitText(length);span=node.insertBefore(node.ownerDocument.createElement('span'),hit);span.style.cssText=HIGHLIGHT_STYLE;span.appendChild(node.removeChild(hit));__hit[__hit.length]=span;}
else
{__offset-=cur_node.nodeValue.length;}
break;};}
cur_node=cur_node.nextSibling;}};this.clearHighlightSpan=function(ele){var parent=ele.parentNode;parent.replaceChild(ele.firstChild,ele);parent.normalize();}
this.clearHit=function(){__hit.forEach(this.clearHighlightSpan);__hit=[];}
this.clearScriptContext=function(){if(__script){delete __script.line_matches;delete __script.line_offsets;delete __script.match_cursor;delete __script.match_length;}}
var serach_source=function(){__script.line_matches=[];__script.line_offsets=[];__script.match_cursor=0;__script.match_length=search_term.length;var
pos=-1,line_cur=0,source=__script.source.toLowerCase(),line_arr=__script.line_arr,line_arr_length=line_arr.length,line_matches=__script.line_matches,line_offsets=__script.line_offsets;while((pos=source.indexOf(search_term,pos+1))!=-1){while(line_cur<line_arr_length&&line_arr[line_cur]<=pos&&++line_cur);line_matches[line_matches.length]=line_cur;line_offsets[line_offsets.length]=pos-line_arr[line_cur-1];}
if(__last_match_cursor){if(__last_match_cursor<__script.match_length){__script.match_cursor=__last_match_cursor;}
__last_match_cursor=0;}}
var do_highlight=function(line,top_line,match_cursor){__offset=__script.line_offsets[match_cursor];__length=__script.match_length;self.clearHit();search_node(source_container.getElementsByTagName('div')[line-top_line]);source_container.parentNode.scrollLeft=0;if(__hit.length
&&__hit[0].offsetLeft>source_container_parentNode.scrollLeft+source_container_parentNode.offsetWidth){source_container.parentNode.scrollLeft=__hit[0].offsetLeft-50;}}
this.search=function(new_search_term){var
pos=-1,source='',line_arr=null,line_arr_length=0,line_cur=0;new_search_term=new_search_term.toLowerCase();if(new_search_term!=search_term){search_term=new_search_term;if(new_search_term.length>2){self.clearHit();if(__script){serach_source();if(__script.line_matches.length){self.highlight(true,new_search_term);}
else
{topCell.statusbar.updateInfo(ui_strings.S_TEXT_STATUS_SEARCH_NO_MATCH.
replace("%(SEARCH_TERM)s",new_search_term));}}}
else
{if(__hit.length){self.clearHit();}
self.clearScriptContext();topCell.statusbar.updateInfo('');search_term='';}}}
this.searchDelayed=function(new_search_term){timeouts.set(this.search,SEARCH_DELAY,new_search_term);}
this.update=function(){var new_search_term=search_term;if(search_term.length>2){search_term='';this.search(new_search_term);}}
this.highlight=function(set_match_cursor,new_search_term){if(views.js_source.isvisible()
&&__script
&&__script.line_matches
&&__script.line_matches.length){var line=__script.line_matches[__script.match_cursor];var top_line=views.js_source.getTopLine();var bottom_line=views.js_source.getBottomLine();if(set_match_cursor){__script.match_cursor=0;while(__script.line_matches[__script.match_cursor]<top_line){__script.match_cursor++;}
line=__script.line_matches[__script.match_cursor];}
if(line<=top_line||line>=bottom_line){var plus_lines=views.js_source.getMaxLines()<=7
?views.js_source.getMaxLines()/2>>0
:7;views.js_source.showLine(__script.id,line-plus_lines,true);top_line=views.js_source.getTopLine();}
if(!source_container){source_container_parentNode=container.getElementsByTagName('div')[0];source_container=container.getElementsByTagName('div')[1];}
if(!__script.line_offsets){serach_source();}
do_highlight(line,top_line,__script.match_cursor);topCell.statusbar.updateInfo(ui_strings.S_TEXT_STATUS_SEARCH.
replace("%(SEARCH_TERM)s",search_term).
replace("%(SEARCH_COUNT_TOTAL)s",__script.line_matches.length).
replace("%(SEARCH_COUNT_INDEX)s",__script.match_cursor+1));__last_match_cursor=__script.match_cursor;if(++__script.match_cursor>=__script.line_matches.length){__script.match_cursor=0;}}
else if(new_search_term!=search_term){var new_search_term=search_term;search_term='';this.search(new_search_term);}}
this.checkHit=function(top_line,bottom_line){var line=0;if(search_term&&__script&&__script.line_matches&&
top_line<=(line=__script.line_matches[__last_match_cursor])&&
bottom_line>=line){do_highlight(line,top_line,__last_match_cursor);}}
this.setContainer=function(_container){if(_container){container=_container;source_container=null;source_container_parentNode=null;}}
this.setFormInput=function(input){if(input){__input=input;if(search_term){__input.value=search_term;__input.parentNode.firstChild.textContent='';var new_search_term=search_term;search_term='';this.search(new_search_term);}}}
this.setScript=function(script){__script=script;source_container=null;source_container_parentNode=null;}
this.cleanup=function(){__last_match_cursor=__script&&__script.match_cursor||0;cursor=-1;self.clearScriptContext();self.clearHit();container=source_container=source_container_parentNode=__input=null;__offset=-1;topCell.statusbar.updateInfo('');}};var Colors=function(){const
RED=0,GREEN=1,BLUE=2,HUE=0,SAT=1,LUM=2;var rgb=[0,0,0];var hsl=[0,50,50];var hsv=[0,50,50];var fixRange=function(val,upper,lower){return val>upper?upper:val<lower?lower:val;}
var roundVal=function(val,upper,lower){val=Math.round(val);return val>upper?upper:val<lower?lower:val;}
var toFixed=function(val,upper,lower){val=val.toFixed(2);return val>upper?upper:val<lower?lower:val;}
this.setHue=function(h){h=fixRange(h,360,0);hsl[HUE]=parseInt(h);rgb=this.hsl_to_rgb(hsl[HUE],hsl[SAT],hsl[LUM]);hsv=this.rgb_to_hsv(rgb[RED],rgb[GREEN],rgb[BLUE]);return h;}
this.setSaturation=function(s){s=fixRange(s,100,0);hsl[SAT]=parseFloat(s);rgb=this.hsl_to_rgb(hsl[HUE],hsl[SAT],hsl[LUM]);hsv=this.rgb_to_hsv(rgb[RED],rgb[GREEN],rgb[BLUE]);return s;}
this.setLuminosity=function(l){l=fixRange(l,100,0);hsl[LUM]=parseFloat(l);rgb=this.hsl_to_rgb(hsl[HUE],hsl[SAT],hsl[LUM]);hsv=this.rgb_to_hsv(rgb[RED],rgb[GREEN],rgb[BLUE]);return l;}
this.setHueV=function(h){h=fixRange(h,360,0);hsv[HUE]=parseInt(h);rgb=this.hsv_to_rgb(hsv[HUE],hsv[SAT],hsv[LUM]);hsl=this.rgb_to_hsl(rgb[RED],rgb[GREEN],rgb[BLUE]);return h;}
this.setSaturationV=function(s){s=fixRange(s,100,0);hsv[SAT]=parseFloat(s);rgb=this.hsv_to_rgb(hsv[HUE],hsv[SAT],hsv[LUM]);hsl=this.rgb_to_hsl(rgb[RED],rgb[GREEN],rgb[BLUE]);return s;}
this.setValue=function(l){l=fixRange(l,100,0);hsv[LUM]=parseFloat(l);rgb=this.hsv_to_rgb(hsv[HUE],hsv[SAT],hsv[LUM]);hsl=this.rgb_to_hsl(rgb[RED],rgb[GREEN],rgb[BLUE]);return l;}
this.setRed=function(r){r=fixRange(r,255,0);rgb[RED]=parseInt(r);hsv=this.rgb_to_hsv(rgb[RED],rgb[GREEN],rgb[BLUE]);hsl=this.rgb_to_hsl(rgb[RED],rgb[GREEN],rgb[BLUE]);return r;}
this.setGreen=function(g){g=fixRange(g,255,0);rgb[GREEN]=parseInt(g);hsv=this.rgb_to_hsv(rgb[RED],rgb[GREEN],rgb[BLUE]);hsl=this.rgb_to_hsl(rgb[RED],rgb[GREEN],rgb[BLUE]);return g;}
this.setRGB=function(c_arr){var i=0;for(;i<3;i++){rgb[i]=c_arr[i]>255?255:c_arr[i];}
hsv=this.rgb_to_hsv(rgb[RED],rgb[GREEN],rgb[BLUE]);hsl=this.rgb_to_hsl(rgb[RED],rgb[GREEN],rgb[BLUE]);}
this.setBlue=function(b){b=fixRange(b,255,0);rgb[BLUE]=parseInt(b);hsv=this.rgb_to_hsv(rgb[RED],rgb[GREEN],rgb[BLUE]);hsl=this.rgb_to_hsl(rgb[RED],rgb[GREEN],rgb[BLUE]);return b;}
this.setHex=function(hex){hex=/^[0-9a-f]*$/i.test(hex)?hex:'';if(hex){hex=hex.slice(0,6);var temp=parseInt(hex,16);rgb=[temp>>16,(temp>>8)&0xff,temp&0xff];hsv=this.rgb_to_hsv(rgb[RED],rgb[GREEN],rgb[BLUE]);hsl=this.rgb_to_hsl(rgb[RED],rgb[GREEN],rgb[BLUE]);}
return hex;}
this.getHue=function(){return roundVal(hsl[HUE],360,0);}
this.getSaturation=function(){return toFixed(hsl[SAT],100,0);}
this.getLuminosity=function(){return toFixed(hsl[LUM],100,0);}
this.getHSL=function(){return[roundVal(hsl[0],360,0),toFixed(hsl[1],100,0),toFixed(hsl[2],100,0)];}
this.getHueV=function(){return roundVal(hsv[HUE],360,0);}
this.getSaturationV=function(){return toFixed(hsv[SAT],100,0);}
this.getValue=function(){return toFixed(hsv[LUM],100,0);}
this.getRed=function(){return roundVal(rgb[RED],255,0);}
this.getGreen=function(){return roundVal(rgb[GREEN],255,0);}
this.getBlue=function(){return roundVal(rgb[BLUE],255,0);}
this.getRGB=function(){return[roundVal(rgb[0],255,0),roundVal(rgb[1],255,0),roundVal(rgb[2],255,0)];}
this.getHex=function(){return this.rgb_to_hex_c(rgb);}}
Colors.prototype=new function(){var self=this;var roundVal=function(val,upper,lower){val=Math.round(val);return val>upper?upper:val<lower?lower:val;}
var hsl_or_hsv_to_rgb=function(h,s,l,is_hsl){var ret=self.hue_to_rgb(h),i=0;if(is_hsl){ret=self.mix_rgb(ret,[127.5,127.5,127.5],1-s/100);if(l<=50){ret=self.mix_rgb([0,0,0],ret,l/50);}
else
{ret=self.mix_rgb(ret,[0xff,0xff,0xff],(l-50)/50);}}
else
{ret=self.mix_rgb(ret,[0xff,0xff,0xff],1-s/100);ret=self.mix_rgb([0,0,0],ret,l/100);}
return ret;}
var rgb_to_hsl_or_hsv=function(r,g,b,is_to_hsl){r/=255;g/=255;b/=255;var h=0
var s=0;var l=0;var maxcolor=Math.max(r,g,b);var mincolor=Math.min(r,g,b);var delta=maxcolor-mincolor;var sum=maxcolor+mincolor;if(is_to_hsl){l=sum/2;}
else
{l=maxcolor;}
if(delta==0){s=h=0;}
else
{if(is_to_hsl){if(l<0.5){s=delta/sum;}
else
{s=delta/(2-sum);}}
else
{s=delta/maxcolor;}
if(r==maxcolor){h=(g-b)/delta;}
else if(g==maxcolor){h=2.0+(b-r)/delta;}
else
{h=4.0+(r-g)/delta;}}
h*=60;if(h>360){h=360;}
else if(h<0){h+=360;}
s*=100;if(s>100){s=100;}
l*=100;if(l>100){l=100;}
return[h,s,l];}
this.rgb_c_to_hex_c=function(c){c=roundVal(c,255,0);return(c<16?'0':'')+c.toString(16);}
this.rgb_to_hex_c=function(c_arr){var ret='',i=0,c=0;for(;i<3;i++){c=roundVal(c_arr[i],255,0);if(c>255)c=255;ret+=(c<16?'0':'')+c.toString(16);}
return ret;}
this.mix_rgb=function(c_1,c_2,m){var ret=[],i=0;for(;i<3;i++){ret[i]=c_1[i]+m*(c_2[i]-c_1[i]);}
return ret;}
this.hue_to_rgb=function(h){h=h%360;var delta=h%60;h-=delta;delta=(255/60*delta)>>0;if(h<60)return[0xff,delta,0];if(h<120)return[0xff-delta,0xff,0];if(h<180)return[0,0xff,delta];if(h<240)return[0,0xff-delta,0xff];if(h<300)return[delta,0,0xff];if(h<360)return[0xff,0,0xff-delta];}
this.hsl_to_rgb=function(h,s,l){return hsl_or_hsv_to_rgb(h,s,l,true);}
this.hsv_to_rgb=function(h,s,v){return hsl_or_hsv_to_rgb(h,s,v,false);}
this.rgb_to_hsv=function(r,g,b){return rgb_to_hsl_or_hsv(r,g,b,false);}
this.rgb_to_hsl=function(r,g,b){return rgb_to_hsl_or_hsv(r,g,b,true);}}

var ServiceBase = new function(name){
	this.name = name;this.onreceive=function(xml){}
	this.onconnect = function(xml){}
	this.onquit = function(xml){}
	this.post = function(msg){client.post(this.name,msg);}
	this.initBase = function(name){
		this.name=name;
		if(!window.services){
			window.services={};
		}
		window.services[name]=this;
	}
}

window.debug_helpers||(window.debug_helpers={});debug_helpers.liveSource=new function(){var ___settingsLiveSource={lines:1,lineNumbers:1,tag:'#05F',attrTitle:'#E00',attrValue:'#C0C',attrDoc:'#800080',comment:'green',darkLine:'#FAFAFA',lineHead:'#999'};var tab='  ';var emptyTags={img:1,br:1,link:1,input:1,hr:1,meta:1};var xml=false;var counter=0;var showLinenumbers=___settingsLiveSource.lineNumbers;var showLines=___settingsLiveSource.lines;var icon_src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEeklEQVR4Xr1Xb0hbVxS%2FN3lPncZIFMXV%2Bmd0dmjJuipszH8wnCJ%2BEIQh0Y1ULTpFXN1kofjdsbmiUldmmWwuON2H4kdBYU7FL%2BIGw4GFiR2skagMqyb%2By0vifufSF5Yu%2BmJdPHC81%2FPuueeX3zn3vPv48fEx45y%2Fzhh7D%2Fo21MQiK7vQeehDxF7imFyNi4v7cWRkJL24uFhJSkpyw%2BaLUHD99va2YWZmRq6vr3%2Bys7NjIQBdo6OjH9fW1i76fL7vgMoB9UQiOpiWoZf1en3D2NjYm3V1dX0S7O%2BUl5d7FUX5HvqYRVYU6J%2ByLA9XVlbmYf4uATAlJia6IH%2F5%2FX52EeL1ep8YjUYXpkYAEOI7ODjwsIsTJT4%2BXtSZpFoODw9DrhwaGvpkb2%2FPjClnYUhUVNRyaWnpveTkZMVkMmkWswCAojsRgNvtvt7d3X0tNjY2FJVsf3%2BfbWxssLS0NLa2tsb6%2B%2FtfmpiYsJWUlNzlnB%2FGxMSEzCvFDIsBnAwdBd%2Fd3T0tp4zWJCQksI6Ojis9PT3S9PS0DcX2GZjwEghNBlADIRegMHU0Li8vExssPz9f2FvuP2KDbTk0FSyoQiC6uroywRpfWloymM1mF0D4NRnAJicyQGNubi7NVbMIrsrR0ZEYU1JSAnt5PB55dXXVmJqauo9Gp2gyAKeT6A3JwIOmX8XY9OCGSN%2FU1JSaJlpHYPUAJuOZ2PuFGUAKOI05OTkEhv5XAwc2ysrKEv6gmtYIQJOTkxyNjaG%2F6OjZCzNAv4TGlZUV5nA4WFFRkbC3Df7B7rdcZUMtvwWtt9x9VQUuAPxvDGRnZ7PMzMyA41cfZov5ra%2BvB61Hn2c6nU74ITgpC4sBNJtTT8Hi4iJbX19nZWVlwv7RN6tivNd0hf3e1hbkU2C3E3PEAJ0u2luTAc0izMvLo2oP1ED%2FrVdUgOzawMC%2FOyH1BMEAfFlYDEAI5anHcG5uTtRAdXW1sD%2B6fTvk%2BjcGB1U%2FjqPIVQa0UqAJoKCgIIiB1%2Fr6TkqZSjGlgI4kNxgM7DyNiNOI%2Fi5qAJcIYf%2FU7mBfWi9T6%2F2Pz%2Fj4OPmFnwKg0QSASwt1t8Av%2FOKDS2Le29sbtD46OjoyxxC%2FSrz1Ghsbhf3OD04xfv7%2By6yzs%2FN5BlQAOqTtfAxIkiQAVFVVBdmJflXwCg4FnE7Q%2BRlAAXF6lpGRwcIVrA9KgSzL7MyvYzjLsMWhqzkqKiqiaUOq7HBBoF62ACQZ%2Fjvw8wCEcqYLCd5sJoAwbG1tDaAQjaQwy1CdRmw%2F7c859yA4sZHgg%2BCesHGmKxl6%2BlP40SZePHdjw79h5kJPl%2BNn6ofvEWroKdRF%2B4digEN%2FQRMyFhYWWp1Op8IiL%2FTalhYWFuy4qLgkYhvv7Es1NTXpuMs9vggAFoslHamJx9RJAH6enZ0134SApm%2Ftdvva5uamNxKBcWWTrFZrWkNDw01cWin2T%2FTnYXNzc%2FXw8PBb7e3tN2w2mxv58Ufo21CHk2WYn5%2BPam1tdVDs5z%2FPS6AGFllxQ%2BfUz%2FN%2FAGv8CRiMYmtNAAAAAElFTkSuQmCC';var openTagNameHead=function(name){return "<span class='tag'>&lt;"+name+"";}
var openTagNameFoot=function(xmlemptyTag){return(xmlemptyTag?'/':'')+"&gt;</span>";}
var closeTagName=function(name,xmlemptyTag){if(xmlemptyTag||emptyTags[name.toLowerCase()])return '';return "<span class='tag'>&lt;/"+name+"&gt;</span>";}
var getDoctype=function(){var doctype=document.doctype,code='';if(doctype){code=lineHead()+openTagNameHead('!DOCTYPE')+" <span class='attrDoc'>"+doctype.nodeName+(doctype.publicId?' PUBLIC "'+doctype.publicId+'"':'')+(doctype.systemId?'</span></span></span></li>'+lineHead()+'<span class=\'tag\'><span class=\'attrDoc\'>'+tab+'"'+doctype.systemId+'"':'')+"</span>"+openTagNameFoot()+'</span></li>';}
return code;}
var getAttrs=function(ele){var attrs=ele.attributes,attr=null,realAttr=null,ret='',i=0;for(;attr=attrs[i];i++){realAttr=ele.getAttribute(attr.name);if(realAttr&&
!(ele.nodeName.toLowerCase()=='a'&&attr.name=='SHAPE'&&realAttr=='rect')){realAttr=realAttr.replace(/</g,'&lt;').replace(/</g,'&lt;').replace(/\t/g,tab);ret+=" <span class='attrTitle'>"+attr.name+"</span>"
+"="
+"<span class='attrValue'>\""+realAttr+"\"</span> ";}}
return ret;}
var getTextNodeData=function(ele){return text=ele.nodeValue.replace(/[\n\t\r\u00A0]+ */g,'').
replace(/ +/g,' ').replace(/</g,'&lt;').replace(/>/g,'&gt;');}
var getIndent=function(deep){var i=0,ret='';while(i<deep){ret+=tab;i++;}
return ret;}
var lineHead=function(){var lineNumber=counter.toString();while(lineNumber.length<3)lineNumber='0'+lineNumber;return "<li class='line"+(showLines&&((counter++)&1)?" dark'":"'")+"><span>";}
this.updateNumbers=function(ele){if(ele.checked){ele.ownerDocument.body.className='';}
else
{ele.ownerDocument.body.className='hideLineNumbers';}}
var getLayer=function(ele,deep,singleText){var indent=getIndent(deep++);var text='';switch(ele.nodeType){case 1:{var childs=ele.childNodes,child=null,i=0;var simple=(childs.length==0)||(childs.length==1&&childs[0].nodeType==3);var xmlemptyTag=xml&&childs.length==0;var ret=lineHead()+indent+openTagNameHead(ele.nodeName)+getAttrs(ele)+openTagNameFoot(xmlemptyTag);if(!simple)ret+='</span></li>';for(;child=childs[i];i++){ret+=getLayer(child,deep,!simple&&child.nodeType==3);}
if(simple){ret+=(/textarea/i.test(ele.nodeName)?ele.value:'')+closeTagName(ele.nodeName,xmlemptyTag)+'</span></li>';}
else
{ret+=lineHead()+indent+closeTagName(ele.nodeName,xmlemptyTag)+'</span></li>';}
return ret;}
case 3:{if((text=getTextNodeData(ele))&&singleText){return lineHead()+indent+text+'</span></li>';}
else
{return text;}}
case 8:{text=getTextNodeData(ele);return lineHead()+indent+"<span class='comment'>&lt;!--"+text+'--&gt;</span></span></li>';}
case 4:{text=getTextNodeData(ele);return lineHead()+indent+"<span class='cdata'>&lt;![CDATA[</span>"+text+"<span class='cdata'>]]&gt;</span></span></li>";}}
return ele.nodeType}
var getLiveMarkup=function(){var markup=getDoctype();var ele=document.documentElement;markup+=getLayer(ele,0);return markup;}
this.open=function(){xml=/[a-z]/.test(document.documentElement.nodeName);var markup='<!DOCTYPE html PUBLIC><html><head><title></title>'
+'<style type=\'text/css\'>'
+'body {padding:5px;margin:0;font-family:sans-serif;font-size:.7em;background: #FFF url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAqCAIAAAD9HKYrAAAAOUlEQVQY062MsQ2AQBDDrOw%2F6xc0TxVTHHoxAEXkwnLY%2B0YN8NvEKEEz30MdR03x%2BLav97Tfbq3rAYdRNs%2F1y8dMAAAAAElFTkSuQmCC") scroll repeat-x 0 2px;color:#000;}#logo {height:40px;border:none;padding:1px;margin:0;}#logo a{ content:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHQAAAAPCAYAAAA1f%2BslAAAABGdBTUEAAK%2FINwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAALmSURBVFjD7VnRjeQgDE0LtEALtJAW0kJaoAVaoAVaoAX%2B5psWaIElOnP3xmfCjFazl9ENkqUhcRLg2c%2FPu8vyGe8wTLPaLE89b8uim6VmuVklO%2Bb%2B9utFPzG2ZrFZIQvN1osfsqc1%2F8TQBGh9FNAOZCBDcPcXLzbAYhNFYZ%2FvFwVTUeBZmltau7kUoOz6DqC%2BaqEWqETD9R02YC4I6EZr62uubH49QOle6JnL%2FD1kcbwRPdLvu6xuv7fuJ3y%2B0CI34V6ke57VEU%2BAJ5pHgZ41UHgWMj3Dc8d7HGWdh%2FcmyECJVRI9U8H6fhSswwPzxEEpMfTOTBZYcEiAavLre7SPANrByOB7AFkIVE%2B%2FD58VsjoKQbE%2FGXU7EwKaHVqEw8dM1lCLESD8fgWfSoBqqN8eqN9O6BZLRlz%2BBL9maw2DAF5hPQECuQCo0lklCPDwLKCV5r6DBz4GMlUBTSu6X8jUgLbqhNaqsKmViZMKAsUzHyUoRARAMbC4skwTuh1RbmAMg89mxhYcZEfXwgBQBaCrZyi3Z1yiOYqlv4xnJGXtHWULBzbL0DTJaC7pM6NBNMUA4PV5Beqrg%2B8FAWQJ0Dz4RgFfZJ2zPUl7D%2FCs%2B723CaC9JjrItkqZ6phZltVByuhv1NARoCvbfIHnHLMzAFCgOZjXE7r9l4D2oM93DHWich1dL0CfPfvsRGh1ms031gx777dmoZkGajlTuVIdMQLlBha5Zy3PIwBIh7gN1GwRSsF3KNdPKHeUGErqQyNkYmH1UsO9DH1rYn4O3mkZoKVZbeZYJs76UM3UJIoiFBBGEClJEEUc mAhr8GwdZ3S7MCGTTkSRpAFQKzwqihSIqHBXmkC5VgDqANUKQkZqW7q%2FEYTSYZoBapvlZobRXYLoDQJV4aYs%2BXVgjUBZ%2BJcn3i5IdIhtQILWqEzoFtskLqI0BMdoX71sRPDzLNg4BatJm%2FMW4%2FHm%2BjWj96xvd3AfQD%2FjYv9x%2BI%2FHF%2FGwg80geQ5eAAAAAElFTkSuQmCC");display:block;height:18px;xxborder:1px solid blue;margin-left:46px;}#logo img {width:32px;height:32px;float:left;margin-left:5px;}#logo h1{margin:0;padding:0 2px;font-size:1.3em;font-weight:bold;margin-left:43px;}p.title, p.url{margin:0;padding:0;line-height:1.4em;font-weight:bold;margin-left:5px;}p.url{color:#666;margin-bottom:5px;}#content{white-space:pre-wrap}ol {color:#999;}.hideLineNumbers ol{margin:0;padding:0;}span{color:#000}.tag{color:#05F}.attrTitle{color:#E00}.attrValue{color:#C0C}.attrDoc{color:#800080}.comment{color:green}.line{margin:0;padding:0}.dark{background-color:#FAFAFA}h1{font-family: sans-serif;font-size: 14px;margin-top: 20px;}label{float:right;font-weight:normal;font-size:11px;}'
+'#content{white-space:pre-wrap}'
+'ol {color:'+___settingsLiveSource.lineHead+'}'
+'.hideLineNumbers ol{margin:0;padding:0;}'
+'span{color:#000}'
+'.tag{color:'+___settingsLiveSource.tag+'}'
+'.attrTitle{color:'+___settingsLiveSource.attrTitle+'}'
+'.attrValue{color:'+___settingsLiveSource.attrValue+'}'
+'.attrDoc{color:'+___settingsLiveSource.attrDoc+'}'
+'.comment{color:'+___settingsLiveSource.comment+'}'
+'.line{margin:0;padding:0}'
+'.dark{background-color:'+___settingsLiveSource.darkLine+'}'
+'h1{font-family: sans-serif; font-size: 14px; margin-top: 20px;}'
+'label{float:right;font-weight:normal;font-size:11px;}'
+'</style></head><body>'
+'<div id="logo">'
+'<img src="'+icon_src+'">'
+'<a href="http://dev.opera.com/tools/" ></a>'
+'<h1>DOM Snapshot</h1>'
+'</div>'
+'<p class="title" >'+document.title+'</p>'
+'<p class="url" >[ '+location.protocol+'//'+location.host+location.pathname+' ]</p>'
+'<ol id=\'content\'>'+getLiveMarkup()+'</ol></body></html>';window.open('data:text/html,'+encodeURIComponent(markup),'_blank');}}
var defaults={viewport:'viewport',viewport_main_container:'main-view',window_container:'windows-container',min_view_height:75,min_view_width:240,view_border_width:0,slider_name:'view-slider',slider_border_width:5,focus_catcher_id:'opera-focus-catcher'}
var global_state={ui_framework:{temporary_tabs:[]}}
var UIWindowBase=new function(){var self=this;var id_count=1;var ids=[];var getId=function(){return 'ui-window-'+(id_count++).toString();}
this.default_width=500;this.default_height=300;this.default_top=100;this.default_left=100;var
min_width=200,min_height=100,min_z_index=100;var viewport=null;this.init=function(view_id,left,top,width,height){ids[ids.length]=this.id=getId();this.view_id=view_id;this.top=top||this.default_top;this.left=left||this.default_left;this.width=width||this.default_width;this.height=height||this.default_height;this.container=new WindowContainer(this);this.statusbar=new WindowStatusbar(this);if(toolbars[view_id]){this.toolbar=new WindowToolbar(this,toolbars[view_id].buttons,toolbars[view_id].filters);}
if(!window.ui_windows){window.ui_windows={};}
window.ui_windows[this.id]=this;this.render();}
this.render=function(){var win=viewport.render(templates._window(this));if(this.toolbar){this.toolbar.setDimensions();this.toolbar.setup(this.view_id);}
this.container.setup(this.view_id);this.statusbar.setup(this.view_id);this.setZIndex();win.style.zIndex=200;}
this._delete=function(id){var
_id='',i=0;for(;(_id=ids[i])&&_id!=id;i++);if(_id){delete window['ui-windows'][id];ids.splice(i,1);return true;}
return false;}
this.setZIndex=function(){var win=null,id='',i=0,z=0;for(;id=ids[i];i++){win=document.getElementById(id);if(win){if((z=parseInt(win.style.zIndex))&&z>min_z_index)
win.style.zIndex=z-1;}}}
this.getWindowByViewId=function(view_id){var win=null,id='',i=0;for(;id=ids[i];i++){if(ui_windows[id].view_id==view_id){return ui_windows[id];}}
return null;}
this.update=function(){this.container.setDimensions();}
this.showWindow=function(view_id,top,left,width,height){var win=this.getWindowByViewId(view_id);if(win){if(document.getElementById(win.id)){self.setZIndex();document.getElementById(win.id).style.zIndex=200;}
else
{win.render();}}
else
{win=new UIWindow(view_id,top,left,width,height);}
return win;}
var
handlers={'window-scale-top-left':true,'window-scale-top':true,'window-scale-top-right':true,'window-move':true,'window-scale-right':true,'window-scale-left':true,'window-scale-bottom':true,'window-scale-bottom-right':true,'window-scale-bottom-left':true},set={},update={},click_handlers={},current_target=null,__event=null,interval=0,current_style=null,update_handler=null,left_delta=0,top_delta=0,bottom_delta=0,right_delta=0,focus_catcher=null,window_shadows=null,store_event=function(event){__event=event;focus_catcher.focus();},force_reflow_shadows=function(){if(window_shadows){window_shadows.innerHTML="\
        <window-shadow class='top-left'></window-shadow>\
        <window-shadow class='top'></window-shadow>\
        <window-shadow class='top-right'></window-shadow>\
        <window-shadow class='left'></window-shadow>\
        <window-shadow class='right'></window-shadow>\
        <window-shadow class='bottom-left'></window-shadow>\
        <window-shadow class='bottom'></window-shadow>\
        <window-shadow class='bottom-right'></window-shadow>";}}
mousedown=function(event){var handler=event.target.getAttribute('handler');{if(handler in handlers){if(interval){interval=clearInterval(interval);}
if(!focus_catcher){focus_catcher=UIBase.getFocusCatcher();}
window_shadows=event.target.parentNode.getElementsByTagName('window-shadows')[0];current_style=event.target.parentNode.style;self.setZIndex();current_style.zIndex=200;interval=setInterval(update[handler],30);update_handler=update[handler];set[handler](event);current_target=ui_windows[event.target.parentNode.id]||{};document.addEventListener('mousemove',store_event,false);document.addEventListener('mouseup',mouseup,false);}}},mouseclick=function(event){var handler=event.target.getAttribute('handler');{if(handler in click_handlers){click_handlers[handler](event);}
else
{var parent=event.target;while(parent){if(/^window$/i.test(parent.nodeName)){self.setZIndex();parent.style.zIndex=200;break;}
parent=parent.parentElement;}}}},mouseup=function(event){document.removeEventListener('mousemove',store_event,false);document.removeEventListener('mouseup',mouseup,false);document.onselectstart=null;interval=clearInterval(interval);update_handler();window_shadows=current_target=current_style=__event=update_handler=null;};set['window-move']=function(event){left_delta=event.pageX-event.target.parentNode.offsetLeft;top_delta=event.pageY-event.target.parentNode.offsetTop;}
update['window-move']=function(){if(__event){if(__event.pageX<innerWidth&&__event.pageX>0){current_style.left=(current_target.left=__event.pageX-left_delta)+'px';}
if(__event.pageY<innerHeight&&__event.pageY>0){current_style.top=(current_target.top=__event.pageY-top_delta)+'px';}
focus_catcher.focus();}}
set['window-scale-top']=function(event){top_delta=event.pageY-event.target.parentNode.offsetTop;bottom_delta=event.target.parentNode.offsetTop+event.target.parentNode.offsetHeight-2;}
update['window-scale-top']=function(event){if(__event){var top=__event.pageY-top_delta;var height=bottom_delta-top;if(height>min_width){current_style.height=(current_target.height=height)+'px';current_style.top=(current_target.top=top)+'px';current_target.update();focus_catcher.focus();}}}
set['window-scale-right']=function(event){left_delta=event.pageX-(event.target.parentNode.offsetWidth-2);}
update['window-scale-right']=function(){if(__event){var width=__event.pageX-left_delta;if(width>min_width){current_style.width=(current_target.width=width)+'px';current_target.update();focus_catcher.focus();}}}
set['window-scale-left']=function(event){left_delta=event.pageX-event.target.parentNode.offsetLeft;right_delta=event.target.parentNode.offsetLeft+event.target.parentNode.offsetWidth-2;}
update['window-scale-left']=function(event){if(__event){var left=__event.pageX-left_delta;var width=right_delta-left;if(width>min_width){current_style.width=(current_target.width=width)+'px';current_style.left=(current_target.left=left)+'px';current_target.update();focus_catcher.focus();}}}
set['window-scale-bottom']=function(event){top_delta=event.pageY-event.target.parentNode.offsetHeight;}
update['window-scale-bottom']=function(){if(__event){var height=__event.pageY-top_delta;if(height>min_height){current_style.height=(current_target.height=height)+'px';current_target.update();focus_catcher.focus();force_reflow_shadows();}}}
set['window-scale-top-left']=function(event){set['window-scale-left'](event);set['window-scale-top'](event);}
update['window-scale-top-left']=function(){update['window-scale-left']();update['window-scale-top']();}
set['window-scale-top-right']=function(event){set['window-scale-right'](event);set['window-scale-top'](event);}
update['window-scale-top-right']=function(){update['window-scale-right']();update['window-scale-top']();}
set['window-scale-bottom-right']=function(event){set['window-scale-right'](event);set['window-scale-bottom'](event);}
update['window-scale-bottom-right']=function(){update['window-scale-right']();update['window-scale-bottom']();}
set['window-scale-bottom-left']=function(event){set['window-scale-left'](event);set['window-scale-bottom'](event);}
update['window-scale-bottom-left']=function(){update['window-scale-left']();update['window-scale-bottom']();}
click_handlers['window-close']=function(event){var win=event.target.parentElement.parentElement;if(win){ref_obj=ui_windows[win.id];ref_obj.container.onclose();messages.post("hide-view",{id:win.getAttribute('ref_id')});win.parentElement.removeChild(win);}}
var init=function(event){document.removeEventListener('load',arguments.callee,false);viewport=document.getElementsByTagName(defaults.window_container)[0];if(!viewport){self.showWindow=function(){};opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'missing view port in init in windows');}}
document.addEventListener('mousedown',mousedown,false);document.addEventListener('click',mouseclick,false);window.addEventListener('load',init,false);}
var UIWindow=function(view_id){this.init(view_id);}
UIWindow.prototype=UIWindowBase;CellBase=new function(){const VER='v',HOR='h';var self=this;var ids={};var id_count=1;var __counter=0;var getId=function(){return 'cell-id-'+(id_count++);}
this.appendUiNodes=function(){this.container=new Container(this);this.tab=new Tabs(this);this.toolbar=new Toolbar(this);}
this.getView=function(view_id){var ret=null,tab='',view=null,child=null,i=0;if(this.tab){for(i=0;tab=this.tab.tabs[i];i++){if(view=views[tab.ref_id]){if(view.type=='composite-view'){if(ret=view.cell.getView(view_id)){return[this.tab,tab.ref_id].concat(ret);}}
else if(tab.ref_id==view_id){return[this.tab,view_id];}}}}
else
{for(i=0;child=this.children[i];i++){if(ret=child.getView(view_id)){return ret;}}}
return null;}
this.setTooolbarVisibility=function(view_id,bool){var child=null,i=0;if(this.toolbar){if(this.toolbar.__view_id==view_id&&this.toolbar.isvisible()){this.toolbar.setVisibility(bool);this.toolbar.setup(view_id);this.update(this.left,this.top,true);}}
else
{for(;child=this.children[i];i++){child.setTooolbarVisibility(view_id,bool);}}}
this.disableTab=function(ref_id,bool){var tab=null,view=null,child=null,i=0;if(this.tab){for(i=0;tab=this.tab.tabs[i];i++){if((view=views[tab.ref_id])&&view.type=='composite-view'){view.cell.disableTab(ref_id,bool);}
else if(tab.ref_id==ref_id){tab.disabled=bool;if(this.tab.isvisible()){this.tab.render();if(this.tab.activeTab==ref_id){this.tab.trySetAnActiveTab();}}}}}
else
{for(i=0;child=this.children[i];i++){child.disableTab(ref_id,bool);}}}
this.init=function(rough_cell,dir,parent,container_id){this.width=rough_cell.width&&rough_cell.width>defaults.min_view_width?
rough_cell.width:defaults.min_view_width;this.height=rough_cell.height&&rough_cell.height>defaults.min_view_height?
rough_cell.height:defaults.min_view_height;ids[this.id=rough_cell.id||getId()]=this;this.checked_height=0;this.checked_width=0;this.type='';this.children=[];this.previous=null;this.next=null;this.parent=null;this.dir=dir;this.parent=parent;this.container_id=container_id;this.is_dirty=true;dir=dir==HOR?VER:HOR;var rough_children=rough_cell.children,rough_child=null,i=0;var child=null,previous=null,next=null;if(rough_children){for(;rough_child=rough_children[i];i++){next=this.children[this.children.length]=new Cell(rough_child,dir,this,container_id);if(child){child.previous=previous;child.next=next;}
previous=child;child=next;}}
else
{this.appendUiNodes();var tabs=rough_cell.tabs,tab='',i=0;for(;tab=tabs[i];i++){if(views[tab]){this.tab.addTab(new Tab(tab,views[tab].name));}}}}
this.setup=function(view_id){var view_id=this.tab&&this.tab.activeTab;if(view_id){this.toolbar.setup(view_id);this.update(this.left,this.top,true);this.container.setup(view_id);}}
this.update=function(left,top,force_redraw){var children=this.children,child=null,i=0;var delta=0;var css_text='';if(force_redraw){this.is_dirty=true;}
var is_dirty=this.is_dirty;if(children.length){this.left=left;this.top=top;if(this.dir==VER){delta=top;for(;child=children[i];i++){delta+=child.update(left,delta,force_redraw);}}
else
{delta=left;for(;child=children[i];i++){delta+=child.update(delta,top,force_redraw);}}}
else
{if(this.is_dirty){this.left=left;this.top=top;if(!this.tab.activeTab){this.tab.trySetAnActiveTab();}
else if(!document.getElementById('toolbar-to-'+this.id)){this.tab.setActiveTab('',true);}
else
{this.toolbar.setDimensions(force_redraw);this.tab.setDimensions(force_redraw);this.container.setDimensions(force_redraw);}
this.is_dirty=false;}}
if(this.next){var ele=document.getElementById('slider-for-'+this.id);if(!ele){var container=document.getElementById(this.container_id)||window.viewport;if(container){ele=container.appendChild(document.createElement(defaults.slider_name));ele.id='slider-for-'+this.id;ele.className=this.dir==HOR?'horizontal':'vertical';}
else
{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'missing container in cell.update');}}
if(is_dirty){if(this.dir==HOR){css_text='left:'+left+'px;'+'top:'+(2*defaults.view_border_width+top+this.height)+'px;'+'width:'+(2*defaults.view_border_width+this.width)+'px;'+'height:'+defaults.slider_border_width+'px;';}
else
{css_text='left:'+(2*defaults.view_border_width+left+this.width)+'px;'+'top:'+top+'px;'+'width:'+defaults.slider_border_width+'px;'+'height:'+(2*defaults.view_border_width+this.height)+'px;';}
if(ele.style.cssText!=css_text){ele.style.cssText=css_text;}}}
return(this.dir==VER?this.width:this.height)+2*defaults.view_border_width+defaults.slider_border_width;}
this.checkChildren=function(dim){var child=null,i=0,sum=0,length=this.children.length;for(;child=this.children[i];i++){sum+=child[dim]+2*defaults.view_border_width;if(i!=length-1){sum+=defaults.slider_border_width;}}
return sum;}
this.setDefaultDimensions=function(){var dim=this.dir==VER?'height':'width';var max=this[dim];var child=null,i=0,sum=0,length=this.children.length,prov=0;if(length){while(length){sum=this.checkChildren(dim);length--;prov=max-(sum-this.children[length][dim]-2*defaults.view_border_width);if(sum<max||defaults['min_view_'+dim]<prov){this.children[length][dim]=prov;length=this.children.length;break;}
else
{this.children[length][dim]=defaults['min_view_'+dim];}}
if(!length){length=this.children.length;sum=max-(length-1)*(2*defaults.view_border_width)-(length-1)*defaults.slider_border_width;var average_width=sum/length>>0;for(i=0;i<length-1;i++){this.children[i][dim]=average_width;}
this.children[length-1][dim]=sum-(length-1)*average_width;}
dim=this.dir==HOR?'height':'width';for(i=0;child=this.children[i];i++){child[dim]=this[dim];child.setDefaultDimensions();}}}
this.getCellById=function(id){return ids[id];}
this._delete=function(id){delete ids[id];}
this.setCheckedDimesions=function(){if(this.checked_height){this.height=this.checked_height;this.checked_height=0;this.is_dirty=true;}
if(this.checked_width){this.width=this.checked_width;this.checked_width=0;this.is_dirty=true;}
var child=null,i=0;for(;(child=this.children[i]);i++){child.setCheckedDimesions();}}
this.clearCheckedDimesions=function(){this.checked_height=this.checked_width=0;this.is_dirty=false;var child=null,i=0;for(;(child=this.children[i]);i++){child.clearCheckedDimesions();}}
this.checkDelta=function(dim,delta,sibling){var delta_applied=0;var child=null,i=0;var deltas=[];if(this.children.length){if((dim=='height'&&this.dir==HOR)||(dim=='width'&&this.dir==VER)){if(delta){for(;child=this.children[i];i++){deltas[deltas.length]=child.checkDelta(dim,delta,sibling);}
var min=Math.min.apply(null,deltas);var max=Math.max.apply(null,deltas);delta_applied=delta>0?max:min;if(max!=min){for(i=0;child=this.children[i];i++){child.checkDelta(dim,delta-delta_applied,sibling)}}
this['checked_'+dim]=this[dim]+(delta-delta_applied);}
else
{for(i=0;child=this.children[i];i++){child.checkDelta(dim,0,sibling);}
delta_applied=this['checked_'+dim]=0;}}
else
{delta_applied=delta;for(i=0;child=this.children[i];i++){delta_applied=child.checkDelta(dim,delta_applied,sibling);}
this['checked_'+dim]=this[dim]+(delta-delta_applied);}}
else
{if(delta){var newDim=this[dim]+delta;if(newDim>=defaults['min_view_'+dim]||newDim>=this[dim]){this['checked_'+dim]=newDim;}
else
{this['checked_'+dim]=defaults['min_view_'+dim]}
delta_applied=delta-(this['checked_'+dim]-this[dim]);}
else
{delta_applied=this['checked_'+dim]=0;}}
return delta_applied;}
this.getCapTarget=function(dim,target){if(!this.children.length)return 0;var child=null,i=0,length=this.children.length-1,sum=length*2*defaults.view_border_width+(length)*defaults.slider_border_width;for(;(child=this.children[i]);i++){if(child!=target){sum+=child['checked_'+dim]||child[dim];}}
return this[dim]-sum;}
this.handleResizeEvent=function(event,_delta){var dim=this.dir==HOR?'height':'width';var pos=this.dir==HOR?'top':'left';var delta=Math.round(event[this.dir==HOR?'pageY':'pageX']-_delta-(this[pos]+this[dim]));var sibling=this;var cap=0;var cap_holder=null;var consumed=-delta;if(delta){if(delta>0){do
{sibling=sibling.next;if(sibling){consumed=sibling.checkDelta(dim,consumed,'next');}}
while(sibling&&consumed);cap_holder=this;}
else
{while(sibling&&delta){delta=sibling.checkDelta(dim,delta,'next');sibling=sibling.previous;}
cap_holder=this.next;}
if(cap=delta+consumed){cap_holder.checkDelta(dim,cap,'next');this.parent.setCheckedDimesions();this.parent.update(this.parent.left,this.parent.top);}
else
{this.parent.clearCheckedDimesions();}}}}
var Cell=function(rough_cell,dir,parent,container_id){this.init(rough_cell,dir,parent,container_id)}
Cell.prototype=CellBase;var TopCell=function(layout,setDimensions,onresize,TopToolbar,TopStatusbar){var self=this;var resize_timeout=new Timeouts();this.setStartDimesions=setDimensions||function(){this.top=0;this.left=0;this.width=innerWidth;this.height=innerHeight;};this.onresize=onresize||function(){this.setStartDimesions();this.update();this.setup();}
this.cell_type='top';var delayed_resize=function(){self.onresize();messages.post('resize');}
var setDelayedResize=function(){resize_timeout.set(delayed_resize,32);}
this.appendUiNodes=function(){this.container=new TopContainer(this);this.tab=new TopTabs(this);this.toolbar=TopToolbar&&new TopToolbar(this)||null;if(this.toolbar){toolbars[this.id].setVisibility(!opera.attached);}
this.statusbar=TopStatusbar&&new TopStatusbar(this)||null;}
this.update=function(){if(!this.children.length){if(!this.tab.activeTab){if(this.tab.tabs.length){this.tab.setActiveTab(this.tab.tabs[0].ref_id);}}
else
{if(this.toolbar){this.toolbar.setDimensions();}
this.tab.setDimensions();if(this.statusbar){this.statusbar.setDimensions();}
this.container.setDimensions();}}
else
{}}
this.showView=function(view_id){var view=views[view_id];if(view.requires_view&&!this.tab.hasTab(view.requires_view)){global_state.ui_framework.temporary_tabs.push(view.requires_view);this.tab.addTab(new Tab(view.requires_view,views[view.requires_view].name,true))}
if(view.isvisible()){view.update();}
else
{var ret=this.getView(view_id),tab=null,i=0;if(ret){for(;tab=ret[i];i+=2){if(tab.activeTab!=ret[i+1]){tab.setActiveTab(ret[i+1]);}}}}}
this.setTooolbarVisibility=function(view_id,bool){var tab='',view=null,i=0;if(toolbars[view_id]){toolbars[view_id].setVisibility(bool);}
for(i=0;tab=this.tab.tabs[i];i++){if(view=views[tab.ref_id]){view.cell.setTooolbarVisibility(view_id,bool);}}}
this.setup=function(){var view_id=this.tab&&this.tab.activeTab;if(view_id){this.container.setup(view_id);}}
this.cleanUp=function(){document.removeEventListener('resize',setDelayedResize,false);resize_timeout.clear();resize_timeout=null;}
this.addTemporaryTabs=function(){var
store=global_state.ui_framework.temporary_tabs,view_id='',i=0;for(;view_id=store[i];i++){if(views[view_id]){this.tab.addTab(new Tab(view_id,views[view_id].name,true));}}}
document.addEventListener('resize',setDelayedResize,false);window.topCell=this;this.init(layout);this.setStartDimesions();if(this.toolbar){this.toolbar.setup(this.id);}
if(this.statusbar){this.statusbar.setup(this.id);}
this.addTemporaryTabs();this.tab.setActiveTab
(global_state
&&global_state.ui_framework.last_selected_top_tab
&&composite_view_convert_table[opera.attached.toString()][global_state.ui_framework.last_selected_top_tab]
||this.tab.tabs[0].ref_id);this.container.setup(this.id);this.update(this.left,this.top,true);this.setup();}
TopCell.prototype=CellBase;var ViewBase=new function(){var self=this;var id_count=1;var ids=[];var getId=function(){return 'view-'+(id_count++).toString();}
var filter=function(view,filters){var filter='',i=0;for(;(filter=filters[i])&&!view[filter];i++);return filter&&true||false;}
this.getSingleViews=function(filters){var
id='',i=0,ret=[];for(;id=ids[i];i++){if(views[id].type=='single-view'&&(!filters||!filter(views[id],filters))){ret[ret.length]=id;}}
return ret;}
this._delete=function(id){var
_id='',i=0;for(;(_id=ids[i])&&_id!=id;i++);if(_id){ids.splice(i,1);return true;}
return false;}
this.init=function(id,name,container_class,html,default_handler){this.id=id||getId();this.name=name;this.container_class=container_class;this.inner=html;this.container_ids=[];this.type=this.type||'single-view';this.default_handler=default_handler||'';this.requires_view||(this.requires_view='');if(!window.views){window.views={};}
window.views[id]=this;ids[ids.length]=this.id;}
this.addContainerId=function(id){this.container_ids[this.container_ids.length]=id;}
this.removeContainerId=function(id){var id_c='',i=0;for(;(id_c=this.container_ids[i])&&id_c!=id;i++);if(id_c){this.container_ids.splice(i,1);}}
this.createView=function(container){container.innerHTML=this.inner;}
this.ondestroy=function(){}
this.update=function(ele){if(ele){this.createView(ele);}
else
{var id='',i=0,container=null;for(;id=this.container_ids[i];i++){container=document.getElementById(id);if(container){this.createView(container);messages.post('view-created',{id:this.id,container:container});}}}}
this.applyToContainers=function(fn){var id='',i=0,container=null;for(;id=this.container_ids[i];i++){container=document.getElementById(id);if(container){fn(container);}}}
this.isvisible=function(){var id='',i=0;for(;id=this.container_ids[i];i++){if(document.getElementById(id)){return true;}}
return false;}
this.getAllContainers=function(){var id='',i=0,c=null,ret=[];for(;id=this.container_ids[i];i++){if(c=document.getElementById(id)){ret[ret.length]=c;}}
return ret;}
this.getToolbarControl=function(container,handler,handler_name){handler_name=handler_name||'handler';var toolbar=document.getElementById(container.id.replace(/container/,'toolbar'));if(toolbar){var all=toolbar.getElementsByTagName('*'),control=null,i=0;for(;control=all[i];i++){if(control.getAttribute(handler_name)==handler){return control;}}}
return null;}
this.clearAllContainers=function(){var id='',i=0,c=null,ret=[];for(;id=this.container_ids[i];i++){if(c=document.getElementById(id)){c.innerHTML="";}}}
this.onresize=function(container){}
var onHideView=function(msg){var view=window.views[msg.id];if(view){view.ondestroy();messages.post('view-destroyed',{id:msg.id});}}
messages.addListener('hide-view',onHideView);}
var View=function(id,name,container_class,html,default_handler){this.init(id,name,container_class,html,default_handler);}
View.prototype=ViewBase;var CompositeViewBase=function(){this.type='composite-view';this.update=function(cell){var id='',i=0,virtual_container=null;for(;id=this.container_ids[i];i++){if(virtual_container=(CellBase.getCellById([id.slice(13)])||{}).container){this.cell.left=cell.left+cell.left_border_padding;this.cell.top=cell.top+cell.top_border_padding;this.cell.width=cell.width;this.cell.height=cell.height;if(this.cell.width+this.cell.height){this.cell.setDefaultDimensions();this.cell.update(this.cell.left,this.cell.top,true);}}}}
this.initCompositeView=function(id,name,layout_rough){this.cell=new Cell(layout_rough,layout_rough.dir);this.init(id,name);}}
var CompositeView=function(id,name,rough_layout){this.initCompositeView(id,name,rough_layout);}
CompositeViewBase.prototype=ViewBase;CompositeView.prototype=new CompositeViewBase();var SettingView=function(id,name,container_class){this.ishidden_in_menu=true;this.hidden_in_settings=true;this.do_not_reset=true;this.createView=function(container){container.render(templates.settings(ViewBase.getSingleViews(['hidden_in_settings'])));}
this.syncSetting=function(view_id,key_name,is_checked){var cs=this.getAllContainers(),c=null,i=0;var inputs=null,input=null,j=0;for(;c=cs[i];i++){inputs=c.getElementsByTagName('input');for(j=0;input=inputs[j];j++){if(input.getAttribute('view-id')==view_id&&input.name==key_name){input.checked=is_checked;}}}}
this.init(id,name,container_class);}
SettingView.prototype=ViewBase;new SettingView('settings_view',ui_strings.S_BUTTON_LABEL_SETTINGS,'scroll');var UIBase=new function(){var self=this;var id_count=1;var ids={};var getId=function(){return 'ui-'+(id_count++).toString();}
this.getUIById=function(id){return ids[id];}
this._delete=function(id){delete ids[id];}
this.initBase=function(){ids[this.id=getId()]=this;}
this.parent_container_id='';this.getCssText=function(){return 'left:'+this.left+'px;'+'top:'+this.top+'px;'+'height:'+this.height+'px;'+'width:'+this.width+'px;';}
this.__is_visible=true;this.isvisible=function(){return document.getElementById(this.type+'-to-'+this.cell.id)&&true||false;}
this.getElement=function(){return document.getElementById(this.type+'-to-'+this.cell.id);}
this.update=function(force_redraw){if(force_redraw){this.is_dirty=true;}
var id=this.type+'-to-'+this.cell.id
var ele=document.getElementById(id);var attr_key='';if(!ele){ele=document.createElement(this.type);ele.id=id;ele.setAttribute('ui-id',this.id);if(this.attributes){for(attr_key in this.attributes){ele.setAttribute(attr_key,this.attributes[attr_key]);}}
if(this.parent_container_id){var parent_container=document.getElementById(this.parent_container_id);if(parent_container){parent_container.appendChild(ele);}
else
{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'missing parent_container in update in UIBase');}}
else
{viewport.appendChild(ele);}}
if(this.is_dirty){this.is_dirty=false;var css_text=this.getCssText();if(css_text!=ele.style.cssText){ele.style.cssText=css_text;}
this.update_sub_class();}
return ele;}
this.update_sub_class=function(){};this.getPropertiesSum=function(prop_arr){var
prop='',i=0,ret=0;for(;prop=prop_arr[i];i++){ret+=this.style[prop];}
return ret;}
this.horizontal_border_padding_properties=['border-right-width','border-left-width','padding-right','padding-left'];this.vertical_border_padding_properties=['border-top-width','border-bottom-width','padding-top','padding-bottom'];this.left_border_padding_properties=['border-left-width','padding-left'];this.top_border_padding_properties=['border-top-width','padding-top'];this.setCSSProperties=function(){this.vertical_border_padding=this.getPropertiesSum(this.vertical_border_padding_properties);this.horizontal_border_padding=this.getPropertiesSum(this.horizontal_border_padding_properties);this.left_border_padding=this.getPropertiesSum(this.left_border_padding_properties);this.top_border_padding=this.getPropertiesSum(this.top_border_padding_properties);this.default_height=this.height=this.style.height;this.offsetHeight=this.height+this.vertical_border_padding;this.offsetWidth=this.width+this.horizontal_border_padding;}
this.copyCSS=function(resolve_map){var
item=null,declaration=null,properties=null,property='',source=null,target=null,i=0,j=0,container=viewport.appendChild(document.createElement('div'));container.style.cssText='position:absolute;top:0;left:-1000px;';for(;item=resolve_map[i];i++){container.innerHTML='';source=container.appendChild(document.createElement(item.source));target=item.target.style={};properties=item.properties;if(source&&target){declaration=getComputedStyle(source,null);for(j=0;property=properties[j];j++){if(property.setProp){item.target[property.t_name]=property.setProp(source,declaration);}
else
{target[property.t_name?property.t_name:property.s_name]=parseInt(declaration.getPropertyValue(property.s_name));}}}}
viewport.removeChild(container);}
this.setVisibility=function(visibility){this.__is_visible=visibility=="visible";}
this.getFocusCatcher=function(){if(!document.getElementById(defaults.focus_catcher_id)){viewport.render
(['div',['input','id',defaults.focus_catcher_id],'style','position:absolute;left:-300px;top:0;width:100px;']);}
return document.getElementById(defaults.focus_catcher_id)}}
var TopUIBase=function(){this.changeStyleProperty=function(property,delta){var
sheets=document.styleSheets,sheet=null,i=0,rules=null,rule=null,cur_val=0,is_set=false;for(;(sheet=sheets[i])&&!is_set;i++){rules=sheet.cssRules;for(i=0;(rule=rules[i])&&!is_set;i++){if(rule.type==1&&rule.selectorText==this.type){cur_val=parseInt(rule.style.getPropertyValue('padding-right'));if(cur_val||cur_val==0){cur_val+=delta;rule.style.setProperty(property,cur_val+'px','');this.constructor.prototype.style[property]=cur_val;this.setCSSProperties();this.setDimensions();if(this.render){this.render();}
is_set=true;}}}}}}
var ToolbarBase=function(){this.type='toolbar';this.default_height=0;this.height=0;this.top_border=0;this.bottom_border=1;this.offsetHeight=0;this.getCssText=function(){return 'left:'+this.left+'px;'+'top:'+this.top+'px;'+'height:'+this.height+'px;'+'width:'+this.width+'px;'+'display:'+(this.height?'block':'none');}
this.attributes={'focus-handler':'focus','blur-handler':'blur'}
this.setDimensions=function(force_redraw){var dim='',i=0;if(!this.default_height){this.setCSSProperties()}
dim=this.cell.top;if(dim!=this.top){this.is_dirty=true;this.top=dim;}
dim=this.cell.left;if(dim!=this.left){this.is_dirty=true;this.left=dim;}
dim=this.cell.width-this.horizontal_border_padding;if(dim!=this.width){this.is_dirty=true;this.width=dim;}
dim=(this.__is_visible&&(this.buttons.length
||this.switches.length
||this.filters.length
||this.specials.length
||this.customs.length))?this.default_height:0;if(dim!=this.height){this.is_dirty=true;this.height=dim;this.offsetHeight=dim+this.vertical_border_padding;}
this.update(force_redraw)}
this.update_sub_class=function(){var toolbar=document.getElementById(this.type+'-to-'+this.cell.id);if(toolbar){var cst_select=toolbar.getElementsByTagName('cst-select')[0];if(cst_select){var
width=this.width,filter=toolbar.getElementsByTagName('filter')[0],previousEle=cst_select.previousElementSibling;if(filter){width-=filter.offsetWidth;}
if(previousEle){width-=(previousEle.offsetLeft+previousEle.offsetWidth);}
cst_select.style.width=(width-defaults['cst-select-margin-border-padding'])+'px';}}}
this.setVisibility=function(bool){this.__is_visible=bool;if(toolbars[this.__view_id]){toolbars[this.__view_id].setVisibility(bool);}}
this.setup=function(view_id){var toolbar=document.getElementById(this.type+'-to-'+this.cell.id)||this.update();toolbar.innerHTML='';this.filters=toolbars[view_id]&&toolbars[view_id].filters||[];this.buttons=toolbars[view_id]&&toolbars[view_id].buttons||[];this.switches=switches[view_id]&&switches[view_id].keys||[];this.specials=toolbars[view_id]&&toolbars[view_id].specials||[];this.customs=toolbars[view_id]&&toolbars[view_id].customs||[];this.__view_id=view_id;if(toolbars[view_id]){this.__is_visible=toolbars[view_id].getVisibility();}
var set_separator=this.buttons.length;if(this.__is_visible){if(this.filters.length){toolbar.render(templates.filters(this.filters));}
if(this.buttons.length){toolbar.render(templates.buttons(this.buttons));}
if(this.switches.length){if(set_separator){toolbar.render(templates.toolbarSeparator());}
else
{set_separator=true;}
toolbar.render(templates.switches(this.switches));}
if(this.specials.length){if(set_separator){toolbar.render(templates.toolbarSeparator());}
toolbar.render(templates.buttons(this.specials));}
if(this.customs.length){var custom=null,i=0;for(;custom=this.customs[i];i++){toolbar.render(custom.template(views[view_id]));}}}}
this.init=function(cell,buttons,filters,specials,customs){this.cell=cell;this.buttons=buttons||[];this.filters=filters||[];this.specials=specials||[];this.customs=customs||[];this.width=0;this.top=0;this.left=0;this.is_dirty=true;this.initBase();}}
var Toolbar=function(cell,buttons,filters,specials,customs){this.init(cell,buttons,filters,specials,customs);}
var TopToolbar=function(cell,buttons,filters,specials,customs){this.type='top-toolbar';this.init(cell,buttons,filters,specials,customs);}
var WindowToolbar=function(cell,buttons,filters,specials,customs){this.type='window-toolbar';this.parent_container_id=cell.id;this.init(cell,buttons,filters,specials,customs);this.getCssText=function(){return '';}}
ToolbarBase.prototype=UIBase;Toolbar.prototype=new ToolbarBase();TopToolbar.prototype=new ToolbarBase();TopUIBase.apply(TopToolbar.prototype);TopToolbar.prototype.constructor=TopToolbar;WindowToolbar.prototype=new ToolbarBase();var ToolbarConfigBase=new function(){var self=this;var id_count=1;var ids={};var getId=function(){return 'toolbar-'+(id_count++).toString();}
this.addContainerId=function(id){this.container_ids[this.container_ids.length]=id;}
this.removeContainerId=function(id){var id_c='',i=0;for(;(id_c=this.container_ids[i])&&id_c!=id;i++);if(id_c){this.container_ids.splice(i,1);}}
this.updateButtons=function(){var
id='',i=0,container=null,buttons=null,button=null,j=0;for(;id=this.container_ids[i];i++){container=document.getElementById(id);if(container){buttons=container.getElementsByTagName('toolbar-buttons')[0].getElementsByTagName('button');for(j=0;button=buttons[j];j++){button.disabled=this.buttons[j].disabled?true:false;}}}}
this.getButtonsByHandler=function(handler){var buttons=[],i=0,button=null;for(;button=this.buttons[i];i++){if(button.handler==handler){buttons[buttons.length]=button;}}
return buttons;}
this.getButtonById=function(id){var button=null,i=0;for(;(button=this.buttons[i])&&button.id!=id;i++);return button||null;}
this.enableButtons=function(){var buttons=null,button=null,handler='',i=0,j=0;for(;handler=arguments[i];i++){buttons=this.getButtonsByHandler(handler);for(j=0;button=buttons[j];j++){button.disabled=false;}}
this.updateButtons();}
this.disableButtons=function(){var buttons=null,button=null,handler='',i=0,j=0;for(;handler=arguments[i];i++){buttons=this.getButtonsByHandler(handler);for(j=0;button=buttons[j];j++){button.disabled=true;}}
this.updateButtons();}
this.setVisibility=function(bool){this.__is_visible=bool;}
this.getVisibility=function(){return this.__is_visible;}
this.init=function(name,optional_button_array,optional_filter_array,optional_special_button_array,optional_custom_button_array){ids[this.id=getId()]=this;this.buttons=optional_button_array||[];this.filters=optional_filter_array||[];this.specials=optional_special_button_array||[];this.customs=optional_custom_button_array||[];this.container_ids=[];this.__is_visible=true;if(!window.toolbars){window.toolbars={};}
window.toolbars[name]=this;}
this.getToolbarById=function(id){return ids[id];}
this._delete=function(id){delete ids[id];}}
var ToolbarConfig=function(name,optional_button_array,optional_filter_array,optional_special_button_array,optional_custom_button_array){this.init(name,optional_button_array,optional_filter_array,optional_special_button_array,optional_custom_button_array);}
ToolbarConfig.prototype=ToolbarConfigBase;var TabsBase=function(){const
HISTORY_MAX_LENGTH=10;this.type='tabs';this.height=25;this.width=200;this.top=0;this.left=0;this.is_dirty=true;this.cell_id='';this.depth=2;this.tabs=[];this.activeTab='';this._history=[];this.hasTab=function(ref_id){var i=0,tab=null;for(;(tab=this.tabs[i])&&tab.ref_id!=ref_id;i++);return tab&&true||false;}
this.addTab=function(){var i=0,tab=null;var container=document.getElementById('tabs-to-'+this.cell.id);for(;tab=arguments[i];i++){this.tabs[this.tabs.length]=tab;if(container){container.render(templates.tab(tab));}}}
this.removeTab=function(ref_id){var i=0,tab=null;for(;(tab=this.tabs[i])&&tab.ref_id!=ref_id;i++);if(tab){this.tabs.splice(i,1);var container=document.getElementById(this.type+'-to-'+this.cell.id);if(container){var tab=container.getElementsByTagName('tab')[i];if(tab){container.removeChild(tab);}
else
{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'tabs, removeTab. there should be a tab for that index');}}}
if(this.activeTab==ref_id){while(this._history[this._history.length-1]==ref_id){this._history.pop();}
if(this._history[this._history.length-1]){this.setActiveTab(this._history[this._history.length-1])}
else if(this.tabs[i]){this.setActiveTab(this.tabs[i].ref_id)}
else if(this.tabs[i-1]){this.setActiveTab(this.tabs[i-1].ref_id)}
else
{alert('destroy cell');}}}
this.render=function(){var tabs=document.getElementById(this.type+'-to-'+this.cell.id);if(!tabs){tabs=this.update();}
tabs.innerHTML='';tabs.render(templates[this.type](this));return tabs;}
this.setActiveTab=function(view_id,force_create){var container_id='container-to-'+this.cell.id;var toolbar_id='toolbar-to-'+this.cell.id;if(this.activeTab!=view_id||force_create){if(force_create){view_id=this.activeTab;}
else
{if(this.activeTab&&views[this.activeTab]){messages.post("hide-view",{id:this.activeTab});views[this.activeTab].removeContainerId(container_id);if(toolbars[this.activeTab]){toolbars[this.activeTab].removeContainerId(toolbar_id);}}
this.activeTab=view_id;if(views[view_id]){views[view_id].addContainerId(container_id);if(toolbars[view_id]){toolbars[view_id].addContainerId(toolbar_id);}
if(topCell.statusbar&&views[view_id].type=='composite-view'){topCell.statusbar.updateInfo();}}}
var container=document.getElementById(this.type+'-to-'+this.cell.id)||this.render();if(container){var tabs=container.getElementsByTagName('tab'),tab=null,i=0;if(tabs.length!=this.tabs.length){this.render();tabs=container.getElementsByTagName('tab')}
for(;tab=tabs[i];i++){if(tab.getAttribute('ref-id')==view_id){tab.addClass('active');}
else
{tab.removeClass('active');}}}
this.cell.setup();this._history[this._history.length]=this.activeTab;if(this._history.length>HISTORY_MAX_LENGTH){this._history.splice(0,this._history.length-HISTORY_MAX_LENGTH);}
messages.post("show-view",{id:view_id});if(views[view_id].type=='composite-view'){global_state.ui_framework.last_selected_top_tab=view_id;global_state.ui_framework.last_selected_tab='';}
else
{global_state.ui_framework.last_selected_tab=view_id;}}}
this.trySetAnActiveTab=function(){var tab=null,i=0;for(;(tab=this.tabs[i])&&tab.disabled;i++);if(tab){this.setActiveTab(tab.ref_id);}}
this.getTopPosition=function(){return this.cell.top+this.cell.height-this.offsetHeight;}
this.setDimensions=function(force_redraw){var dim='',i=0;if(!this.default_height){this.setCSSProperties();}
dim=this.getTopPosition();if(dim!=this.top){this.is_dirty=true;this.top=dim;}
dim=this.cell.left;if(dim!=this.left){this.is_dirty=true;this.left=dim;}
dim=this.cell.width-this.horizontal_border_padding;if(dim!=this.width){this.is_dirty=true;this.width=dim;}
this.update(force_redraw);}
this.init=function(cell){this.tabs=[];this.activeTab='';this.cell=cell;this.initBase();}}
var Tabs=function(cell){this.init(cell);}
TabsBase.prototype=UIBase;Tabs.prototype=new TabsBase();var TopTabsBase=function(){this.type='top-tabs';this.getTopPosition=function(){return this.cell.top+this.cell.toolbar&&this.cell.toolbar.offsetHeight||0;}
this.switch_history=function(is_attached){var cur='',i=0,map=composite_view_convert_table[is_attached.toString()];for(;cur=this._history[i];i++){this._history[i]=map[cur]||cur;}}}
var TopTabs=function(cell){this.init(this,arguments);this.tabs=[];this.activeTab='';this.cell=cell;}
TopTabsBase.prototype=new TabsBase();TopTabs.prototype=new TopTabsBase();TopUIBase.apply(TopTabs.prototype);TopTabs.prototype.constructor=TopTabs
var ContainerBase=function(){this.type='container';this.height=0;this.width=0;this.border_left=1;this.border_right=1;this.top=0;this.left=0;this.is_dirty=true;this.view_id='';this.setDimensions=function(force_redraw){var dim='',i=0;if(!this.default_height){this.setCSSProperties();}
var toolbar_height=this.cell.toolbar.height?this.cell.toolbar.offsetHeight:0;dim=this.cell.top+toolbar_height;if(dim!=this.top){this.is_dirty=true;this.top=dim;}
dim=this.cell.left;if(dim!=this.left){this.is_dirty=true;this.left=dim;}
dim=this.cell.width-this.horizontal_border_padding;if(dim!=this.width){this.is_dirty=true;this.width=dim;}
dim=this.cell.height-toolbar_height-this.cell.tab.offsetHeight-this.vertical_border_padding;if(dim!=this.height){this.is_dirty=true;this.height=dim;}
this.update(force_redraw);if(views[this.view_id]&&!force_redraw){views[this.view_id].onresize(document.getElementById(this.type+'-to-'+this.cell.id));}}
this.setup=function(view_id){var view=views[this.view_id=view_id];var container=document.getElementById(this.type+'-to-'+this.cell.id)||this.update();if(view){if(view.default_handler){container.setAttribute('handler',view.default_handler);}
else
{container.removeAttribute('handler');}
container.className=view.container_class||'';container.innerHTML='';view.update();}}
this.init=function(cell){this.cell=cell;this.initBase();}}
var Container=function(cell){this.init(cell);}
ContainerBase.prototype=UIBase;Container.prototype=new ContainerBase();var TopContainerBase=function(){this.type='top-container';this.height=0;this.width=0;this.border_left=1;this.border_right=1;this.top=0;this.left=0;this.is_dirty=true;this.view_id='';this.setDimensions=function(force_redraw){var dim='',i=0;if(!this.default_height){this.setCSSProperties();}
var toolbar_and_tabs_height=(this.cell.toolbar&&this.cell.toolbar.offsetHeight||0)+this.cell.tab.offsetHeight;dim=this.cell.top+toolbar_and_tabs_height;if(dim!=this.top){this.is_dirty=true;this.top=dim;}
dim=this.cell.left;if(dim!=this.left){this.is_dirty=true;this.left=dim;}
dim=this.cell.width-this.horizontal_border_padding;if(dim!=this.width){this.is_dirty=true;this.width=dim;}
dim=this.cell.height-toolbar_and_tabs_height-(this.cell.statusbar&&this.cell.statusbar.offsetHeight||0)-this.vertical_border_padding;;if(dim!=this.height){this.is_dirty=true;this.height=dim;}
this.update(force_redraw);views[this.view_id]&&views[this.view_id].onresize();}
this.setup=function(view_id){if(window[defaults.viewport]){var children=viewport.childNodes,child=null,i=children.length-1;var id=this.cell.id;var tabs=null,tab=null,k=0;for(;child=children[i];i--){if(child.nodeType==1&&child.id.indexOf(id)==-1){tabs=child.getElementsByTagName('tab');for(k=0;tab=tabs[k];k++){if(tab.hasClass('active')){messages.post("hide-view",{id:tab.getAttribute('ref-id')});}}
viewport.removeChild(child);}}}
var view=views[this.view_id=view_id];if(view){view.update(this);}
var _views=ViewBase.getSingleViews(),view='',i=0;for(;id=_views[i];i++){if(views[id].isvisible()){messages.post("show-view",{id:id});}}}
this.init=function(cell){this.cell=cell;this.initBase();}}
var TopContainer=function(cell){this.init(cell);}
TopContainerBase.prototype=UIBase;TopContainer.prototype=new TopContainerBase();var WindowContainerBase=function(){this.vertical_delta=0;this.getCssText=function(){return 'height:'+this.height+'px;';}
this.setDimensions=function(force_redraw){var dim='',i=0;if(!this.default_height){this.setCSSProperties();this.vertical_delta=defaults.window_header_offsetHeight+(this.cell.toolbar&&this.cell.toolbar.offsetHeight||0)+defaults.window_statusbar_offsetHeight+this.vertical_border_padding;}
dim=this.cell.height-this.vertical_delta;if(dim!=this.height){this.is_dirty=true;this.height=dim;}
this.update(force_redraw)
views[this.view_id]&&views[this.view_id].onresize();}
this.setup=function(view_id){var view=views[this.view_id=view_id];views[this.view_id].addContainerId(this.type+'-to-'+this.cell.id);this.setDimensions();var container=document.getElementById(this.type+'-to-'+this.cell.id)||this.update(true);if(view){container.className=view.container_class||'';view.update();}}
this.onclose=function(){views[this.view_id].removeContainerId(this.type+'-to-'+this.cell.id);}
this.init=function(cell){this.cell=cell;this.parent_container_id=cell.id;this.initBase();}}
var WindowContainer=function(cell){this.init(cell);}
WindowContainerBase.prototype=new ContainerBase();WindowContainer.prototype=new WindowContainerBase();var TabBase=new function(){var self=this;var id_count=1;var ids={};var getId=function(){return 'tab-'+(id_count++).toString();}
this.init=function(ref_id,name,has_close_button){this.name=name;this.ref_id=ref_id;this.has_close_button=has_close_button;ids[this.id=getId()]=this;}
this.getTabById=function(id){return ids[id];}
this._delete=function(id){delete ids[id];}}
var Tab=function(ref_id,name,has_close_button){this.init(ref_id,name,has_close_button)}
Tab.prototype=TabBase;var StatusbarBase=function(){this.type='statusbar';this.height=0;this.width=200;this.top=0;this.left=0;this.is_dirty=true;this.info='';this.DEFAULT_MODE="default";this.TOOLTIP_MODE="tooltip";this.mode=this.DEFAULT_MODE;this.selector_cap_width=0;this.available_width_delta=0;this.info_container_scroll_height=0;this.global_state_store=global_state.ui_framework;this.setup=function(view_id){var statusbar=document.getElementById(this.type+'-to-'+this.cell.id)||this.update();statusbar.render(templates[this.type](this));if(!this.selector_cap_width){var info_container=statusbar.getElementsByTagName('info')[0];info_container.innerHTML="<breadcrumb><span>t</span>&lt;<span>t</span></breadcrumb>";var spans=info_container.getElementsByTagName('span');var style=window.getComputedStyle(info_container,null);this.selector_cap_width=spans[1].offsetLeft-(spans[0].offsetLeft+spans[0].offsetWidth);this.info_container_scroll_height=info_container.scrollHeight;this.available_width_delta=info_container.offsetLeft
+parseInt(style.getPropertyValue('padding-left'))
+parseInt(style.getPropertyValue('padding-right'));}
if(this.mode==this.TOOLTIP_MODE){statusbar.addClass('type-tooltip');}
this.updateInfo(' ');}
this.updateInfo=function(info){var
statusbar=document.getElementById(this.type+'-to-'+this.cell.id)||this.update(),info_container=statusbar.getElementsByTagName('info')[0],breadcrumb=null,avaible_width=0,cursor=null,consumed_width=0,delta=0,range=null;info||(info="");this.info=info;if(typeof info=="string"){info_container.textContent=info;}
else if(typeof info=="object"){info_container.innerHTML="";breadcrumb=info_container.render(info);if(this.mode==this.DEFAULT_MODE&&info_container.scrollHeight>this.info_container_scroll_height){avaible_width=parseInt(info_container.parentElement.style.width)-this.available_width_delta;cursor=breadcrumb.lastElementChild;consumed_width=4*this.selector_cap_width;delta=0;range=document.createRange();while(cursor){delta=this.selector_cap_width+cursor.offsetWidth;if(delta+consumed_width>=avaible_width){break;}
consumed_width+=delta;cursor=cursor.previousElementSibling;}
if(cursor){range.setStartBefore(breadcrumb.firstChild);range.setEndAfter(cursor);range.deleteContents();breadcrumb.firstChild.nodeValue='...';}}}
else
{info_container.textContent='';}}
this.changeMode=function(){this.global_state_store[this.type+"_mode"]=this.mode=this.mode==this.DEFAULT_MODE&&this.TOOLTIP_MODE||this.DEFAULT_MODE;this.updateInfo(this.info);return this.mode;}
this.setDimensions=function(force_redraw){var dim='',i=0;if(!this.default_height){this.setCSSProperties()}
dim=this.cell.top+this.cell.height-this.offsetHeight;if(dim!=this.top){this.is_dirty=true;this.top=dim;}
dim=this.cell.left;if(dim!=this.left){this.is_dirty=true;this.left=dim;}
dim=this.cell.width-this.vertical_border_padding;if(dim!=this.width){this.is_dirty=true;this.width=dim;}
this.update(force_redraw);}
this.init=function(cell){this.cell=cell;this.initBase();if(this.global_state_store[this.type+"_mode"]){this.mode=this.global_state_store[this.type+"_mode"];}}}
var Statusbar=function(cell){this.init(cell);}
var WindowStatusbar=function(cell){this.type='window-statusbar';this.parent_container_id=cell.id;this.getCssText=function(){return '';}
this.init(cell);}
var TopStatusbar=function(cell){this.type='top-statusbar';var self=this;var handleHostState=function(msg){self.global_state_store.spin_state=msg.state;switch(msg.state){case 'inactive':{self.spin_animator.setInitial();break;}
case 'ready':{self.spin_animator.setFinal();break;}
case 'waiting':{self.spin_animator.setActive();break;}}}
messages.addListener('host-state',handleHostState);var spin_animator={id:'spin-button',delta:-16,iterations:8,ready:-16,active:-32,time_delta:60};this.spin_animator=new Animator(spin_animator);this.init(cell);}
StatusbarBase.prototype=UIBase;Statusbar.prototype=new StatusbarBase();WindowStatusbar.prototype=new StatusbarBase();TopStatusbar.prototype=new StatusbarBase();window.templates=window.templates||(window.templates={});(function(){var self=this;this.tab=function(obj,is_active_tab){return['tab',['input','type','button','value',obj.name,'handler','tab',],(obj.has_close_button?['input','type','button','handler','close-tab',]:[]),'ref-id',obj.ref_id].concat(is_active_tab?['class','active']:[]);}
this.filters=function(filters){var ret=['toolbar-filters'],filter='',i=0,default_text='';for(;filter=filters[i];i++){if(filter.type&&this[filter.type]){ret[ret.length]=this[filter.type](filter);}
else
{ret[ret.length]=['filter',['em',(default_text=filter.label?filter.label:ui_strings.S_INPUT_DEFAULT_TEXT_SEARCH)],['input','autocomplete','off','type','text','handler',filter.handler,'title',filter.title,'default-text',default_text]];}}
return ret;}
this.dropdown=function(filter){return['filter',['select','handler',filter.handler,'title',filter.title,'class',filter.class||''],'class','dropdown'];}
this.buttons=function(buttons){var ret=['toolbar-buttons'],button='',i=0;for(;button=buttons[i];i++){ret[ret.length]=['button','handler',button.handler,'title',button.title].concat(button.id?['id',button.id]:[],button.disabled?['disabled','disabled']:[],button.param?['param',button.param]:[],button.class_name?['class',button.class_name]:[]);}
return ret;}
this.switches=function(switches){var ret=['toolbar-switches'],_switch='',i=0;var arr=null,setting=null,key='';for(;_switch=switches[i];i++){arr=_switch.split('.');if(arr.length>1){setting=settings[arr[0]];key=arr[1];if(setting.exists(key)){ret[ret.length]=['button','handler','toolbar-switch','title',setting.label_map[key],'key',_switch,'is-active',setting.get(key)?'true':'false','class','switch'];}
else
{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+"Can't attach switch to a setting that does not exist: "+_switch);}}}
return ret;}
this.toolbarSeparator=function(){return['toolbar-separator'];}
this['top-statusbar']=function(ui_obj){return[['div','id',ui_obj.spin_animator.getId(),'title',ui_strings.S_LABEL_STATUS_INDICATOR],['input','type','button','handler','switch-info-type','title','switch info type','class','switch-info-type'],['info']]}
this['window-statusbar']=function(){return[['info']]}
this.configButton=function(handler){return['button','type','button','handler',handler,'title',ui_strings.S_BUTTON_LABEL_SETTINGS];}
this.tabs=function(obj){var ret=[];var tab=null,i=0;for(;tab=obj.tabs[i];i++){if(!tab.disabled){ret[ret.length]=this.tab(tab,obj.activeTab==tab.ref_id)}}
return ret;}
this.viewMenu=function(){return \
['ui-menu',['h2',ui_strings.M_VIEW_LABEL_VIEWS,'handler','show-menu','tabindex','1'],'id','main-view-menu'].concat(opera.attached?['class','attached']:[]);}
this['top-tabs']=function(obj){var ret=[];var tab=null,i=0;for(;tab=obj.tabs[i];i++){ret[ret.length]=this.tab(tab,obj.activeTab==tab.ref_id)}
return ret;}
this.window_controls=function(is_attached){var attached=window.opera.attached;return['window-controls',is_attached
?window['cst-selects']['debugger-menu'].select_template()
:[],['button','handler','top-window-toggle-attach','class','switch'+(attached?' attached':''),'title',attached?ui_strings.S_SWITCH_DETACH_WINDOW:ui_strings.S_SWITCH_ATTACH_WINDOW],is_attached
?['button','handler','top-window-close','title',ui_strings.S_BUTTON_LABEL_CLOSE_WINDOW]
:[]].concat(is_attached?['class','attached']:[])}
this.settings=function(view_arr){var
ret=['settings-container'],view_id=null,view=null,i=0;for(;view_id=view_arr[i];i++){if(settings[view_id]){view=views[view_id];ret[ret.length]=this.setting(view_id,view.name,view.isvisible());}}
return ret;}
this.setting=function(view_id,view_name,is_unfolded){var ret=['settings',self.settingsHeader(view_id,view_name,is_unfolded)];if(is_unfolded){var setting=settings[view_id];var settings_map=setting.setting_map;var cat_name='';for(cat_name in settings_map){ret[ret.length]=this[cat_name](setting,settings_map[cat_name]);}
if(setting.template){ret[ret.length]=setting.template();}}
return ret;}
this.settingsHeader=function(view_id,view_name,is_unfolded){return['settings-header',['input','type','button','tab-id',view_id].concat(is_unfolded?['class','unfolded']:[]),view_name,'handler','toggle-setting','view-id',view_id];}
this.checkboxes=function(setting,checkbox_arr){var checkboxes=['checkboxes'],arr=null,view_id='',key='',i=0;for(;key=checkbox_arr[i];i++){if(key.indexOf('.')==-1){checkboxes[checkboxes.length]=this.settingCheckbox
(setting.view_id,key,setting.get(key),setting.label_map[key]);}
else
{arr=key.split('.');view_id=arr[0];key=arr[1];if(settings[view_id]){checkboxes[checkboxes.length]=this.settingCheckbox
(view_id,key,settings[view_id].get(key),settings[view_id].label_map[key],setting.view_id);}
else
{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'failed in ui-templates checkboxes '+arr+' '+setting.view_id);}}}
return checkboxes;}
this.settingCheckbox=function(view_id,key,value,label,host){var input=['input','type','checkbox','handler','checkbox-setting','name',key,'view-id',view_id];if(value){input.splice(input.length,0,'checked','checked');}
if(host){input.splice(input.length,0,'host-view-id',host);}
return['checkbox',['label',input,label]];}
this._window=function(win){return['window',this.window_header(views[win.view_id].name),this.window_shadows(),['window-control','handler','window-scale-top-left'],['window-control','handler','window-scale-top'],['window-control','handler','window-scale-top-right'],['window-control','handler','window-scale-right'],['window-control','handler','window-scale-bottom'],['window-control','handler','window-scale-bottom-right'],['window-control','handler','window-scale-bottom-left'],['window-control','handler','window-scale-left'],'id',win.id,'style','top:'+win.top+'px;'+'left: '+win.left+'px;'+'width: '+win.width+'px;'+'height: '+win.height+'px;','view_id',win.view_id]}
this.window_header=function(name){return['window-header',['window-control','handler','window-close'],name,'handler','window-move']}
this.window_shadows=function(){return['window-shadows',['window-shadow','class','top-left'],['window-shadow','class','top'],['window-shadow','class','top-right'],['window-shadow','class','left'],['window-shadow','class','right'],['window-shadow','class','bottom-left'],['window-shadow','class','bottom'],['window-shadow','class','bottom-right']];}}).apply(window.templates);var EventHandler=function(type,is_capturing,handler_key){handler_key=handler_key?handler_key:'handler';if(!window.eventHandlers){window.eventHandlers={};}
if(window.eventHandlers[type]){return;}
window.eventHandlers[type]={};var handler=function(event){var ele=event.target,handler=null,container=null;if(ele.nodeType!=1){return;}
if(event.which==3){event.stopPropagation();event.preventDefault();return;}
handler=ele.getAttribute(handler_key);while(!handler&&(ele=ele.parentElement)){handler=ele.getAttribute(handler_key);}
if(handler&&eventHandlers[type][handler]){if(type=='click'&&/toolbar-buttons/.test(ele.parentNode.nodeName)){container=document.getElementById(ele.parentNode.parentNode.id.replace('toolbar','container'));}
eventHandlers[type][handler](event,ele,container);}}
this.post=function(handler,event){if(eventHandlers[type][handler]){eventHandlers[type][handler](event);}}
document.addEventListener(type,handler,is_capturing?is_capturing:false);}
new EventHandler('click');new EventHandler('dblclick',false,'edit-handler');new EventHandler('change');new EventHandler('input');new EventHandler('keyup',true);new EventHandler('keydown',true);new EventHandler('keypress',true);new EventHandler('mousedown');new EventHandler('focus',true,'focus-handler');new EventHandler('blur',true,'blur-handler');eventHandlers.click['tab']=function(event,target){target=target.parentElement;var tabs=UIBase.getUIById(target.parentElement.getAttribute('ui-id'));var view_id=target.getAttribute('ref-id');if(tabs){tabs.setActiveTab(view_id);}
else
{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+"tabs is missing in eventHandlers.click['tab'] in ui-actions");}}
eventHandlers.click['close-tab']=function(event,target){target=target.parentElement;var
tabs=UIBase.getUIById(target.parentElement.getAttribute('ui-id')),view_id=target.getAttribute('ref-id'),store=global_state.ui_framework.temporary_tabs,cursor='',i=0;tabs.removeTab(view_id);for(;(cursor=store[i])&&cursor!=view_id;i++);if(cursor){store.splice(i,1);}}
eventHandlers.click['settings-tabs']=function(event,target){var tabs=UIBase.getUIById(target.parentElement.getAttribute('ui-id'));windows.showWindow('window-3','Settings',templates.settings(tabs),200,200,200,200);}
eventHandlers.click['toggle-setting']=function(event,target){var old_setting=target.parentElement;var view_id=target.getAttribute('view-id');var view=views[view_id];var setting=document.render(templates.setting(view_id,view.name,!target.firstChild.hasClass('unfolded')));old_setting.parentElement.replaceChild(setting,old_setting);}
eventHandlers.click['show-window']=function(event){var target=event.target;var view_id=target.getAttribute('view-id');target.parentNode.parentNode.parentNode.removeChild(target.parentNode.parentNode);UIWindowBase.showWindow(view_id);}
eventHandlers.click['top-settings']=function(event){UIWindowBase.showWindow('settings_view');}
eventHandlers.click['documentation']=function(event){window.open(event.target.getAttribute('param'),'_info_window').focus();}
eventHandlers.click['top-window-close']=function(event){window.close();}
eventHandlers.click['top-window-toggle-attach']=function(event){viewsMenu.remove();window.topCell.onresize=function(){};var is_attached=(window.opera.attached=!window.opera.attached);document.documentElement.removeChild(event.target.parentNode);var win_controls=document.documentElement.render(templates.window_controls(is_attached));topCell.tab.switch_history(is_attached);if(is_attached){topCell.tab.changeStyleProperty("padding-right",50);topCell.toolbar.changeStyleProperty("padding-right",-30);}
else
{topCell.tab.changeStyleProperty("padding-right",-50);topCell.toolbar.changeStyleProperty("padding-right",30);}
settings.general.set('window-attached',is_attached||false);if(settings.general.get('show-views-menu')){viewsMenu.create();}
setTimeout(client.setupTopCell,0);}
eventHandlers.click['toolbar-switch']=function(event){var target=event.target;var arr=target.getAttribute('key').split('.');var setting=arr[0],key=arr[1];var is_active=!(target.getAttribute('is-active')=='true'&&true||false);settings[setting].set(key,is_active);views.settings_view.syncSetting(setting,key,is_active);views[setting].update();messages.post("setting-changed",{id:setting,key:key});target.setAttribute('is-active',is_active?'true':'false');target.style.backgroundColor="transparent";target.style.removeProperty('background-color');}
eventHandlers.change['checkbox-setting']=function(event){var ele=event.target;var view_id=ele.getAttribute('view-id');settings[view_id].set(ele.name,ele.checked,true);views[view_id].update();var host_view=ele.getAttribute('host-view-id');if(host_view){views.settings_view.syncSetting(view_id,ele.name,ele.checked);}
messages.post("setting-changed",{id:view_id,key:ele.name});}
eventHandlers.focus['focus']=function(event,target){var parent=event.target.parentNode;if(parent.nodeName=='filter'){parent.firstChild.textContent='';parent.addClass('focus');if(event.target.value){event.target.selectionStart=0;event.target.selectionEnd=event.target.value.length;}}}
eventHandlers.blur['blur']=function(event,target){var parent=event.target.parentNode;if(parent.nodeName=='filter'){if(!event.target.value){parent.firstChild.textContent=event.target.getAttribute('default-text');}
parent.removeClass('focus');}}
eventHandlers.click['switch-info-type']=function(event,target){var parent=event.target.parentNode;var mode=topCell.statusbar.changeMode();if(mode=="tooltip"){parent.addClass('type-tooltip');}
else
{parent.removeClass('type-tooltip');}}
var SettingsBase=function(){var syncView=function(key,value){var
switches=document.getElementsByTagName('toolbar-switches'),_switch=null,butttons=null,button=null,i=0,j=0,key_id=this.view_id+'.'+key,force_reflow=false;for(;_switch=switches[i];i++){force_reflow=false;buttons=_switch.getElementsByTagName('button');for(j=0;button=buttons[j];j++){if(button.getAttribute('key')==key_id){button.setAttribute('is-active',value?"true":"false");force_reflow=true;}}
if(force_reflow){_switch.innerHTML+="";}}}
this.set=function(key,value,sync_switches){storage.set(key,(this.map[key]=value));if(sync_switches&&typeof value=='boolean'){syncView(key,value);}}
this.get=function(key){return this.map[key];}
this.exists=function(key){return key in this.map;}
this.init=function(view_id,key_map,label_map,setting_map,template){this.map={};this.view_id=view_id;this.label_map=label_map;this.setting_map=setting_map;this.template=template;var stored_map=key_map,key='';for(key in stored_map){this.map[key]=storage.get(key,key_map[key]);}
if(!window.settings){window.settings={};}
window.settings[arguments[0]]=this;}}
var Settings=function(view_id,key_map,label_map,setting_map,template){this.init(view_id,key_map,label_map,setting_map,template);}
Settings.prototype=new SettingsBase();var ViewsMenu=function(menu_id){var hideTimeouts=new Timeouts();var menu=null;var self=this;var default_actions=[{label:"Show Live Source of DF",handler:"df-show-live-source"}];this.getAllViews=function(){}
this.getHiddenViews=function(){var hiddenViews=UIBase.getSingleUnvisibleViews();}
var sortViewsWithIds=function(a,b){var
name_a=views[a].name
name_b=views[b].name;return name_a>name_b&&1||name_a<name_b&&-1||0;}
var show=function(event){hideTimeouts.clear();var ul=menu.getElementsByTagName('ul')[0];if(!ul){var
_views=ViewBase.getSingleViews(['ishidden_in_menu']),unvisbibleViews=[],view='',i=0;for(;id=_views[i];i++){if(!views[id].isvisible()){unvisbibleViews[unvisbibleViews.length]=id;}}
unvisbibleViews.sort(sortViewsWithIds);menu.render(menuTemplate(unvisbibleViews));}}
var menuItemTemplate=function(id){return;}
var menuTemplate=function(view_id_arr){var
ret=['ul'],id='',i=0;for(;id=default_actions[i];i++){ret[ret.length]=['li',['h2',id.label,'handler',id.handler,'tabindex','1']]}
for(i=0;id=view_id_arr[i];i++){ret[ret.length]=['li',['h2',views[id].name,'handler','show-window','view-id',id,'tabindex','1']]}
return ret;}
var __hide=function(){var ul=menu.getElementsByTagName('ul')[0];if(ul){menu.removeChild(ul);}}
var hide=function(event){hideTimeouts.set(__hide,100);}
var init=function(event){menu=document.getElementById(menu_id);if(menu){document.removeEventListener('DOMNodeInserted',arguments.callee,false);menu.addEventListener('mouseover',show,false);menu.addEventListener('mouseout',hide,false);}}
this.create=function(){document.addEventListener('DOMNodeInserted',init,false);document.documentElement.render(templates.viewMenu());if(opera.attached){topCell.tab.changeStyleProperty("padding-right",188);}
else
{topCell.toolbar.changeStyleProperty("padding-right",188);}}
this.remove=function(){menu=document.getElementById(menu_id);if(menu){menu.parentNode.removeChild(menu);if(opera.attached){topCell.tab.changeStyleProperty("padding-right",-188);}
else
{topCell.toolbar.changeStyleProperty("padding-right",-188);}}}
var onSettingChange=function(msg){if(msg.id=='general'){switch(msg.key){case 'show-views-menu':{if(settings.general.get(msg.key)){self.create();}
else
{self.remove();}
break;}}}}
messages.addListener('setting-changed',onSettingChange);}
window.viewsMenu=new ViewsMenu('main-view-menu');var SlideViews=function(container){const VER='v',HOR='h';var self=this;var focus_catcher=null;var mousedownevents=null;var resizehandler=function(){if(!self.checkDimesions()){self.cell.update(self.cell.left,self.cell.top,true);}}
var _target=null;var _delta=0;var _event=null;var interval=0;var intervaled_mousemovehandler=function(event){_target.handleResizeEvent(_event,_delta);}
var mousemovehandler=function(event){_event=event;focus_catcher.focus();}
var mouseuphandler=function(event){clearInterval(interval);_event=event;intervaled_mousemovehandler();document.removeEventListener('mousemove',mousemovehandler,false);document.removeEventListener('mouseup',mouseuphandler,false);_target=null;_delta=0;_event=null;}
var mousedownhandler=function(event){var ele=event.target;if(ele.nodeName.indexOf(defaults.slider_name)==0){event.stopPropagation();event.preventDefault();var target=CellBase.getCellById(ele.id.slice(11));_event=event;if(target){_target=target;_delta=event[target.dir==HOR?'offsetY':'offsetX']+2*defaults.view_border_width;document.addEventListener('mousemove',mousemovehandler,false);document.addEventListener('mouseup',mouseuphandler,false);interval=setInterval(intervaled_mousemovehandler,15);}
else
{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'missing target in mousedownhandler in slideViews');}
if(!focus_catcher){focus_catcher=UIBase.getFocusCatcher();}}}
container.addEventListener('mousedown',mousedownhandler,false);}
var Animator=function(target){var id=target.id;var delta=target.delta;var iterations=target.iterations;var active=target.active||0;var finalState=target.ready||0;var x_position=target.x_position||'0px ';var time_delta=target.time_delta||30;var current_count=0;var interval=0;var spin=function(){var ele=document.getElementById(id);if(ele){ele.style.backgroundPosition=x_position+(active+(current_count++)*delta)+'px';if(current_count>=iterations){current_count=0;}}}
this.setActive=function(){interval=interval?interval:setInterval(spin,time_delta);}
this.setFinal=function(){interval=interval?clearInterval(interval):0;var ele=document.getElementById(id);if(ele){ele.style.backgroundPosition=x_position+(finalState)+'px';current_count=0;}}
this.setInitial=function(){interval=interval?clearInterval(interval):0;if(ele=document.getElementById(id)){ele.style.backgroundPosition=x_position+(0)+'px';current_count=0;}}
this.getId=function(){return id;}
this.getState=function(){var ele=document.getElementById(id);return(interval&&'active'
||ele&&ele.style.backgroundPosition.indexOf(' '+finalState+'px')!=-1&&'final'
||'initial');}}
var SwitchesBase=function(){this.init=function(view_id,keys){this.view_id=view_id;var key='',i=0;for(;key=keys[i];i++){if(key.indexOf('.')==-1){keys[i]=view_id+'.'+key;}}
this.keys=keys;if(!window.switches){window.switches={};}
window.switches[view_id]=this;}}
var Switches=function(view_id,key_map){this.init(view_id,key_map);}
Switches.prototype=new SwitchesBase();var Editor=function(){var self=this;const
SELECTION=1,TOKEN=2,VALUE=3;this.base_style={'font-family':'','line-height':0,'font-size':0}
this.char_width=0;this.line_height=0;this.cssText='';this.textarea_container=null;this.textarea=null;this.host_element_border_padding_left=0;this.host_element_border_padding_top=0;this.tab_context_value='';this.tab_context_tokens=null;this.context_cur_prop='';this.context_cur_value='';this.context_cur_priority='';this.context_cur_text_content='';this.last_suggets_type=null;this.suggets_count=0;this.suggets_iterate=false;this.property_list_length=0;this.colors=new Colors();this.get_base_style=function(ele){var
style=getComputedStyle(ele,null),props=['font-family','line-height','font-size'],prop=null,i=0,span=document.createElement('test-element'),cssText='display:block;position:absolute;left:-100px;top:0;white-space:pre;';for(;prop=props[i];i++){this.base_style[prop]=style.getPropertyValue(prop);cssText+=prop+':'+this.base_style[prop]+';';}
span.textContent='1234567890';document.documentElement.appendChild(span);span.style.cssText=cssText;this.char_width=span.offsetWidth/10;this.base_style['line-height']=(this.line_height=span.offsetHeight)+'px';document.documentElement.removeChild(span);this.host_element_border_padding_left=parseInt(style.getPropertyValue('padding-left'))+parseInt(style.getPropertyValue('border-left-width'));this.host_element_border_padding_top=parseInt(style.getPropertyValue('padding-top'))+parseInt(style.getPropertyValue('border-top-width'));cssText='';for(prop in this.base_style){cssText+=prop+':'+this.base_style[prop]+';';}
this.textarea_container=document.createElement('textarea-container');this.textarea=this.textarea_container.
appendChild(document.createElement('textarea-inner-container')).
appendChild(document.createElement('textarea'));this.textarea.style.cssText=cssText;this.textarea.oninput=input_handler;}
this.getAllTokens=function(){const
SPACE=1,COMMA=2,BRACKET_OPEN=3,BRACKET_CLOSE=4,END=5,SEMICOLON=6;var
re_str=/(?:"(?:[^"]|\\")*")|(?:'(?:[^']|\\')*')/g,re_token=/([^,] +)|(, *)|(\( *)|(\))|($)|(;)/g,value=this.textarea.value,cur_pos=0,last_pos=0,next_pos=0,char_pos=value.length-2,match_str=null,match_token=null,ret=[];re_str.lastIndex=0;match_str=re_str.exec(value);if((cur_pos=value.indexOf(':',0))>-1){ret.splice(0,0,value.slice(0,cur_pos),0,cur_pos);cur_pos++;while(value.charAt(cur_pos)==' '){cur_pos++;}
re_token.lastIndex=cur_pos;while(match_token=re_token.exec(value)){if(match_str&&match_str.index<=re_token.lastIndex+1){ret.splice(ret.length,0,match_str.index,re_str.lastIndex);re_token.lastIndex=re_str.lastIndex;match_str=re_str.exec(value);}
else if(match_token[BRACKET_OPEN]){cur_pos=re_token.lastIndex;}
else if(match_token.index>cur_pos){ret.splice(ret.length,0,cur_pos,match_token.index+(match_token[SPACE]?1:0));}
if(match_token.index>char_pos){break;}
cur_pos=re_token.lastIndex;}}
else
{ret.splice(0,0,value,0,value.length);}
return ret;}
this.getNextToken=function(char_pos){var
re_str=/(?:"(?:[^"]|\\")*")|(?:'(?:[^']|\\')*')/g,re_token=/([^,] +)|(, *)|(\( *)|(\))|($)|(;)/g,value=this.textarea.value,cur_pos=0,last_pos=0,next_pos=0,match_str=null,match_token=null;re_str.lastIndex=0;match_str=re_str.exec(value);if(char_pos>=value.length-1){char_pos=value.length-2;}
if((cur_pos=value.indexOf(':',0))>-1){if(cur_pos>=char_pos){return{start:0,end:cur_pos};}
cur_pos++;while(value.charAt(cur_pos)==' '){cur_pos++;}
re_token.lastIndex=cur_pos;while(match_token=re_token.exec(value)){if(match_str&&match_str.index<=re_token.lastIndex+1){if(re_str.lastIndex>=char_pos){return{start:match_str.index,end:re_str.lastIndex};}
re_token.lastIndex=re_str.lastIndex;match_str=re_str.exec(value);continue;}
if(match_token.index>char_pos){if(match_token[3]){cur_pos=re_token.lastIndex;continue;}
return{start:cur_pos,end:match_token.index+(match_token[1]?1:0)};}
cur_pos=re_token.lastIndex;}}
return null;}
this.getProperties=function(){var
re_str=/(?:"(?:[^"]|\\")*")|(?:'(?:[^']|\\')*')/g,re_token=/(;)|($)/g,re_important=/ *!important/,value=this.textarea.value,last_pos=0,cur_pos=0,important_pos=0,prop='',val='',priority=0,match_str=null,match_token=null,match_important=null,ret=[];while((cur_pos=value.indexOf(':',last_pos))>-1){prop=value.slice(last_pos,cur_pos);cur_pos++;while(value.charAt(cur_pos)==' '||value.charAt(cur_pos)=='\n'){cur_pos++;}
re_str.lastIndex=re_token.lastIndex=cur_pos;match_str=re_str.exec(value);while(match_token=re_token.exec(value)){if(match_str&&match_token.index<re_str.lastIndex){re_token.lastIndex=re_str.lastIndex;match_str=re_str.exec(value);continue;}
break;}
if(match_token){val=value.slice(cur_pos,re_token.lastIndex-(match_token[1]?1:0));priority=0;if(match_important=re_important.exec(val)){val=val.slice(0,match_important.index);priority=1;}
ret.splice(ret.length,0,prop,val,priority);last_pos=re_token.lastIndex;if(last_pos+1>=value.length){break;}}}
if(last_pos<value.length&&(val=value.slice(last_pos))){ret[ret.length]=val;}
return ret;}
this.getCharPosition=function(event){var
box=this.textarea.getBoundingClientRect(),left=event.clientX-box.left,top=event.clientY-box.top,charOffset=0,cur_top=this.line_height,previous_line_chars=0,re=/[ -/\n,]/g,match=null,prev_match_index=0,value=this.textarea.value,max_line_char=this.textarea.offsetWidth/this.char_width>>0;re.lastIndex=0;if(isNaN(left)){charOffset=this.context_cur_prop.length+1;}
else
{while(top>cur_top&&(match=re.exec(value))){if(match.index-previous_line_chars>max_line_char){previous_line_chars=prev_match_index+1;cur_top+=this.line_height;}
prev_match_index=match.index;}
if(top<cur_top){charOffset=previous_line_chars+((left-(left%this.char_width))/this.char_width);}}
var selection=this.getNextToken(charOffset);if(selection){this.textarea.selectionStart=selection.start;this.textarea.selectionEnd=selection.end;}}
this.edit=function(event,ref_ele){var ele=ref_ele||event.target;var sheet_link=ele.parentElement.getElementsByTagName('stylesheet-link')[0];if(!this.base_style['font-size']){this.get_base_style(ref_ele||ele);}
if(this.textarea_container.parentElement){this.submit();}
this.context_rt_id=ele.parentElement.parentElement.getAttribute('rt-id');this.context_rule_id=ele.parentElement.getAttribute('rule-id');this.context_stylesheet_index=sheet_link?parseInt(sheet_link.getAttribute('index')):-1;var textContent=ele.textContent;this.context_cur_text_content=this.textarea.value=ele.textContent;var props=this.getProperties();this.context_cur_prop=props[0]||'';this.context_cur_value=props[1]||'';this.context_cur_priority=props[2]||0;this.last_suggets_type='';this.textarea.style.height=(ele.offsetHeight)+'px';ele.textContent='';ele.appendChild(this.textarea_container);if(event){this.getCharPosition(event);this.textarea.focus();}}
this.nav_next=function(event,action_id){var
cur_pos=this.textarea.selectionEnd,i=1;if(this.textarea.value!=this.tab_context_value){this.tab_context_tokens=this.getAllTokens();this.tab_context_value=this.textarea.value;}
if(this.tab_context_tokens){for(;i<this.tab_context_tokens.length;i+=2){if(this.tab_context_tokens[i+1]>cur_pos){this.textarea.selectionStart=this.tab_context_tokens[i];this.textarea.selectionEnd=this.tab_context_tokens[i+1];return true;}}}
return false;}
this.nav_previous=function(event,action_id){var
cur_pos=this.textarea.selectionStart,i=1;if(this.textarea.value!=this.tab_context_value){this.tab_context_tokens=this.getAllTokens();this.tab_context_value=this.textarea.value;}
if(this.tab_context_tokens){for(i=this.tab_context_tokens.length-1;i>1;i-=2){if(this.tab_context_tokens[i]<cur_pos){this.textarea.selectionStart=this.tab_context_tokens[i-1];this.textarea.selectionEnd=this.tab_context_tokens[i];return true;}}}
return false;}
this.focusFirstToken=function(){this.tab_context_tokens=this.getAllTokens();this.tab_context_value=this.textarea.value;if(this.tab_context_tokens&&this.tab_context_tokens[2]){this.textarea.selectionStart=this.tab_context_tokens[1];this.textarea.selectionEnd=this.tab_context_tokens[2];}
else
{this.textarea.selectionStart=0;this.textarea.selectionEnd=0;}
this.textarea.focus();}
this.focusLastToken=function(){this.tab_context_tokens=this.getAllTokens();this.tab_context_value=this.textarea.value;if(this.tab_context_tokens&&this.tab_context_tokens[2]){this.textarea.selectionStart=this.tab_context_tokens[this.tab_context_tokens.length-2];this.textarea.selectionEnd=this.tab_context_tokens[this.tab_context_tokens.length-1];}
else
{this.textarea.selectionStart=this.tab_context_value.length;this.textarea.selectionEnd=this.tab_context_value.length;}
this.textarea.focus();}
this.autocomplete=function(event,action_id){var
cur_start=this.textarea.selectionStart,new_start=0,cur_end=this.textarea.selectionEnd,value=this.textarea.value,cur_token='',i=1,suggest=''
if(this.textarea.value!=this.tab_context_value){this.tab_context_tokens=this.getAllTokens();this.tab_context_value=this.textarea.value;}
if(this.tab_context_tokens){for(;i<this.tab_context_tokens.length;i+=2){if(cur_start>=this.tab_context_tokens[i]&&cur_start<=this.tab_context_tokens[i+1]){cur_token=value.slice(this.tab_context_tokens[i],this.tab_context_tokens[i+1]);break;}}}
suggest=this.getSuggest
(this.tab_context_tokens&&this.tab_context_tokens[0]||'',this.tab_context_tokens&&cur_end<=this.tab_context_tokens[2],cur_token,cur_start,cur_end,action_id);if(suggest){switch(suggest.replace_type){case SELECTION:{new_start=this.tab_context_tokens[i];this.textarea.value=value.slice(0,new_start)+suggest.value+value.slice(this.tab_context_tokens[i+1]);this.textarea.selectionStart=cur_start;this.textarea.selectionEnd=new_start+suggest.value.length;break;}
case TOKEN:{new_start=this.tab_context_tokens[i];this.textarea.value=value.slice(0,new_start)+suggest.value+value.slice(this.tab_context_tokens[i+1]);this.textarea.selectionStart=new_start;this.textarea.selectionEnd=new_start+suggest.value.length;break;}
case VALUE:{new_start=this.tab_context_tokens[2]+2;this.textarea.value=this.tab_context_tokens[0]+': '+suggest.value;this.textarea.selectionStart=new_start;this.textarea.selectionEnd=new_start+suggest.value.length;break;}}
this.textarea.style.height=this.textarea.scrollHeight+'px';this.commit();}
return false;}
this.getSuggest=function(prop_name,is_prop,token,cur_start,cur_end,action_id){var
re_num=/^(-?)([\d.]+)(.*)$/,match=null,suggest=null,suggest_type=(is_prop&&'suggest-property')
||((match=re_num.exec(token))&&'suggest-number')
||('suggest-value'),suggest_handler=this[suggest_type];suggest_handler.cursor=this.setCursor
(this.suggets_iterate=this.last_suggets_type==suggest_type,suggest_handler.cursor,suggest_handler.matches=this[suggest_type](token,cur_start,cur_end,action_id,match),action_id)
this.last_suggets_type=suggest_type;suggest=suggest_handler.matches&&suggest_handler.matches[suggest_handler.cursor];return suggest&&{value:suggest,replace_type:suggest_handler.replace_type}||null;}
this.getMatchesFromList=function(list,set){var
ret=[],length=list&&list.length||0,i=0;if(length==1){return list;}
if(length&&set){for(;i<length;i++){if(list[i].indexOf(set)==0){ret[ret.length]=list[i];}}}
else
{ret=list.slice(0);}
return ret;}
this.setCursor=function(iterate,cur_cursor,matches,action_id){if(iterate&&matches){cur_cursor+=(action_id==action_ids.NAV_UP?-1:1);if(cur_cursor>matches.length-1){cur_cursor=0;}
else if(cur_cursor<0){cur_cursor=matches.length-1;}}
else
{cur_cursor=0;}
return cur_cursor;}
this.onclick=function(event){event.preventDefault();event.stopPropagation();if(!this.textarea_container.contains(event.target)){this.submit(true);return false;}
return true;}
this['suggest-property']=function(token,cur_start,cur_end,action_id,match){if(!this.property_list){this.property_list=stylesheets.getSortedProperties();this.property_list_length=this.property_list.length;}
return this.getMatchesFromList(this.property_list,this.textarea.value.slice(this.tab_context_tokens[1],cur_start));}
this['suggest-property'].replace_type=SELECTION;this['suggest-property'].cursor=0;this['suggest-property'].matches=null;this['suggest-number']=function(token,cur_start,cur_end,action_id,match){var is_float=/\.(\d+)/.exec(match[2]);if(is_float){return[(parseFloat(match[1]+match[2])+(action_id==action_ids.NAV_UP?0.1:-0.1)).toFixed(is_float[1].length)+match[3]];}
return[(parseInt(match[1]+match[2])+(action_id==action_ids.NAV_UP?1:-1)).toString()+match[3]];}
this['suggest-number'].replace_type=TOKEN;this['suggest-number'].cursor=0;this['suggest-number'].matches=null;this['suggest-value']=function(token,cur_start,cur_end,action_id,match){var
prop=this.tab_context_tokens[0],set=this.tab_context_tokens[3]
&&this.textarea.value.slice(this.tab_context_tokens[3],cur_start)
||'',re_hex=/^#([0-9a-f]{6})$/i,match=null,hsl=null,rgb=null;if(set==this['suggest-value'].last_set&&prop==this['suggest-value'].last_prop){return this['suggest-value'].matches;}
this['suggest-value'].last_set=set;this['suggest-value'].last_prop=prop;if(/color/.test(prop)&&token&&(match=re_hex.exec(token))){this.colors.setHex(match[1]);hsl=this.colors.getHSL();rgb=this.colors.getRGB();return[match[0],('hsl('+hsl[0]+','+parseInt(hsl[1])+'%,'+parseInt(hsl[2])+'%)'),('rgb('+rgb[0]+','+rgb[1]+','+rgb[2]+')')].concat(suggest_values['color']);}
if(suggest_values[prop]&&suggest_values[prop].length){return this.getMatchesFromList(suggest_values[prop],set);}
return null;}
this['suggest-value'].replace_type=VALUE;this['suggest-value'].cursor=0;this['suggest-value'].matches=null;this['suggest-value'].last_set='';this['suggest-value'].last_prop='';this.submit=function(){var
props=this.getProperties(),i=0,inner='';if(props[i+1]){this.textarea_container.parentElement.innerHTML="<key>"+props[i]+"</key>: "+"<value>"+props[i+1]+(props[i+2]?" !important":"")+"</value>;";}
else
{this.textarea_container.parentElement.parentElement.
removeChild(this.textarea_container.parentElement);this.textarea_container.parentElement.innerHTML="";}}
this.commit=function(){var props=self.getProperties(),i=0,script="",prop=null,reset=false;while(props.length>3){reset=true;prop=this.textarea_container.parentElement.parentElement.
insertBefore(document.createElement('property'),this.textarea_container.parentElement);prop.innerHTML="<key>"+props[0]+"</key>: "+"<value>"+props[1]+(props[2]?" !important":"")+"</value>;";props.splice(0,3);}
if(reset){this.textarea.value=props[0]+(props[1]?': '+props[1]+(props[2]?' !important':'')+';':'');this.context_cur_text_content=this.context_cur_prop=this.context_cur_value='';this.context_cur_priority=0;}
if(props[i+1]){script="rule.style.setProperty(\""+props[i]+"\", \""+props[i+1].replace(/"/g,"'")+"\", "+(props[i+2]?"\"important\"":null)+")";services['ecmascript-debugger'].eval(0,this.context_rt_id,'','',script,["rule",this.context_rule_id]);}
else if(!props[i]){script="rule.style.removeProperty(\""+this.context_cur_prop+"\")";services['ecmascript-debugger'].eval(0,this.context_rt_id,'','',script,["rule",this.context_rule_id]);}
if(this.context_stylesheet_index>-1){stylesheets.invalidateSheet(this.context_rt_id,this.context_stylesheet_index);this.context_stylesheet_index=-1;}}
this.enter=function(){var
props=self.getProperties(),keep_edit=false,prop=null;this.last_suggets_type='';if(props&&props.length==3){if(this.textarea.selectionEnd==this.textarea.value.length
||this.textarea.selectionEnd>=this.textarea.value.indexOf(';')){prop=this.textarea_container.parentElement.parentElement.
insertBefore(document.createElement('property'),this.textarea_container.parentElement);prop.innerHTML="<key>"+props[0]+"</key>: "+"<value>"+props[1]+(props[2]?" !important":"")+"</value>;";this.textarea.value=this.context_cur_text_content=this.context_cur_prop=this.context_cur_value='';this.context_cur_priority=0;keep_edit=true;}
else
{this.textarea_container.parentElement.innerHTML="<key>"+props[0]+"</key>: "+"<value>"+props[1]+(props[2]?" !important":"")+"</value>;";}}
else
{this.textarea_container.parentElement.innerHTML="";}
return keep_edit;}
this.escape=function(){this.last_suggets_type='';if(this.context_cur_prop){this.textarea.value=this.context_cur_text_content;this.textarea_container.parentElement.innerHTML="<key>"+this.context_cur_prop+"</key>: "+"<value>"+this.context_cur_value+(this.context_cur_priority?" !important":"")+"</value>;";return true;}
else
{this.textarea.value='';this.textarea_container.parentElement.innerHTML='';return false;}}
var input_handler=function(event){this.style.height=this.scrollHeight+'px';self.commit();}}
var key_ids={TAB:'0009',SHIFT_TAB:'1009',ENTER:'00013',SHIFT_ENTER:'10013',CTRL_ENTER:'01013',ESC:'00027',SPACE:'00032',ARROW_LEFT:'00037',ARROW_UP:'00038',ARROW_RIGHT:'00039',ARROW_DOWN:'00040',SHIFT_ARROW_LEFT:'10037',SHIFT_ARROW_UP:'10038',SHIFT_ARROW_RIGHT:'10039',SHIFT_ARROW_DOWN:'10040',BACKSPACE:'0008',CTRL_BACKSPACE:'0108',DELETE:'00046',F8:'000119',F9:'000120',F10:'000121',F11:'000122',SHIFT_F11:'100122',CTRL_A:'01065'}
var action_ids={NAV_NEXT:'action-nav-next',NAV_PREVIOUS:'action-nav-previous',ENTER:'action-enter',SHIFT_ENTER:'action-shift-enter',CTRL_ENTER:'action-ctrl-enter',ESCAPE:'action-escape',NAV_LEFT:'action-nav-left',NAV_UP:'action-nav-up',NAV_RIGHT:'action-nav-right',NAV_DOWN:'action-nav-down',ENABLE_DISABLE:'action-enable-disable',CONTINUE:'action-continue',STEP_OVER:'action-step-over',STEP_INTO:'action-step-into',STEP_OUT:'action-step-out',BACKSPACE:'action-back-space',CTRL_BACKSPACE:'action-ctrl-back-space',CTRL_A:'action-select-all'}
var action_map_win={};action_map_win[key_ids.TAB]=action_ids.NAV_NEXT;action_map_win[key_ids.SHIFT_TAB]=action_ids.NAV_PREVIOUS;action_map_win[key_ids.ENTER]=action_ids.ENTER;action_map_win[key_ids.SHIFT_ENTER]=action_ids.SHIFT_ENTER;action_map_win[key_ids.CTRL_ENTER]=action_ids.CTRL_ENTER;action_map_win[key_ids.ESC]=action_ids.ESCAPE;action_map_win[key_ids.ARROW_LEFT]=action_ids.NAV_LEFT;action_map_win[key_ids.ARROW_UP]=action_ids.NAV_UP;action_map_win[key_ids.ARROW_RIGHT]=action_ids.NAV_RIGHT;action_map_win[key_ids.ARROW_DOWN]=action_ids.NAV_DOWN;action_map_win[key_ids.BACKSPACE]=action_ids.ENABLE_DISABLE;action_map_win[key_ids.DELETE]=action_ids.ENABLE_DISABLE;action_map_win[key_ids.F8]=action_ids.CONTINUE;action_map_win[key_ids.F10]=action_ids.STEP_OVER;action_map_win[key_ids.F11]=action_ids.STEP_INTO;action_map_win[key_ids.SHIFT_F11]=action_ids.STEP_OUT;action_map_win[key_ids.BACKSPACE]=action_ids.BACKSPACE;action_map_win[key_ids.CTRL_BACKSPACE]=action_ids.CTRL_BACKSPACE;action_map_win[key_ids.CTRL_A]=action_ids.CTRL_A;var action_map=action_map_win;var BaseActions=new function(){this.init=function(id){if(!window.actions){window.actions={};}
window.actions[this.id=id]=this;}}
var BaseKeyhandler=new function(){var
key='',default_handler=function(event,id){var _id='';for(_id in action_ids){if(action_ids[_id]==id){return/input|textarea/i.test(event.target.nodeName);}}};for(key in action_map){this[action_map[key]]=default_handler;}
for(key in action_ids){this[key]=action_ids[key];}
this.focus=function(container){}
this.blur=function(){}
this.onclick=function(event){return true;};this[this.CTRL_A]=function(event,action_id){return key_identifier.ctrl_a(event,action_id)}
this.init=function(id){if(!window.keyhandlers){window.keyhandlers={};}
window.keyhandlers[this.id=id]=this;}}
var BaseEditKeyhandler=new function(){var
key='',default_handler=function(event,id){var _id='';for(_id in action_ids){if(action_ids[_id]==id){return true;}}};for(key in action_map){this[action_map[key]]=default_handler;}
for(key in action_ids){this[key]=action_ids[key];}
this.focus=function(container){}
this.blur=function(){}
this.onclick=function(event){return true;};this.init=function(id){if(!window.edit_keyhandlers){window.edit_keyhandlers={};}
window.edit_keyhandlers[this.id=id]=this;}}
var DefaultKeyhandler=function(id){this.init(id);};DefaultKeyhandler.prototype=BaseKeyhandler;new DefaultKeyhandler('default_keyhandler');var key_identifier=new function(){var self=this;var __container=null;const
TAB=9,ENTER=13,ESC=27,SPACE=32,ARROW_LEFT=37,ARROW_UP=38,ARROW_RIGHT=39,ARROW_DOWN=40,BACKSPACE=8,DELETE=46,F8=119,F9=120,F10=121,F11=122,A=65;var key_handler_ids={},id='';var __key_handler=null;var __current_view_id=null;this.ctrl_a=function(event,action_id){var selection=getSelection();var range=document.createRange();selection.collapse(__container,0);range.selectNodeContents(__container);selection.addRange(range);return false;}
var empty_keyhandler=new function(){var
key='',empty_handler=function(event,id){return/input|textarea/i.test(event.target.nodeName);};for(key in action_map){this[action_map[key]]=empty_handler;}
this[action_map[key_ids.CTRL_A]]=function(event,action_id){return self.ctrl_a(event,action_id);}
this.focus=function(container){};this.blur=function(){};this.setTarget=function(){};this.onclick=function(event){return true;};}
for(id in key_ids){key_handler_ids[key_ids[id]]=true;}
__key_handler=empty_keyhandler;this.setKeyHandler=function(key_handler){__key_handler=key_handler;}
this.setModeEdit=function(actions){if(__key_handler.id==actions.id&&window.edit_keyhandlers&&edit_keyhandlers[actions.id]){__key_handler=edit_keyhandlers[actions.id];__container.addClass('edit-mode');messages.post('action-mode-changed',{mode:'edit',id:actions.id});}}
this.setModeDefault=function(actions){if(__key_handler.id==actions.id){__key_handler=keyhandlers[actions.id];__container.removeClass('edit-mode');messages.post('action-mode-changed',{mode:'default',id:actions.id});}}
this.handle=function(event){var
keyCode=event.keyCode,key_id='',action_id=0;switch(keyCode){case ARROW_LEFT:case ARROW_UP:case ARROW_RIGHT:case ARROW_DOWN:case F8:case F9:case F10:case F11:{if(event.which!=0){break;}}
case TAB:case ENTER:case ESC:case SPACE:case BACKSPACE:case DELETE:case A:{key_id=(event.shiftKey?'1':'0')+(event.ctrlKey?'1':'0')+(event.altKey?'1':'0')+keyCode.toString();if(key_id in action_map
&&!__key_handler[action_id=action_map[key_id]](event,action_id)){event.preventDefault();event.stopPropagation();}
break;}}}
var clear_current_handler=function(){if(__key_handler){__key_handler.blur();}
if(__container&&__container.hasClass('edit-mode')){__container.removeClass('edit-mode');}
__current_view_id='';__container=null;__key_handler=empty_keyhandler;}
this.setView=function(event){if(!(__key_handler&&__key_handler.onclick(event)===false)){var container=event.target;while(container&&!/^(?:top-)?(?:container|toolbar|tabs)$/.test(container.nodeName)
&&(container=container.parentElement));if(container){switch(container.nodeName){case 'container':{var ui_obj=UIBase.getUIById(container.getAttribute('ui-id'));if(ui_obj&&ui_obj.view_id!=__current_view_id){clear_current_handler();__key_handler=keyhandlers[__current_view_id=ui_obj.view_id]||empty_keyhandler;__key_handler.focus(event,container);__container=container;}
break;}
default:{clear_current_handler();}}}
else
{clear_current_handler();}}}
document.addEventListener('keypress',this.handle,true);document.addEventListener('click',this.setView,true);};var cls=window.cls||(window.cls={});cls.CSSInspectorActions=function(id){var self=this;this.__active_container=null;this.__target=null;this.editor=new Editor();this.getFirstTarget=function(){return self.__active_container&&self.__active_container.getElementsByTagName('styles')[1].getElementsByTagName('property')[0];}
this.clearSelected=function(){if(self.__target){self.__target.removeClass('selected');}}
this.setSelected=function(new_target){if(new_target){if(self.__target){self.__target.removeClass('selected');}(self.__target=new_target).addClass('selected');self.__target.scrollSoftIntoView();}}
this.resetTarget=function(new_container){if(self.__active_container&&self.__target&&!self.__active_container.parentNode){var
targets=self.__active_container.getElementsByTagName(self.__target.nodeName),target=null,i=0;for(;(target=targets[i])&&target!=self.__target;i++);if(target&&(target=new_container.getElementsByTagName(self.__target.nodeName)[i])){self.__active_container=new_container;self.setSelected(target);}}}
this.moveFocusUp=function(event,target){if(self.__target){self.setSelected(self.__target.getPreviousWithFilter(self.__active_container,self.__target.nodeName=='header'&&self.__target.parentElement.getAttribute('handler')
?nav_filter.header
:nav_filter._default));}
else
{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'keyboard_handler: no target to move');}}
var nav_filter={_default:function(ele){return((ele.nodeName=='property'&&ele.parentElement.hasAttribute('rule-id'))
||ele.nodeName=='header'
||ele.getAttribute('handler')=='display-rule-in-stylesheet');},header:function(ele){return ele.nodeName=='header';},property_editable:function(ele){return ele.nodeName=='property'&&ele.parentElement.hasAttribute('rule-id');}}
this.moveFocusDown=function(event,target){if(self.__target){self.setSelected(self.__target.getNextWithFilter(self.__active_container,self.__target.nodeName=='header'&&!self.__target.parentElement.getAttribute('handler')
?nav_filter.header
:nav_filter._default));}
else
{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'keyboard_handler: no target to move');}}
this.setActiveContainer=function(event,container){self.resetTarget(container);self.__active_container=container;if(!self.__target||!self.__target.parentElement){self.__target=self.getFirstTarget()}
if(self.__target&&!self.__target.hasClass('selected')){self.setSelected(self.__target);}}
this.clearActiveContainer=function(){self.clearSelected();}
this.editCSS=function(event,target){var cat=event.target;switch(event.target.nodeName){case 'key':case 'value':{if(event.target.parentElement.parentElement.hasAttribute('rule-id')){key_identifier.setModeEdit(self);self.setSelected(event.target.parentNode);self.editor.edit(event,event.target.parentNode);}
break;}
case 'property':{if(event.target.parentElement.hasAttribute('rule-id')){key_identifier.setModeEdit(self);self.setSelected(event.target);self.editor.edit(event);}
break;}}}
this['css-toggle-category']=function(event,target){if(/header/.test(target.nodeName)){target=target.firstChild;}
var cat=target.getAttribute('cat-id'),value=target.hasClass('unfolded');var cat_container=target.parentNode.parentNode;if(value){target.removeClass('unfolded');cat_container.removeClass('unfolded');var styles=cat_container.getElementsByTagName('styles')[0];if(styles){styles.innerHTML="";}}
else
{target.addClass('unfolded');cat_container.addClass('unfolded');}
self.setSelected(target.parentNode);elementStyle.setUnfoldedCat(cat,!value);settings['css-inspector'].set(cat,!value);}
this['display-rule-in-stylesheet']=function(event,target){var index=parseInt(target.getAttribute('index'));var rt_id=target.getAttribute('rt-id');var rule_id=target.parentNode.getAttribute('rule-id');var rules=stylesheets.getRulesWithSheetIndex(rt_id,index,arguments);if(rules){self.setSelected(target);stylesheets.setSelectedSheet(rt_id,index,rules,rule_id);topCell.showView(views.stylesheets.id);}}
this.target_enter=function(event,action_id){if(this.__target){this.__target.releaseEvent('click');}}
this.nav_previous_edit_mode=function(event,action_id){if(!this.editor.nav_previous(event,action_id)){var new_target=this.__target.getPreviousWithFilter(this.__active_container,nav_filter.property_editable);if(new_target){this.setSelected(new_target);this.editor.edit(null,this.__target);this.editor.focusLastToken();}}
return false;}
this.nav_next_edit_mode=function(event,action_id){if(!this.editor.nav_next(event,action_id)){var new_target=this.__target.getNextWithFilter(this.__active_container,nav_filter.property_editable);if(new_target){this.setSelected(new_target);this.editor.edit(null,this.__target);this.editor.focusFirstToken();}}
return false;}
this.autocomplete=function(event,action_id){this.editor.autocomplete(event,action_id);return false;}
this.escape_edit_mode=function(event,action_id){if(!this.editor.escape()){var cur_target=this.__target;this.moveFocusUp();cur_target.parentElement.removeChild(cur_target);}
key_identifier.setModeDefault(self);return false;}
this.blur_edit_mode=function(){this.escape_edit_mode();this.clearActiveContainer();}
this.enter_edit_mode=function(event,action_id){if(!this.editor.enter(event,action_id)){key_identifier.setModeDefault(self);if(!this.__target.textContent){var cur_target=this.__target;this.moveFocusUp();cur_target.parentElement.removeChild(cur_target);}}
return false;}
this.edit_onclick=function(event){if(this.editor){if(this.editor.onclick(event)){}
else
{key_identifier.setModeDefault(self);}}}
this.init(id);var onViewCreated=function(msg){}
messages.addListener('view-created',onViewCreated)};cls.CSSInspectorActions.prototype=BaseActions;new cls.CSSInspectorActions('css-inspector');cls.CSSInspectorKeyhandler=function(id){var __actions=actions[id]
this[this.NAV_LEFT]=this[this.NAV_UP]=__actions.moveFocusUp;this[this.NAV_RIGHT]=this[this.NAV_DOWN]=__actions.moveFocusDown;this[this.ENTER]=function(event,action_id){__actions.target_enter(event,action_id);}
this.focus=__actions.setActiveContainer;this.blur=__actions.clearActiveContainer;this.init(id);};cls.CSSInspectorKeyhandler.prototype=BaseKeyhandler;new cls.CSSInspectorKeyhandler('css-inspector');cls.CSSInspectorEditKeyhandler=function(id){var __actions=actions[id]
this[this.NAV_UP]=this[this.NAV_DOWN]=function(event,action_id){__actions.autocomplete(event,action_id);}
this[this.NAV_NEXT]=function(event,action_id){__actions.nav_next_edit_mode(event,action_id);}
this[this.NAV_PREVIOUS]=function(event,action_id){__actions.nav_previous_edit_mode(event,action_id);}
this[this.ESCAPE]=function(event,action_id){__actions.escape_edit_mode(event,action_id);}
this[this.ENTER]=function(event,action_id){__actions.enter_edit_mode(event,action_id);}
this.focus=__actions.test;this.blur=function(){__actions.blur_edit_mode();}
this.onclick=function(event){__actions.edit_onclick(event)};this.init(id);};cls.CSSInspectorEditKeyhandler.prototype=BaseEditKeyhandler;new cls.CSSInspectorEditKeyhandler('css-inspector');eventHandlers.click['edit-css']=actions['css-inspector'].editCSS;eventHandlers.click['css-toggle-category']=actions['css-inspector']['css-toggle-category'];eventHandlers.click['display-rule-in-stylesheet']=actions['css-inspector']['display-rule-in-stylesheet'];var CstSelectBase=new function(){this.getSelectedOptionText=function(){};this.getSelectedOptionValue=function(){};this.templateOptionList=function(select_obj){};this.checkChange=function(target_ele){};var modal_box=null;var select_obj=null;var modal_click_handler=function(event){var
ele=event.target,target=event.target,index=0,handler='';event.stopPropagation();event.preventDefault();while(ele!=modal_box&&(ele=ele.parentElement));if(ele){if(target.nodeName!='cst-option'){return;}
if(handler=target.getAttribute('handler')){if(eventHandlers.click[handler]){eventHandlers.click[handler](event,target);}}
else if(select_obj.checkChange(target)){var select=select_obj.updateElement();if(select){select.releaseEvent('change');}}}
document.removeEventListener('click',modal_click_handler,true);modal_box.parentElement.removeChild(modal_box);modal_box=null;select_obj=null;EventHandler.__modal_mode=false;}
var click_handler=function(event){var ele=event.target;if(/^cst-/.test(ele.nodeName)){var select=/^cst-select/.test(ele.nodeName)&&ele||ele.parentElement;document.addEventListener('click',modal_click_handler,true);select_obj=window['cst-selects'][select.getAttribute("cst-id")];modal_box=document.documentElement.render(templates['cst-select-option-list'](select_obj,select));var box=select.getBoundingClientRect(),left=box.left,bottom=box.bottom,right=box.right,top=box.top,_innerWidth=innerWidth,_innerHeight=innerHeight,max_width=_innerWidth-left-30,max_height=_innerHeight-bottom-30,modal_box_width=modal_box.offsetWidth,modal_box_height=modal_box.offsetHeight,max_width_2=right-30,max_height_2=top-30,style='';if(modal_box_height>max_height&&modal_box_height<max_height_2){style+="top: "+(top-modal_box_height)+"px;";}
else
{style+="top: "+bottom+"px;";modal_box.firstElementChild.style.cssText="max-height: "+max_height+"px;"};if(modal_box_width>max_width&&modal_box_width<max_width_2){style+="left: "+(right-modal_box_width)+"px;";}
else
{style+="left: "+left+"px; max-width: "+max_width+"px;";};style+="min-width:"+(select.offsetWidth<max_width?select.offsetWidth:(max_width>0?max_width:0))+"px;";modal_box.style.cssText=style;EventHandler.__modal_mode=true;}}
this.getTemplate=function(){var select=this;return function(){return window.templates['cst-select'](select);}}
this.getId=function(){return this._id;}
this.setNewValues=function(select_ele){select_ele.value=this.getSelectedOptionValue();var firstElementChild=select_ele.firstElementChild;if(firstElementChild&&firstElementChild.nodeName=="cst-value"){firstElementChild.textContent=this.getSelectedOptionText();}}
this.updateElement=function(){var
selects=document.getElementsByTagName('cst-select'),select=null,id=this.getId(),i=0,ret=null;for(;select=selects[i];i++){if(select.getAttribute('cst-id')==id){this.setNewValues(select);ret=select;}}
return ret;}
this.init=function(id,class_name,type){(window['cst-selects']||(window['cst-selects']={}))[id]=this;this._selected_option_index=0;this._option_list=this._option_list||[];this._id=id;this.class_name=class_name||'';this.type=type||'';}
this.getSelectedOptionText=function(){var selected_option=this._option_list[this._selected_option_index];return selected_option&&selected_option.text||"";}
this.getSelectedOptionValue=function(){var selected_option=this._option_list[this._selected_option_index];return selected_option&&selected_option.value||selected_option.text||'';}
this.templateOptionList=function(select_obj){var
ret=[],opt_list=select_obj._option_list,opt=null,i=0;for(;opt=opt_list[i];i++){ret[i]=["cst-option",opt.text,"opt-index",i,"title",opt.title,"unselectable","on"]}
return ret;}
this.checkChange=function(target_ele){var index=target_ele['opt-index'];if(this._selected_option_index!=index){this._selected_option_index=index;return true;}
return false;}
document.addEventListener('click',click_handler,false);}
var CstSelect=function(id,class_name,type){this.init(id,class_name,type);}
var CstSelectColorBase=function(id,index){this.setNewValues=function(select_ele){select_ele.value=select_ele.style.backgroundColor=this.getSelectedOptionValue();}
this.getSelectedOptionValue=function(){var selected_option=this._option_list[this._selected_option_index];return selected_option&&selected_option['color-value']||'none';}
this.getSelectedOptionAlpha=function(){var selected_option=this._option_list[this._selected_option_index];return selected_option&&selected_option['alpha-value']||1;}
this.checkChange=function(target_ele){var
index=target_ele['opt-index'],selected_option=this._option_list[index],alpha=target_ele.parentNode.parentNode.getElementsByTagName('input')[0];alpha=parseFloat(alpha.value)||1;if(this._selected_option_index!=index||selected_option['alpha-value']!=alpha){this._selected_option_index=index;selected_option['alpha-value']=alpha;delete selected_option['rgba'];return true;}
return false;}
this.setAlpha=function(value){var
cursor=this._option_list[this._selected_option_index],modal_box=document.getElementsByTagName('cst-select-option-list')[0];if(cursor){cursor['alpha-value']=value/100;delete cursor['rgba'];}
if(modal_box){modal_box.getElementsByTagName('input')[0].value=value/100;cursor=modal_box.getElementsByTagName('cst-option')[this._selected_option_index];if(cursor){cursor.style.opacity=value/100;}}}
this.templateOptionList=function(select_obj){var
ret=['div'],opt_list=select_obj._option_list,selected_index=select_obj._selected_option_index,opt=null,i=0;for(;opt=opt_list[i];i++){ret[ret.length]=["cst-option","opt-index",i,"unselectable","on","style","background-color:"+opt["color-value"]+";"+"opacity: "+opt["alpha-value"]+";",];if(i==selected_index){ret[ret.length]=["cst-selected-border"];}}
ret=[ret];ret[ret.length]=["label","alpha: ",["input","type","text","value",select_obj.getSelectedOptionAlpha()]];ret[ret.length]=["input","type","range","value",select_obj.getSelectedOptionAlpha()*100,"onchange",function(){select_obj.setAlpha(this.value);}];return['cst-option-list-background',ret];}
this._option_list=[{"color-value":"#00ff00","alpha-value":.7,"ref-id":"color-1",},{"color-value":"#4dff00","alpha-value":.7,"ref-id":"color-1",},{"color-value":"#99ff00","alpha-value":.7,"ref-id":"color-1",},{"color-value":"#e6ff00","alpha-value":.7,"ref-id":"color-1",},{"color-value":"#ffcc00","alpha-value":.7,"ref-id":"color-1",},{"color-value":"#ff7f00","alpha-value":.7,"ref-id":"color-1",},{"color-value":"#ff3300","alpha-value":.7,"ref-id":"color-1",},{"color-value":"#ff001a","alpha-value":.7,"ref-id":"color-1",},{"color-value":"#ff0066","alpha-value":.7,"ref-id":"color-1",},{"color-value":"#ff00b3","alpha-value":.7,"ref-id":"color-1",},{"color-value":"#ff00ff","alpha-value":.7,"ref-id":"color-1",},{"color-value":"#b200ff","alpha-value":.7,"ref-id":"color-1",},{"color-value":"#6600ff","alpha-value":.7,"ref-id":"color-1",},{"color-value":"#1900ff","alpha-value":.7,"ref-id":"color-1",},{"color-value":"#0033ff","alpha-value":.7,"ref-id":"color-1",},{"color-value":"#0080ff","alpha-value":.7,"ref-id":"color-1",},{"color-value":"#00ccff","alpha-value":.7,"ref-id":"color-1",},{"color-value":"#00ffe5","alpha-value":.7,"ref-id":"color-1",},{"color-value":"#00ff99","alpha-value":.7,"ref-id":"color-1",},{"color-value":"#00ff4c","alpha-value":.7,"ref-id":"color-1",},];this.getSelectedRGBA=function(){var
selected_option=this._option_list[this._selected_option_index],hexs=null;if(selected_option){if(!selected_option['rgba']){hexs=selected_option['color-value'].split(/([0-9-a-fA-F]{2})/);selected_option['rgba']="rgba("+parseInt(hexs[1],16)+", "+parseInt(hexs[3],16)+", "+parseInt(hexs[5],16)+", "+selected_option['alpha-value']+")";}
return selected_option['rgba'];}
return "rgba(0, 0, 0, 0.5)";}
this.__init_base=this.init;this.init=function(id,index){this.__init_base(id,'color','color');this._selected_option_index=index||0;(window.colors||(window.colors={})).__defineGetter__
(id,(function(obj){return function(){return obj.getSelectedRGBA()};})(this));}}
var CstSelectWithActionBase=function(id,class_name,type){this._action_entries=[];this._action_entry=function(action){return["cst-option",action.text,"handler",action.handler,"title",action.title,"unselectable","on"]}
this.templateOptionList=function(select_obj){var
ret=select_obj._action_entries.map(this._action_entry),opt_list=select_obj._option_list,opt=null,i=0;if(ret.length){ret[ret.length]=["hr"];}
for(;opt=opt_list[i];i++){ret[ret.length]=["cst-option",opt.text,"opt-index",i,"title",opt.title,"unselectable","on"]}
return ret;}}
CstSelectWithActionBase.prototype=CstSelectColorBase.prototype=CstSelect.prototype=CstSelectBase;CstSelectColor=function(id,index){this.init(id,index);};CstSelectColor.prototype=new CstSelectColorBase();CstSelectWithAction=function(id,class_name,type){this.init(id,class_name,type);};CstSelectWithAction.prototype=new CstSelectWithActionBase();(window.templates||(window.templates={}))['cst-select']=function(select){return \
["cst-select",["cst-value",select.getSelectedOptionText(),"unselectable","on"],["cst-drop-down"],"cst-id",select.getId(),"handler",select.getId(),"unselectable","on"].concat(select.type?['class',select.type,'style','background-color:'+select.getSelectedOptionValue()]:[]);}
templates['cst-select-option-list']=function(select_obj,select_ele){return \
['cst-select-option-list-container',['cst-select-option-list',select_obj.templateOptionList(select_obj)],'style','top: -1000px; left: -1000px;'].concat(select_obj.class_name?['class',select_obj.class_name]:[]);}
var ui_framework=new function(){this.beforeSetup=function(){};this.afterSetup=function(){};this.layouts={};this.setupTopCell=function(){};var self=this;var resolve_map_properties=[{s_name:'border-top-width'},{s_name:'border-right-width'},{s_name:'border-bottom-width'},{s_name:'border-left-width'},{s_name:'padding-top'},{s_name:'padding-right'},{s_name:'padding-bottom'},{s_name:'padding-left'},{s_name:'width'},{s_name:'height'}]
var resolve_map=[{source:'toolbar',target:Toolbar.prototype,properties:resolve_map_properties},{source:'tabs',target:Tabs.prototype,properties:resolve_map_properties},{source:'container',target:Container.prototype,properties:resolve_map_properties},{source:'top-tabs',target:TopTabs.prototype,properties:resolve_map_properties},{source:'top-container',target:TopContainer.prototype,properties:resolve_map_properties},{source:'top-statusbar',target:TopStatusbar.prototype,properties:resolve_map_properties},{source:'top-toolbar',target:TopToolbar.prototype,properties:resolve_map_properties},{source:'window-toolbar',target:WindowToolbar.prototype,properties:resolve_map_properties},{source:'window-header',target:defaults,properties:[{t_name:'window_header_offsetHeight',setProp:function(source,decalaration){return source.offsetHeight;}}]},{source:'window-container',target:WindowContainer.prototype,properties:resolve_map_properties},{source:'window-satusbar',target:WindowStatusbar.prototype,properties:resolve_map_properties},{source:'window-statusbar',target:defaults,properties:[{t_name:'window_statusbar_offsetHeight',setProp:function(source,decalaration){return source.offsetHeight;}}]},];var resolve_map_2=[{id:'test-line-height',property:'lineHeight',target:'js-source-line-height',getValue:function(){return parseInt(document.getElementById(this.id).currentStyle[this.property])}},{id:'test-scrollbar-width',target:'scrollbar-width',getValue:function(){return(100-document.getElementById(this.id).offsetWidth)}},{id:'test-cst-select-width',target:'cst-select-margin-border-padding',getValue:function(){var
props=['margin-left','border-left-width','padding-left','margin-right','border-right-width','padding-right'],prop='',i=0,val=0,style=getComputedStyle(document.getElementById(this.id),null);for(;prop=props[i];i++){val+=parseInt(style.getPropertyValue(prop));}
val+=5;return val;}}];resolve_map_2.markup="\
  <div> \
    <div class='js-source'> \
      <div id='js-source-scroll-content'> \
        <div id='js-source-content'> \
          <div id='test-line-height'>test</div> \
          <div style='position:absolute;width:100px;height:100px;overflow:auto'> \
            <div id='test-scrollbar-width' style='height:300px'></div> \
          </div> \
        </div> \
      </div> \
    </div> \
    <toolbar style='top:50px;left:50px;height:26px;width:678px;display:block'> \
      <cst-select id='test-cst-select-width' cst-id='js-script-select' unselectable='on' style='width: 302px' > \
        <cst-value unselectable='on' /> \
        <cst-drop-down/> \
      </cst-select> \
    </toolbar> \
  </div>\
  ";var setup=function(){document.removeEventListener('load',arguments.callee,false);self.beforeSetup();window[defaults.viewport]=document.getElementsByTagName(defaults.viewport_main_container)[0];if(viewport){UIBase.copyCSS(resolve_map);var container=viewport.appendChild(document.createElement('div'));container.style.cssText='position:absolute;top:0;left:-1000px;';container.innerHTML=resolve_map_2.markup;for(var set=null,i=0;set=resolve_map_2[i];i++){defaults[set.target]=set.getValue();}
viewport.removeChild(container);new SlideViews(document);setTimeout(function(){self.afterSetup();messages.post('application-setup');},0);}
else
{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'missing viewport');}}
window.toolbars||(window.toolbars={});window.switches||(window.switches={});window.cls||(window.cls={});document.addEventListener('load',setup,false);}
var ListTextSearch=function(){const
SEARCH_DELAY=50;var
self=this,search_term='',search_results=[],cursor=-1,container=null,input=null,timeouts=new Timeouts(),cache={},current_id='',current_context=null,go_back={},highlightColor='';this.search=function(new_search_term){var cur=null,cur_2=null,depth=0,display='';if(new_search_term!=search_term){if(go_back[current_id]){delete go_back[current_id];}
search_results=[];cache[current_id]=search_term=new_search_term;cur=container.getElementsByTagName('start-search-scope')[0];while(cur&&(cur=cur.nextSibling)&&cur.nodeName!="end-search-scope"){display=cur.getElementsByTagName('key')[0].textContent.indexOf(search_term)==-1
&&'none'
||'';cur.style.display=display;if(!display){search_results[search_results.length]=cur;}
depth=parseInt(cur.getAttribute('depth'));cur_2=cur;while((cur_2=cur_2.nextSibling)
&&cur_2.nodeName!="end-search-scope"
&&(parseInt(cur.getAttribute('depth'))<depth)){cur=cur_2;cur.style.display=display;}}}}
this.searchDelayed=function(new_search_term){timeouts.set(this.search,SEARCH_DELAY,new_search_term);}
var __selected_element=null;var selectNextInput=function(start,next,direction){var
cur=__selected_element&&__selected_element.parentNode
||container.getElementsByTagName(start)[0],scrollTop=0,scrollBottom=0,targetTop=0,targetBottom=0;while((cur=cur[next])
&&!(cur.nodeName=='item'
&&cur.style.display!='none'
&&(cur.firstChild&&/input/i.test(cur.firstChild.nodeName))));if(cur&&cur.nodeName=='item'){if(__selected_element){__selected_element.parentNode.style.removeProperty('background-color');}
__selected_element=cur.firstChild;cur.style.backgroundColor=highlightColor;scrollTop=container.scrollTop;scrollBottom=scrollTop+container.offsetHeight;targetTop=cur.offsetTop;targetBottom=targetTop+cur.offsetHeight;if(targetBottom>scrollBottom){container.scrollTop+=50+targetBottom-scrollBottom;}
else if(targetTop<scrollTop){container.scrollTop+=targetTop-scrollTop-50;}}
else
{container.scrollTop+=direction*50;}}
this.handleKey=function(event,target){event.stopPropagation();event.preventDefault();switch(event.keyCode){case 40:{selectNextInput('start-search-scope','nextSibling',1);break;}
case 38:{selectNextInput('end-search-scope','previousSibling',-1);break;}
case 13:{if(__selected_element){__selected_element.click();}
break;}
default:{if(__selected_element){__selected_element.parentNode.removeClass('selected');__selected_element=null;}}}}
this.handleEnterKey=function(){switch(event.keyCode){case 13:{if(search_results.length==1){var _input=search_results[0].getElementsByTagName('input')[0];if(_input){_input.click();}}
break;}
case 8:{if(input&&!input.value){var target=getTarget();if(target&&(target=target.getElementsByTagName('input')[0])){if(go_back[current_id]){target.click();}
else
{go_back[current_id]=1;}}}
break;}}}
var getTarget=function(str_id){var items=null,item=null,i=0;if(container&&current_context){items=container.getElementsByTagName('item');for(;item=items[i];i++){if(item.getAttribute('obj-id')==current_context.obj_id
&&item.getAttribute('depth')==current_context.depth
&&item.getElementsByTagName('key')[0].textContent==current_context.key){break;}}}
return item;}
this.onNewContext=function(msg){current_context=msg;current_id=msg.rt_id+"."+msg.obj_id+"."+msg.depth;if(input){if(cache[current_id]){input.value=cache[current_id];}
else
{input.value='';}}}
this.setInput=function(target){input=target;}
this.setContainer=function(_container){if(container!=_container){container=_container;if(!highlightColor){highlightColor=document.styleSheets.getPropertyValue('item.selected','background-color');}}}
this.cleanup=function(){current_id='';current_context=null;search_results=[];input=null;container=null;}};var ini={protocol_version:'4',max_frames:100,debug:false,dragonfly_version:'0.7 alpha-4',revision_number:'1119:af96654aa12a, protocol-4',mercurial_revision:""}
var Debug=function(id,name,container_class){var self=this;var indent='  ';var reCommand=/<([^>]*)>/;event_filter=null;command_filter=null;var getIndent=function(n){var ret='';if(n<1){return ret;}
while(n--)ret+=indent;return ret;}
var out=[];this.createView=function(d_c){var first_child=d_c.firstChild||d_c.render(['div','class','padding']);first_child.textContent=out.join('\n');}
this.scrollToBottom=function(container){container.scrollTop=container.scrollHeight;}
this.output=function(string){if(string)out.push(string);this.update();this.applyToContainers(this.scrollToBottom);}
this.export=function(string){export_data.data=out.join('\n').replace(/</g,'&lt;');if(!topCell.tab.hasTab('export_new')){topCell.tab.addTab(new Tab('export_new',views['export_new'].name,true))}
topCell.showView('export_data');}
this.clear=function(){out=[];this.update();}
this.checkProfiling=function(){if(window.__profiling__){window.__times__[5]=new Date().getTime();var stamps=['request','response','parsing','sorting','markup','rendering']
var stamp='',i=0,out='';for(;stamp=stamps[i];i++){out+=stamp+': '+window.__times__[i]+(i>0?' delta: '+(window.__times__[i]-window.__times__[i-1]):'')+'\n';}
out+='total delta: '+(window.__times__[5]-window.__times__[0])+'\n';debug.output(out);}
if(window.__times_dom&&window.__times_dom.length==5){var stamps=['click event','return object id','return object','parse xml','render view']
var stamp='',i=0,out='';for(;stamp=stamps[i];i++){out+=stamp+': '+window.__times_dom[i]+(i>0?' delta: '+(window.__times_dom[i]-window.__times_dom[i-1]):'')+'\n';}
out+='total delta: '+(window.__times_dom[4]-window.__times_dom[0])+'\n';debug.output(out);}}
this.profileSpotlight=function(){window.__times_spotlight__[1]=new Date().getTime();var stamps=['event handle-event','command spotlight']
var stamp='',i=0,out='';for(;stamp=stamps[i];i++){out+=stamp+': '+window.__times_spotlight__[i]+(i>0?' delta: '+(window.__times_spotlight__[i]-window.__times_spotlight__[i-1]):'')+'\n';}
debug.output(out);}
this.setEventFilter=function(events){events=events.split(',');event_filter={};var e='',i=0;for(;e=events[i];i++){event_filter[e.replace(/^ +/,'').replace(/ +$/,'')]=true;}}
this.setCommandFilter=function(events){events=events.split(',');command_filter={};var e='',i=0;for(;e=events[i];i++){command_filter[e.replace(/^ +/,'').replace(/ +$/,'')]=true;}}
this.logEvents=function(xml){var event=xml.documentElement.nodeName;if(!event_filter||(event_filter&&event in event_filter)){self.formatXML(new XMLSerializer().serializeToString(xml));}}
this.logCommand=function(msg){var command=reCommand.exec(msg)[1];if(!command_filter||(command_filter&&command in command_filter)){self.formatXML('POST:\n'+msg);}}
this.formatXML=function(string){string=string.replace(/<\?[^>]*>/,'');var re=/([^<]*)(<(\/)?[^>/]*(\/)?>)/g,match=null,indentCount=0;var ret='';while(match=re.exec(string)){if(match[3]){indentCount--;if(match[1]){ret+=match[1]+match[2];}
else
{ret+='\n'+getIndent(indentCount)+match[0];}}
else if(match[4]){ret+='\n'+getIndent(indentCount)+match[0];}
else
{ret+='\n'+getIndent(indentCount)+match[0];indentCount++;}}
self.output(ret);}
this.init(id,name,container_class);}
Debug.init=function(){window.debug=new Debug('debug','Debug','scroll debug-container');new ToolbarConfig
('debug',[{handler:'clear-debug-view',title:'clear debug log'},{handler:'export-debug-log',title:'export debug log'}])
eventHandlers.click['clear-debug-view']=function(event,target){debug.clear();}
eventHandlers.click['export-debug-log']=function(event,target){debug.export();}
var View=function(id,name,container_class){this.createView=function(container){container.render
(['div',['div',['input','type','button','value','eval','onclick',"this.parentNode.parentNode.getElementsByTagName('textarea')[0].value='<eval>\\n  <tag>1</tag>\\n  <runtime-id></runtime-id>\\n  <thread-id></thread-id>\\n  <frame-id></frame-id>\\n  <script-data></script-data>\\n</eval>';"],['input','type','button','value','set breakpoint','onclick',"this.parentNode.parentNode.getElementsByTagName('textarea')[0].value='<add-breakpoint>\\n  <breakpoint-id> x </breakpoint-id>\\n  <source-position>\\n    <script-id> x </script-id>\\n    <line-number> x </line-number>\\n  </source-position>\\n</add-breakpoint>';"],['input','type','button','value','examine obj','onclick',"this.parentNode.parentNode.getElementsByTagName('textarea')[0].value='<examine-objects>\\n  <tag>1</tag>\\n  <runtime-id>x</runtime-id>\\n  <object-id>x</object-id>\\n</examine-objects>';"],['input','type','button','value','post','style','margin-left:10px','onclick','services[\'ecmascript-debugger\'].postCommandline()'],'style','text-align: right'],['div',['textarea'],'id','command-line-debug-container'],'class','window-container','id','command-line-debug'])}
this.init(id,name,container_class);}
View.prototype=ViewBase;new View('commandline_debug','Commandline Debug','scroll');}
Debug.prototype=ViewBase;storage=new function(){var setCookie=function(name,value,time){document.cookie=name+"="+encodeURIComponent(value)+"; expires="+(new Date(new Date().getTime()+(time||360*24*60*60*1000))).toGMTString()+"; path=/";}
var getCookie=function(name){var match=null;if(match=new RegExp(name+'\=([^;]*);','').exec(document.cookie+';')){return decodeURIComponent(match[1]);}
return null;}
this.set=function(key,value){setCookie(key,JSON.stringify(value))}
this.get=function(key,default_value){var val=getCookie(key);if(val){return JSON.parse(val);}
return default_value;}
var storage={};this.config_stop_at={map:{sc:'script',ex:'exception',er:'error',ab:'abort'},defaults:{sc:'0',ex:'0',er:'0',ab:'0'},name:'stop_at',get:function(){var stop_at=getCookie(this.name);var ret={},prop='';if(stop_at){while(stop_at){ret[this.map[stop_at.slice(0,2)]]=stop_at.slice(2,3)=='1'?'yes':'no';stop_at=stop_at.slice(3);}}
else
{for(prop in this.defaults){ret[this.map[prop]]=this.defaults[prop]=='1'?'yes':'no';}}
return ret;},set:function(){var stop_at=getCookie(this.name);var cur={},new_val='';if(stop_at){while(stop_at){cur[stop_at.slice(0,2)]=stop_at.slice(2,3);stop_at=stop_at.slice(3);}}
else
{for(prop in this.defaults){cur[prop]=this.defaults[prop];}}
var key=value='',i=0,prop='';for(;(key=arguments[i++])&&(value=arguments[i]);i++){for(prop in cur){if(this.map[prop]==key){cur[prop]=value=='yes'?'1':'0';}}}
for(prop in cur){new_val+=prop+cur[prop];}
setCookie(this.name,new_val)}}}
helpers=new function(){var self=this;var handleKeypress=function(event,id){event.preventDefault();event.stopPropagation();var button=document.getElementById(id);if(button&&!button.disabled){button.click();}}
var keypressListener=function(event){if(event.which==0){switch(event.keyCode){case 119:{event.preventDefault();handleKeypress(event,'continue-run');break;}
case 121:{event.preventDefault();handleKeypress(event,'continue-step-next-line');break;}
case 122:{event.preventDefault();if(event.shiftKey){handleKeypress(event,'continue-step-out-of-call');}
else
{handleKeypress(event,'continue-step-into-call');}
break;}}}}
this.setSelected=function(event){var ele=event.target;var parent=ele.parentNode;var siblings=parent.getElementsByTagName(ele.nodeName),sibling=null,i=0;for(;sibling=siblings[i];i++){if(sibling.parentElement==parent){if(sibling==ele){sibling.addClass('selected');}
else
{sibling.removeClass('selected');}}}}
this.shortenURI=function(uri){var ret_uri=uri;var title='';var max_length=40;if(ret_uri&&ret_uri.length>max_length){title=uri;ret_uri=uri.split('?')[0];if(ret_uri.length>max_length){var temp=/\/([^/]+)$/.exec(ret_uri);if(temp){ret_uri=temp[1];}}}
return{uri:ret_uri,title:title};}
this.resolveURLS=function(top_url,url){return(/^.{4,5}:\/\//.test(url)&&url
||/^\//.test(url)&&/^.{4,5}:\/\/[^/]*/.exec(top_url)[0]+url
||top_url.replace(/\?.*$/,'').replace(/#.*$/,'').replace(/\/[^/]*$/,"/")+url);}
this.escapeTextHtml=function(str){return str.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/&(?!.{2,4};)/g,"&amp;");}
this.setCookie=function(key,value,time){document.cookie=\
key+"="+encodeURIComponent(value)+"; expires="+(new Date(new Date().getTime()+(time||360*24*60*60*1000))).toGMTString()+"; path=/";}
this.getCookie=function(key){var value=new RegExp(key+"=([^;]*)").exec(document.cookie);return value&&decodeURIComponent(value[1]);}
document.addEventListener('keypress',keypressListener,true);}
var host_tabs=new function(){var self=this;var __window_id='';var __activeTab=[];var document_map={};var type_map={};var callback_map={};var node_map={};var runtime_id_map={};var id_map={};var handler_id=1;var activeEvents=[];var getNewHandlerId=function(){var id=handler_id.toString();handler_id++;id_map[id]=1;return id;}
var checkTriple=function(node_id,event_type,callback){var id_p='';for(id_p in id_map){if(node_map[id_p]==node_id&&type_map[id_p]==event_type&&callback_map[id_p]==callback){return true;}}
return false;}
var getHandlerId=function(event_type,callback){var id_ps=[],id_p='';for(id_p in id_map){if(type_map[id_p]==event_type&&callback_map[id_p]==callback){id_ps[id_ps.length]=id_p;}}
return id_ps;}
var activeTabOnChange=function(){var rt_id='',i=0,h_id='';for(;rt_id=__activeTab[i];i++){for(h_id in runtime_id_map){if(runtime_id_map[h_id]==rt_id){clearEventListener(h_id);}}}}
this.setActiveTab=function(window_id){activeTabOnChange();__window_id=window_id;runtimes.setActiveWindowId(window_id);__activeTab=runtimes.getRuntimeIdsFromWindow(window_id);messages.post('active-tab',{activeTab:__activeTab});}
this.updateActiveTab=function(){__activeTab=runtimes.getRuntimeIdsFromWindow(__window_id);var ev=null,i=0;for(;ev=activeEvents[i];i++){__addEvenetListener(ev.type,ev.cb);}
cleanUpEventListener();messages.post('active-tab',{activeTab:__activeTab});}
this.getActiveTab=function(top_frame_runtime_id){return __activeTab;}
this.isMultiRuntime=function(){return __activeTab.length>1;}
this.handleEventHandler=function(xml){if(window.__times_spotlight__){window.__times_spotlight__[0]=new Date().getTime();}
var event={};var children=xml.documentElement.childNodes,child=null,i=0;for(;child=children[i];i++){event[child.nodeName]=child.firstChild.nodeValue;}
event['runtime-id']=runtime_id_map[event['handler-id']];if(event['handler-id']in callback_map){callback_map[event['handler-id']](event);}}
var handleAddEventWithDocument=function(xml,runtime_id,event_type,callback){if(xml.getNodeData('status')=='completed'){var node_id=xml.getNodeData('object-id');if(!checkTriple(node_id,event_type,callback)){document_map[runtime_id]=node_id;var id=getNewHandlerId();node_map[id]=node_id;type_map[id]=event_type;callback_map[id]=callback;runtime_id_map[id]=runtime_id;services['ecmascript-debugger'].addEventHandler(id,node_id,event_type);}}
else
{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'Error in host_tabs handleAddEventWithDocument');}}
var __addEvenetListener=function(event_type,callback){var rt_p='',i=0,id='';for(;rt_p=__activeTab[i];i++){if(document_map[rt_p]&&!checkTriple(document_map[rt_p],event_type,callback)){id=getNewHandlerId();node_map[id]=document_map[rt_p];type_map[id]=event_type;callback_map[id]=callback;runtime_id_map[id]=rt_p;services['ecmascript-debugger'].addEventHandler(id,document_map[rt_p],event_type);}
else
{var tag=tagManager.setCB(null,handleAddEventWithDocument,[rt_p,event_type,callback]);services['ecmascript-debugger'].getDocumentFromRuntime(tag,rt_p);}}}
var cleanUpEventListener=function(){var ev=null,i=0,j=0,k=0,ids=null,id='',cur='',rt_id='';for(;ev=activeEvents[i];i++){ids=getHandlerId(ev.type,ev.cb);for(j=0;id=ids[j];j++){rt_id=runtime_id_map[id];for(k=0;(cur=__activeTab[k])&&rt_id!=cur;k++);if(!cur){clearEventListener(id);}}}}
var clearEventListener=function(id){services['ecmascript-debugger'].removeEventHandler(id);delete node_map[id];delete type_map[id];delete callback_map[id];delete runtime_id_map[id];delete id_map[id];}
this.activeTab=new function(){var self=this;this.addEventListener=function(event_type,callback){activeEvents[activeEvents.length]={type:event_type,cb:callback};__addEvenetListener(event_type,callback);}
this.removeEventListener=function(event_type,callback){var ids=getHandlerId(event_type,callback),id='',i=0,ev=null;for(;id=ids[i];i++){clearEventListener(id);}
for(i=0;i<activeEvents.length;i++){ev=activeEvents[i];if(ev&&ev.type==event_type&&ev.cb==callback){activeEvents.splice(i,1);i--;}}}}}
var js_keywords={'abstract':1,'boolean':1,'break':1,'byte':1,'case':1,'catch':1,'char':1,'class':1,'const':1,'continue':1,'default':1,'delete':1,'do':1,'double':1,'else':1,'extends':1,'false':1,'final':1,'finally':1,'float':1,'for':1,'function':1,'goto':1,'if':1,'implements':1,'import':1,'in':1,'instanceof':1,'int':1,'interface':1,'long':1,'native':1,'new':1,'null':1,'package':1,'private':1,'protected':1,'public':1,'return':1,'short':1,'static':1,'super':1,'switch':1,'synchronized':1,'this':1,'throw':1,'throws':1,'transient':1,'true':1,'try':1,'typeof':1,'var':1,'void':1,'while':1,'with':1}
var js_builtins={'Anchor':1,'anchors':1,'Applet':1,'applets':1,'Area':1,'Array':1,'Button':1,'Checkbox':1,'Date':1,'document':1,'FileUpload':1,'Form':1,'forms':1,'Frame':1,'frames':1,'Hidden':1,'history':1,'Image':1,'images':1,'Link':1,'links':1,'Area':1,'location':1,'Math':1,'MimeType':1,'mimeTypes':1,'navigator':1,'options':1,'Password':1,'Plugin':1,'plugins':1,'Radio':1,'Reset':1,'Select':1,'String':1,'Submit':1,'Text':1,'Textarea':1,'window':1}
var pre_lexer=function(script){var input=script.source_data,line_arr=script.line_arr,state_arr=script.state_arr;var cur_cur=-1;var line_cur=0;var line_cur_prev=-1;var s_quote_cur=-2;var d_quote_cur=-2;var slash_cur=-2;var min_cur=0;var s_quote_val='\'';var d_quote_val='"';var slash_val='/';var line_count=0;var temp_count=0;var temp_char='';var temp_type='';var string=new String(input);var DEFAULT=0,SINGLE_QUOTE=1,DOUBLE_QUOTE=2,REG_EXP=3,COMMENT=4;var lex_state='DEFAULT';var LEX_S_QUOTE=1;var state='';var get_min=Math.min;var get_max=Math.max;while(min_cur!=-1){state='';if((s_quote_cur!=-1)&&(s_quote_cur<=cur_cur)){s_quote_cur=string.indexOf(s_quote_val,cur_cur+1);}
if((d_quote_cur!=-1)&&(d_quote_cur<=cur_cur)){d_quote_cur=string.indexOf(d_quote_val,cur_cur+1);}
if((slash_cur!=-1)&&(slash_cur<=cur_cur)){slash_cur=string.indexOf(slash_val,cur_cur+1);}
min_cur=get_max(s_quote_cur,d_quote_cur,slash_cur);if(s_quote_cur!=-1&&s_quote_cur<=min_cur){min_cur=s_quote_cur;state='SINGLE_QUOTE';}
if(d_quote_cur!=-1&&d_quote_cur<=min_cur){min_cur=d_quote_cur;state='DOUBLE_QUOTE';}
if(slash_cur!=-1&&slash_cur<=min_cur){min_cur=slash_cur;state='SLASH';}
if(state){while(line_cur<=min_cur){line_arr[line_count++]=line_cur;if((line_cur=string.indexOf('\n',line_cur)+1)==0){if(line_arr[line_arr.length-1]<string.length){line_arr[line_count]=string.length;}
return;}}
switch(state){case 'SINGLE_QUOTE':{do
{s_quote_cur=string.indexOf(s_quote_val,s_quote_cur+1);temp_count=0;while(string.charAt(s_quote_cur-temp_count-1)=='\\'){temp_count++;}}
while((temp_count&1)&&s_quote_cur!=-1);if(s_quote_cur!=-1){cur_cur=s_quote_cur;while(line_cur<cur_cur){line_arr[line_count]=line_cur;state_arr[line_count++]=SINGLE_QUOTE;if((line_cur=string.indexOf('\n',line_cur)+1)==0){if(line_arr[line_arr.length-1]<string.length){line_arr[line_count]=string.length;}
return;}}}
continue;}
case 'DOUBLE_QUOTE':{do
{d_quote_cur=string.indexOf(d_quote_val,d_quote_cur+1);temp_count=0;while(string.charAt(d_quote_cur-temp_count-1)=='\\'){temp_count++;}}
while((temp_count&1)&&d_quote_cur!=-1);if(d_quote_cur!=-1){cur_cur=d_quote_cur;while(line_cur<cur_cur){line_arr[line_count]=line_cur;state_arr[line_count++]=DOUBLE_QUOTE;if((line_cur=string.indexOf('\n',line_cur)+1)==0){if(line_arr[line_arr.length-1]<string.length){line_arr[line_count]=string.length;}
return;}}}
continue;}
case 'SLASH':{switch(string.charAt(slash_cur+1)){case '/':{cur_cur=string.indexOf('\n',slash_cur+2);while(line_cur<cur_cur){line_arr[line_count++]=line_cur;if((line_cur=string.indexOf('\n',line_cur)+1)==0){if(line_arr[line_arr.length-1]<string.length){line_arr[line_count]=string.length;}
return;}}
continue;}
case '*':{do
{slash_cur=string.indexOf('*',slash_cur+1);temp_char=string.charAt(slash_cur+1);}
while(slash_cur!=-1&&temp_char&&temp_char!='/');if(slash_cur!=-1){cur_cur=slash_cur+1;while(line_cur<cur_cur){line_arr[line_count]=line_cur;state_arr[line_count++]=COMMENT;if((line_cur=string.indexOf('\n',line_cur)+1)==0){if(line_arr[line_arr.length-1]<string.length){line_arr[line_count]=string.length;}
return;}}}
continue;}
default:{temp_count=1;do
{temp_char=string.charAt(slash_cur-temp_count);temp_count++;}
while(temp_char==' '&&(slash_cur-temp_count>0));switch(temp_char){case '=':case '(':case '[':case ':':case ',':case '!':{temp_type='REG_EXP';break;}
case '&':case '|':{if(string.charAt(slash_cur-temp_count)==temp_char){temp_type='REG_EXP';break;}}
default:{temp_type='';}}
if(temp_type=='REG_EXP'){do
{slash_cur=string.indexOf(slash_val,slash_cur+1);temp_count=0;while(string.charAt(slash_cur-temp_count-1)=='\\'){temp_count++;}}
while((temp_count&1)&&slash_cur!=-1);if(slash_cur!=-1){cur_cur=slash_cur;while(line_cur<cur_cur){line_arr[line_count]=line_cur;state_arr[line_count++]=REG_EXP;if((line_cur=string.indexOf('\n',line_cur)+1)==0){if(line_arr[line_arr.length-1]<string.length){line_arr[line_count]=string.length;}
return;}}}
continue;}
else
{cur_cur=slash_cur;continue;}}}}}}
else
{if(!line_cur&&!line_arr.length){line_cur=string.indexOf('\n',line_cur)+1;if(line_cur||string.length){line_arr[line_count++]=0;}}
while(line_cur){line_arr[line_count++]=line_cur;line_cur=string.indexOf('\n',line_cur)+1;}
if(line_arr[line_arr.length-1]<string.length){line_arr[line_count]=string.length;}
return;}}}
var simple_js_parser=new function(){const DEFAULT=0,SINGLE_QUOTE=1,DOUBLE_QUOTE=2,REG_EXP=3,COMMENT=4;var parser=null;var __source=null;var __buffer='';var __pointer=0;var __char=String.fromCharCode
var __type='';var __previous_type='';var __previous_value='';var __string_delimiter=0;var __ret='<ol>';var __line='';var __line_number=1;var __max_line_number=0;var WHITESPACE={'\u0009':1,'\u000B':1,'\u000C':1,'\u0020':1,'\u00A0':1}
var LINETERMINATOR={'\u000A':1,'\u000D':1,'\u000D\u000A':1,'\u2028':1,'\u2029':1}
var NUMBER={'0':1,'1':1,'2':1,'3':1,'4':1,'5':1,'6':1,'7':1,'8':1,'9':1}
var PUNCTUATOR={'{':'{','}':'}','(':'(',')':')','[':'[',']':']',';':';',',':',','<':'&lt;','>':'>','=':'=','!':'!','+':'+','-':'-','*':'*','%':'%','&':'&','|':'|','^':'^','~':'~','?':'?',':':':','.':'.'}
var PUNCTUATOR_2={'=':'=','+':'+','-':'-','<':'&lt;','>':'>','&':'&','|':'|'}
var STRING_DELIMITER={'"':1,'\'':1}
var HEX_NUMBER={'0':1,'1':1,'2':1,'3':1,'4':1,'5':1,'6':1,'7':1,'8':1,'9':1,'a':1,'b':1,'c':1,'d':1,'e':1,'f':1,'A':1,'B':1,'C':1,'D':1,'E':1,'F':1}
var REG_EXP_FLAG={'g':1,'i':1,'m':1}
var PUNCTUATOR_DIV_PREDECESSOR={')':1,']':1}
var ESCAPE={'<':'&lt;','&':'&amp;'}
var default_parser=function(c){var CRLF='';__previous_value='';while(c){if(c in WHITESPACE){read_buffer();__type='WHITESPACE';do
{__buffer+=c;c=__source.charAt(++__pointer);}
while(c in WHITESPACE);read_buffer();__type='IDENTIFIER';}
if(c in LINETERMINATOR){read_buffer();CRLF=c;CRLF+=c=__source.charAt(++__pointer);if(CRLF in LINETERMINATOR){c=__source.charAt(++__pointer);}
if(__online&&__online()){return __ret;}
continue;}
if(c in NUMBER){read_buffer();__buffer+=c;__type='NUMBER';c=__source.charAt(++__pointer);if(c=='x'||c=='X'){__buffer+=c;c=number_hex_parser(__source.charAt(++__pointer));}
else
{c=number_dec_parser(c);}
continue;}
if(c in STRING_DELIMITER){read_buffer();__string_delimiter=c;__buffer+=c;__type='STRING';if(string_parser(__source.charAt(++__pointer))){return __ret;}
c=__source.charAt(++__pointer);continue;}
if(c=='.'){read_buffer();__buffer+=c;c=__source.charAt(++__pointer);if(c in NUMBER){__type='NUMBER';c=number_dec_parser(c);continue;}
else
{__type='PUNCTUATOR';read_buffer();__type='IDENTIFIER';continue;}}
if(c in PUNCTUATOR){read_buffer();__type='PUNCTUATOR';do
{__buffer+=PUNCTUATOR[c];c=__source.charAt(++__pointer);}
while(c in PUNCTUATOR_2);__previous_value=__buffer;read_buffer();__previous_type=__type;__type='IDENTIFIER';continue;}
if(c=='/'){read_buffer();__buffer+=c;c=__source.charAt(++__pointer);if(c=='*'){__buffer+=c;__type='COMMENT';if(multiline_comment_parser(__source.charAt(++__pointer))){return __ret;}
c=__source.charAt(++__pointer)
continue;}
if(c=='/'){__buffer+=c;__type='COMMENT';if(singleline_comment_parser(__source.charAt(++__pointer))){return __ret;}
c=__source.charAt(__pointer);continue;}
if(__previous_type=='IDENTIFIER'||__previous_type=='NUMBER'||
(__previous_type=='PUNCTUATOR'&&__previous_value in PUNCTUATOR_DIV_PREDECESSOR)){__type='DIV_PUNCTUIATOR';if(c=='='){__buffer+=c;read_buffer();c=__source.charAt(++__pointer);}
else
{read_buffer();}
__type='IDENTIFIER';continue;}
__type='REG_EXP';c=reg_exp_parser(c);continue;}
__buffer+=c in ESCAPE?ESCAPE[c]:c;c=__source.charAt(++__pointer);}
read_buffer();}
var number_hex_parser=function(c){while(c in HEX_NUMBER){__buffer+=c;c=__source.charAt(++__pointer);}
read_buffer();__previous_type=__type;__type='IDENTIFIER';return c;}
var number_dec_parser=function(c){while(c in NUMBER||c=='.'){__buffer+=c;c=__source.charAt(++__pointer);}
if(c=='e'||c=='E'){__buffer+=c;c=__source.charAt(++__pointer);if(c=='+'||c=='-'){__buffer+=c;c=__source.charAt(++__pointer);}
while(c in NUMBER){__buffer+=c;c=__source.charAt(++__pointer);}}
read_buffer();__previous_type='NUMBER';__type='IDENTIFIER';return c;}
var string_parser=function(c){var CRLF='';while(c){if(c=='\\'){__buffer+=c;c=__source.charAt(++__pointer);if(c in LINETERMINATOR){read_buffer();CRLF=c;CRLF+=c=__source.charAt(++__pointer);if(CRLF in LINETERMINATOR){c=__source.charAt(++__pointer);}
if(__online&&__online()){return __ret;}
continue;}
else
{__buffer+=c in ESCAPE?ESCAPE[c]:c;c=__source.charAt(++__pointer);continue;}}
if(c==__string_delimiter){__buffer+=c;read_buffer();__previous_type='STRING';__type='IDENTIFIER';break;}
__buffer+=c in ESCAPE?ESCAPE[c]:c;c=__source.charAt(++__pointer);}}
var multiline_comment_parser=function(c){var CRLF='';while(c){if(c in LINETERMINATOR){read_buffer();CRLF=c;CRLF+=c=__source.charAt(++__pointer);if(CRLF in LINETERMINATOR){c=__source.charAt(++__pointer);}
if(__online&&__online()){return __ret;}
continue;}
if(c=='*'){__buffer+=c;c=__source.charAt(++__pointer);if(c=='/'){__buffer+=c;read_buffer();__previous_type='COMMENT';__type='IDENTIFIER';break;}
continue;}
__buffer+=c in ESCAPE?ESCAPE[c]:c;c=__source.charAt(++__pointer);}}
var singleline_comment_parser=function(c){var CRLF='';while(c){if(c in LINETERMINATOR){read_buffer();__previous_type='COMMENT';__type='IDENTIFIER';CRLF=c;CRLF+=c=__source.charAt(++__pointer);if(CRLF in LINETERMINATOR){__pointer++;}
if(__online&&__online()){return __ret;}
break;}
__buffer+=c in ESCAPE?ESCAPE[c]:c;c=__source.charAt(++__pointer);}}
var reg_exp_parser=function(c){var is_in_brackets=false;while(c){if(c=='['){is_in_brackets=true;}
if(is_in_brackets&&c==']'){is_in_brackets=false;}
if(c=='\\'){__buffer+=c;c=__source.charAt(++__pointer);__buffer+=c in ESCAPE?ESCAPE[c]:c;c=__source.charAt(++__pointer);continue;}
if(!is_in_brackets&&c=='/'){__buffer+=c;c=__source.charAt(++__pointer);while(c in REG_EXP_FLAG){__buffer+=c;c=__source.charAt(++__pointer);}
read_buffer();__previous_type='REG_EXP';__type='IDENTIFIER';return c;}
__buffer+=c in ESCAPE?ESCAPE[c]:c;c=__source.charAt(++__pointer);}}
var read_buffer=function(){if(__buffer){switch(__type){case 'STRING':{__line+="<span class='string'>"+__buffer+"</span>";break;}
case 'IDENTIFIER':{if(__buffer in js_keywords){__line+="<span class='js_keywords'>"+__buffer+"</span>";}
else if(__buffer in js_builtins){__line+="<span class='js_builtins'>"+__buffer+"</span>";}
else
{__line+=__buffer;}
break;}
case 'NUMBER':{__line+="<span class='number'>"+__buffer+"</span>";break;}
case 'COMMENT':{__line+="<span class='comment'>"+__buffer+"</span>";break;}
case 'REG_EXP':{__line+="<span class='reg_exp'>"+__buffer+"</span>";break;}
default:{__line+=__buffer;}}
if(__type=='IDENTIFIER'){__previous_type=__type;}}
__buffer='';}
var __online=function(c){if(!__line){__line+='\u00A0';}
__ret[__ret.length]="<div>"+__line+"</div>";__line='';return(++__line_number)>__max_line_number;}
var __onfinish=function(){__online();return __ret;}
var __reset=function(line,max_line){__ret=[];__line='';__line_number=line;__max_line_number=line+max_line;}
var states=[];states[COMMENT]=function(){__type='COMMENT';if(multiline_comment_parser(__source.charAt(__pointer))){return __ret;}
__pointer++;};states[SINGLE_QUOTE]=function(){opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'state parsing not implemented in formatter.js for SINGLE_QUOTE');};states[SINGLE_QUOTE]=function(){__string_delimiter="'";__type='STRING';if(string_parser(__source.charAt(__pointer))){return __ret;}
__pointer++;};states[DOUBLE_QUOTE]=function(){__string_delimiter='"';__type='STRING';if(string_parser(__source.charAt(__pointer))){return __ret;}
__pointer++;};states[REG_EXP]=function(){opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'state parsing not implemented in formatter.js for REG_EXP');};this.parse=function(script,line,max_line,state){__reset(line,max_line);parser=default_parser;__previous_type='';__type='IDENTIFIER';__source=script.source;var length=__source.length;__pointer=script.line_arr[line];if(script.state_arr[line]){if(states[script.state_arr[line]]()){return __ret;}}
if(parser(__source.charAt(__pointer))){return __ret;}
if(__onfinish){return __onfinish();}}}
window.templates=window.templates||{};(function(){var self=this;this.hello=function(enviroment){var ret=['ul'];var prop='';var prop_dict={"protocol-version":ui_strings.S_TEXT_ENVIRONMENT_PROTOCOL_VERSION,"operating-system":ui_strings.S_TEXT_ENVIRONMENT_OPERATING_SYSTEM,"platform":ui_strings.S_TEXT_ENVIRONMENT_PLATFORM,"user-agent":ui_strings.S_TEXT_ENVIRONMENT_USER_AGENT}
for(prop in enviroment){ret[ret.length]=['li',prop_dict[prop]+': '+enviroment[prop]];}
if(ini.revision_number.indexOf("$")!=-1&&ini.mercurial_revision){ini.revision_number=ini.mercurial_revision;}
ret[ret.length]=['li',ui_strings.S_TEXT_ENVIRONMENT_DRAGONFLY_VERSION+': '+ini.dragonfly_version];ret[ret.length]=['li',ui_strings.S_TEXT_ENVIRONMENT_REVISION_NUMBER+': '+ini.revision_number];return['div',ret,'class','padding'];}
this.runtimes=function(runtimes,type,arg_list){var ret=[],rt=null,i=0;for(;rt=runtimes[i];i++){ret[ret.length]=self['runtime-'+type](rt,arg_list);}
return ret;}
this['runtime-runtime']=function(runtime,arg_list){var display_uri=helpers.shortenURI(runtime['uri']);return \
['cst-option',runtime['title']||display_uri.uri,'rt-id',runtime['runtime-id']].concat(display_uri.title?['title',display_uri.title]:[])
;}
this['runtime-script']=function(runtime,arg_list){var
display_uri=helpers.shortenURI(runtime['uri']),is_reloaded_window=runtimes.isReloadedWindow(runtime['window-id']),ret=\
[['h2',runtime['title']||display_uri.uri].
concat(runtime.selected?['class','selected-runtime']:[]).
concat(display_uri.title?['title',display_uri.title]:[])],scripts=runtimes.getScripts(runtime['runtime-id']),script=null,i=0,stopped_script_id=arg_list[0],selected_script_id=arg_list[1];if(scripts.length){for(;script=scripts[i];i++){ret[ret.length]=templates.scriptOption(script,selected_script_id,stopped_script_id);}}
return ret;}
this.scriptOption=function(script,selected_script_id,stopped_script_id){var
display_uri=helpers.shortenURI(script['uri']),type_dict={"inline":ui_strings.S_TEXT_ECMA_SCRIPT_TYPE_INLINE,"linked":ui_strings.S_TEXT_ECMA_SCRIPT_TYPE_LINKED,"unknown":ui_strings.S_TEXT_ECMA_SCRIPT_TYPE_UNKNOWN},script_type=script['script-type'],ret=\
['cst-option',(type_dict[script_type]||script_type)+' - '+(display_uri.uri
?display_uri.uri
:ui_strings.S_TEXT_ECMA_SCRIPT_SCRIPT_ID+': '+script['script-id']),'script-id',script['script-id']],class_name=script['script-id']==selected_script_id&&'selected'||'';if(stopped_script_id==script['script-id']){class_name+=(class_name&&' '||'')+'stopped';}
if(display_uri.title){ret.splice(ret.length,0,'title',display_uri.title);}
if(class_name){ret.splice(ret.length,0,'class',class_name);}
return ret;}
this['runtime-css']=function(runtime,org_args){const
OBJECT_ID=0,HREF=2,TITLE=7;var
display_uri=helpers.shortenURI(runtime['uri']),ret=[['h2',runtime['title']||display_uri.uri].
concat(display_uri.title?['title',display_uri.title]:[])],sheets=stylesheets.getStylesheets(runtime['runtime-id']),sheet=null,i=0,container=[],rt_id=runtime['runtime-id'],title='';if(sheets){for(;sheet=sheets[i];i++){title=sheet[HREF]?sheet[HREF]:'inline stylesheet '+(i+1);container[container.length]=['cst-option',title,'runtime-id',rt_id,'index',''+i];}}
ret=ret.concat([container])
return ret;}
this['runtime-dom']=function(runtime){var display_uri=runtime['title']||helpers.shortenURI(runtime['uri']).uri;return(['cst-option',runtime['title']||runtime['uri'],'runtime-id',runtime['runtime-id']].concat(dom_data.getDataRuntimeId()==runtime['runtime-id']?['class','selected-runtime']:[]).
concat(display_uri!=runtime['uri']?['title',runtime['uri']]:[]))}
this.checkbox=function(settingName,settingValue){return['li',['label',['input','type','checkbox','value',settingName,'checked',settingValue?true:false,'handler','set-stop-at'],settingName]]}
this.frame=function(frame,is_top){return['li',ui_strings.S_TEXT_CALL_STACK_FRAME_LINE.
replace("%(FUNCTION_NAME)s",(frame.fn_name||ui_strings.ANONYMOUS_FUNCTION_NAME)).
replace("%(LINE_NUMBER)s",(frame.line||'-')).
replace("%(SCRIPT_ID)s",(frame.script_id||'-')),'handler','show-frame','ref-id',frame.id,].concat(is_top?['class','selected']:[]);}
this.configStopAt=function(config){var ret=['ul'];var arr=["script","exception","error","abort"],n='',i=0;for(;n=arr[i];i++){ret[ret.length]=this.checkbox(n,config[n]);}
return['div'].concat([ret]);}
this.continues=function(){var ret=[];ret[ret.length]=self.continueWithMode('run ( F5 )','run');ret[ret.length]=self.continueWithMode('step into call ( F11 )','step-into-call');ret[ret.length]=self.continueWithMode('step next line ( F10 )','step-next-line');ret[ret.length]=self.continueWithMode('step out of call ( Shift F11 )','step-out-of-call');return ret;}
this.continueWithMode=function(name,mode){return['input','type','button','value','','title',name,'mode',mode,'id','continue-'+mode,'handler','continue','disabled',true]}
this.examineObject=function(data){var prop=null,i=0,ret=['ul'];for(i=0;prop=data[i];i++){switch(prop.type){case 'object':{ret[ret.length]=self.key_value_folder(prop.key,i);break;}
case 'undefined':case 'null':{ret[ret.length]=self.key_value(prop.key,prop.value,prop.type,i);break;}
default:{ret[ret.length]=ret[ret.length]=self.key_value(prop.key,prop.value,prop.type,i);break;}}}
if(window.__profiling__){window.__times__[4]=new Date().getTime();}
return ret;}
this.key_value=function(key,value,value_class,ref_index){return['li',['span',key,'class','key'],['span',value].concat(value_class?['class',value_class]:[]),'ref_index',ref_index];}
this.key_value_folder=function(key,ref_index){return['li',['input','type','button','handler','examine-object','class','folder-key'],['span',key,'class','key'],['span','object','class','object'],'ref_index',ref_index];}
this.breakpoint=function(line_nr,top){return['li','class','breakpoint','line_nr',line_nr,'style','top:'+top+'px']}
this.toolbars=function(){return['div',['h1','Opera developer tools'],['div','id','continues'],['div',['input','type','button','value','create runtimes','handler','create-all-runtimes'],'id','main-button-toolbar'],['ul',['li','Runtimes','handler','drop-down','ref','runtimes'],['li','Configuration','handler','drop-down','ref','configuration'],['li','Console','handler','drop-down','ref','console'],['li','Enviroment','handler','drop-down','ref','environment'],['li','DOM Inspector','handler','drop-down','ref','dom-inspector'],(ini.debug||window.__profiling__||window.__times_spotlight__||window.__times_dom?
['li','Debug','handler','drop-down','ref','debug']:[]),(ini.debug||window.__profiling__?['li','Command Line','handler','drop-down','ref','command-line']:[]),(ini.debug||window.__testing__?['li','Testing','handler','drop-down','ref','testing']:[]),'class','dropdowns'],'id','ecma-debugger-toolbar']}
this.runtimes_dropdown=function(ele){return['div',['ul','id','runtimes'],'class','window-container'];}
this.domInspector=function(){return['div',['div',['form',['label',['input','type','radio','id','radio-markup-view','checked','checked'],' markup view '],['label',['input','type','radio','id','radio-dom-view'],' dom view '],['label',['input','type','checkbox','id','checkbox-show-attributes','checked','checked'],' show attributes '],['label',['input','type','checkbox','id','checkbox-force-lower-case','checked','checked'],' lower case node names '],['label',['input','type','checkbox','id','checkbox-show-comments'],' show comments '],['label',['input','type','checkbox','id','checkbox-show-white-space-nodes'],' show white space nodes '],['label',['input','type','checkbox','id','checkbox-highlight-on-hover'],' highlight on hover '],['label',['input','type','checkbox','id','checkbox-find-element-with-click','checked','checked'],' find element with click '],],'class','toolbar'],['div',['div','id','dom-view'],'class','content'],['div','<status>','id','status-bar-dom-view','class','status-bar'],'class','window-container','id','dom-view-container']}
this.cssInspector=function(categories){var ret=[],cat=null,i=0;for(;cat=categories[i];i++){ret[ret.length]=this.cssInspectorCategory(cat);}
return ret;}
this.cssInspectorCategory=function(cat){var ret=['category',['header',['input','type','button','handler','css-toggle-category','cat-id',cat.id].concat(cat.unfolded?['class','unfolded']:[]),cat.name,'handler','css-toggle-category'],['styles']];if(cat.unfolded){ret.splice(ret.length,0,'class','unfolded');}
if(cat.handler){ret.splice(ret.length,0,'handler',cat.handler);}
return ret;}
this['js-script-select']=function(ui_obj){return self['cst-select'](ui_obj.script_select);}
this.breadcrumb=function(css_path){var
ret=["breadcrumb"],i=0;if(css_path){for(;i<css_path.length;i++){ret[ret.length]=["span",css_path[i].name,'obj-id',css_path[i].id.toString(),'handler','breadcrumb-link','class',css_path[i].is_parent_offset?'parent-offset':'',];ret[ret.length]=css_path[i].combinator;}}
return ret;}
this.uiLangOptions=function(lang_dict){var dict=[{browserLanguge:"be",key:"be",name:"български език"},{browserLanguge:"cs",key:"cs",name:"Česky"},{browserLanguge:"da",key:"da",name:"Dansk"},{browserLanguge:"de",key:"de",name:"Deutsch"},{browserLanguge:"el",key:"el",name:"Ελληνικά"},{browserLanguge:"en",key:"en",name:"English"},{browserLanguge:"es-ES",key:"es-ES",name:"Español (España)"},{browserLanguge:"es-LA",key:"es-LA",name:"Español (Latinoamérica)"},{browserLanguge:"et",key:"et",name:"Eesti keel"},{browserLanguge:"fi",key:"fi",name:"Suomen kieli"},{browserLanguge:"fr",key:"fr",name:"Français"},{browserLanguge:"fr-CA",key:"fr-CA",name:"Français Canadien"},{browserLanguge:"fy",key:"fy",name:"Frysk"},{browserLanguge:"hi",key:"hi",name:"हिन्दी"},{browserLanguge:"hr",key:"hr",name:"Hrvatski"},{browserLanguge:"hu",key:"hu",name:"Magyar"},{browserLanguge:"id",key:"id",name:"Bahasa Indonesia"},{browserLanguge:"it",key:"it",name:"Italiano"},{browserLanguge:"ja",key:"ja",name:"日本語"},{browserLanguge:"ka",key:"ka",name:"ქართული"},{browserLanguge:"ko",key:"ko",name:"한국어"},{browserLanguge:"lt",key:"lt",name:"Lietuvių kalba"},{browserLanguge:"mk",key:"mk",name:"македонски јазик"},{browserLanguge:"nb",key:"nb",name:"Norsk bokmål"},{browserLanguge:"nl",key:"nl",name:"Nederlands"},{browserLanguge:"nn",key:"nn",name:"Norsk nynorsk"},{browserLanguge:"pl",key:"pl",name:"Polski"},{browserLanguge:"pt",key:"pt",name:"Português"},{browserLanguge:"pt-BR",key:"pt-BR",name:"Português (Brasil)"},{browserLanguge:"ru",key:"ru",name:"Русский язык"},{browserLanguge:"sv",key:"sv",name:"Svenska"},{browserLanguge:"ta",key:"ta",name:"தமிழ்"},{browserLanguge:"te",key:"te",name:"తెలుగు"},{browserLanguge:"tr",key:"tr",name:"Türkçe"},{browserLanguge:"uk",key:"uk",name:"Українська"},{browserLanguge:"zh-cn",key:"zh-cn",name:"简体中文"},{browserLanguge:"zh-tw",key:"zh-tw",name:"繁體中文"}],lang=null,i=0,selected_lang=window.ui_strings.lang_code,ret=[];for(;lang=dict[i];i++){ret[ret.length]=\
['option',lang.name,'value',lang.key].
concat(selected_lang==lang.key?['selected','selected']:[]);}
return ret;}}).apply(window.templates);handlers=new function(){var self=this;}
var runtimes=new function(){var __runtimes={};var __old_runtimes={};var __runtimes_arr=[];var __window_ids={};var __windows_reloaded={};var __selected_window='';var __threads=[];var __log_threads=false;var __windowsFolding={};var __old_selected_window='';var view_ids=['threads'];var runtime_views=[];var __replaced_scripts={};var __selected_runtime_id='';var __next_runtime_id_to_select='';var __selected_script='';var _is_first_call_create_all_runtimes_on_debug_context_change=true;var debug_context_frame_path='';var updateRuntimeViews=function(){var rt='',i=0;for(;rt=runtime_views[i];i++){views[rt].update();}}
var self=this;var onResetState=function(){__runtimes={};__old_runtimes={};__runtimes_arr=[];__window_ids={};__windows_reloaded={};__selected_window='';__threads=[];__log_threads=false;__windowsFolding={};__old_selected_window='';__selected_runtime_id='';__next_runtime_id_to_select='';__selected_script='';updateRuntimeViews();}
var registerRuntime=function(id){if(!(id in __runtimes)){opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'runtime id does not exist')
__runtimes[id]=null;services['ecmascript-debugger'].getRuntime(tagManager.setCB(null,parseRuntime),id);}}
var removeRuntime=function(id){var sc=null,cur='',i=0;for(;cur=__runtimes_arr[i]&&cur!=id;i++);if(cur){__runtimes_arr.splice(cur,1);}
if(__selected_runtime_id==id){__selected_runtime_id='';}
messages.post('runtime-destroyed',{id:id});__old_runtimes[id]=__runtimes[id];delete __runtimes[id];}
var cleanupWindow=function(win_id,rt_id){var cur='';for(cur in __runtimes){if(__runtimes[cur]&&__runtimes[cur]['window-id']==win_id){removeRuntime(__runtimes[cur]['runtime-id']);}}}
this.handleRuntimeStarted=function(xml){parseRuntime(xml);}
this.handleRuntimesReplay=function(xml){parseRuntime(xml);}
var isTopRuntime=function(rt){return rt['html-frame-path'].indexOf('[')==-1;}
var checkOldRuntimes=function(runtime){var cur='',old_rt=null;for(cur in __old_runtimes){old_rt=__old_runtimes[cur];if(old_rt
&&old_rt['uri']==runtime['uri']
&&old_rt['window-id']==runtime['window-id']
&&old_rt['html-frame-path']==runtime['html-frame-path']){runtime['unfolded-script']=old_rt['unfolded-script']||false;runtime['unfolded-css']=old_rt['unfolded-css']||false;return;}}}
var parseRuntime=function(xml){var r_ts=xml.getElementsByTagName('runtime'),r_t=null,i=0;var length=0,k=0;var runtimeId='',runtime=null,prop='',window_id='',children=null,child=null,j=0;var cur='';for(;r_t=r_ts[i];i++){runtimeId=r_t.getNodeData('runtime-id');if(runtimeId&&!__runtimes[runtimeId]){length=__runtimes_arr.length
for(k=0;k<length&&runtimeId!=__runtimes_arr[k];k++);if(k==length){__runtimes_arr[k]=runtimeId;}
runtime={};children=r_t.childNodes;for(j=0;child=children[j];j++){runtime[child.nodeName]=child.textContent;}
checkOldRuntimes(runtime);if(runtime.is_top=isTopRuntime(runtime)){var win_id=runtime['window-id'];if(win_id in __window_ids){cleanupWindow(win_id,runtimeId);}
else
{__window_ids[win_id]=true;}
if(__selected_window&&win_id!=__selected_window){runtime['opener-window-id']=__selected_window;}
if(!debug_context_frame_path){debug_context_frame_path=runtime['html-frame-path'];}
__selected_script='';}
getTitleRuntime(runtimeId);__runtimes[runtimeId]=runtime;if(__next_runtime_id_to_select==runtimeId){self.setSelectedRuntime(runtime);__next_runtime_id_to_select='';}
if(runtime['window-id']==__old_selected_window){self.setActiveWindowId(__old_selected_window);host_tabs.setActiveTab(__old_selected_window);__old_selected_window='';}
else
{updateRuntimeViews();}
if(__windows_reloaded[runtime['window-id']]==1){__windows_reloaded[runtime['window-id']]=2;}
if(debug_context_frame_path==runtime['html-frame-path']&&
__selected_window==runtime['window-id']&&
runtimeId!=__selected_runtime_id){self.setSelectedRuntimeId(runtimeId);}
if(runtime['window-id']==__selected_window||
runtime['opener-window-id']==__selected_window){host_tabs.updateActiveTab();}
if(runtime.is_top){views['js_source'].update();window['cst-selects']['js-script-select'].updateElement();window['cst-selects']['cmd-runtime-select'].updateElement();}}}
return r_ts;}
var getTitleRuntime=function(rt_id){var tag=tagManager.setCB(null,parseGetTitle,[rt_id]);var script="return ( document.title || '' )";services['ecmascript-debugger'].eval(tag,rt_id,'','',script);}
var parseGetTitle=function(xml,rt_id){if(__runtimes[rt_id]&&xml.getNodeData('status')=='completed'){__runtimes[rt_id]['title']=xml.getNodeData('string');updateRuntimeViews();}
else
{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'getting title has failed in runtimes getTitleRuntime');}}
var __scripts={};var registerScript=function(script){var sc=null,is_known=false;var new_script_id=script['script-id'];var new_rt=__runtimes[script['runtime-id']];var old_rt=null;var old_break_points=null;var line_nr='';for(sc in __scripts){old_rt=__runtimes[__scripts[sc]['runtime-id']]||__old_runtimes[__scripts[sc]['runtime-id']]||{};if(((__scripts[sc]['uri']&&__scripts[sc]['uri']==script['uri'])
||__scripts[sc]['script-data']==script['script-data'])&&
old_rt['uri']==new_rt['uri']&&
(old_rt['window-id']==new_rt['window-id']||
(new_rt['opener-window-id']&&
old_rt['opener-window-id']==new_rt['opener-window-id']))&&
old_rt['html-frame-path']==new_rt['html-frame-path']){is_known=true;break;}}
__scripts[new_script_id]=script;if(is_known){old_break_points=__scripts[sc]['breakpoints'];for(line_nr in old_break_points){self.setBreakpoint(new_script_id,line_nr);}
if(__scripts[sc]['script-id']==__selected_script){__selected_script=new_script_id;}
if(old_rt['window-id']==new_rt['window-id']){__replaced_scripts[__scripts[sc]['script-id']]=new_script_id;delete __scripts[sc];}}
if(!__selected_script){__selected_script=new_script_id;views['js_source'].update();window['cst-selects']['js-script-select'].updateElement();window['cst-selects']['cmd-runtime-select'].updateElement();}}
var breakpoint_count=1;var getBreakpointId=function(){return(breakpoint_count++).toString();}
var script_count=1;var getScriptId=function(){return(script_count++).toString();}
var log_thread=function(xml,rt_id,thread_id){var event_map={'thread-started':['thread-type','parent-thread-id'],'thread-finished':['status'],'thread-stopped-at':['script-id','line-number','stopped-reason']};var thread=__threads[__threads.length]={stoped_at_queue:runtime_stoped_queue.slice(0),rt_id:rt_id,thread_id:thread_id};var type=thread.event_type=xml.documentElement.nodeName,key='',i=0;for(;key=event_map[type][i];i++){thread[key]=xml.getNodeData(key);}
thread.threads=[];for(i=0;key=__runtimes_arr[i];i++){if(key in current_threads&&current_threads[key].length){thread.threads[thread.threads.length]=[key].concat(current_threads[key]);}}}
var onSettingChange=function(msg){var msg_id=msg.id,id='',i=0;for(;(id=view_ids[i])&&id!=msg_id;i++);if(id){switch(msg.key){case 'log-threads':{__log_threads=settings[id].get(msg.key);break;}}}}
var onActiveTab=function(msg){}
var onApplicationSetup=function(msg){__old_selected_window=settings.runtimes.get('selected-window');}
this.setActiveWindowId=function(window_id){if(window_id!=__selected_window){__selected_window=window_id;cleanUpThreadOnContextChange();settings.runtimes.set('selected-window',window_id);updateRuntimeViews();}}
this.createAllRuntimesOnDebugContextChange=function(win_id){debug_context_frame_path='';__selected_script='';if(_is_first_call_create_all_runtimes_on_debug_context_change){stop_at.setInitialSettings();_is_first_call_create_all_runtimes_on_debug_context_change=false;}
var tag=tagManager.setCB(null,set_new_debug_context,[win_id]);services['ecmascript-debugger'].createAllRuntimes(tag);}
var set_new_debug_context=function(xml,win_id){var runtimes=parseRuntime(xml);host_tabs.setActiveTab(win_id);if(runtimes.length){if(settings.runtimes.get('reload-runtime-automatically')){self.reloadWindow();}}
else
{if(win_id in __window_ids){cleanupWindow(win_id);}
else
{__window_ids[win_id]=true;}
__selected_runtime_id='';__selected_script='';views['js_source'].update();window['cst-selects']['js-script-select'].updateElement();window['cst-selects']['cmd-runtime-select'].updateElement();}}
this.getThreads=function(){return __threads;}
this.clearThreadLog=function(){__threads=[];}
this.handle=function(new_script_event){var script={};var children=new_script_event.documentElement.childNodes,child=null,i=0;for(;child=children[i];i++){script[child.nodeName]=child.firstChild.nodeValue;}
if(!script['script-data']){script['script-data']='';}
if(is_runtime_of_debug_context(script['runtime-id'])){script['breakpoints']={};script['stop-ats']=[];registerRuntime(script['runtime-id']);registerScript(script);}}
var thread_queues={};var current_threads={};var runtime_stoped_queue=[];var stoped_threads={};var cleanUpThreadOnContextChange=function(){thread_queues={};current_threads={};var rt_id='',i=0,thread_id='';for(;rt_id=runtime_stoped_queue[i];i++){thread_id=stoped_threads[rt_id]&&stoped_threads[rt_id].getNodeData("thread-id");if(thread_id){services['ecmascript-debugger'].continue_run(rt_id,thread_id);}}
stoped_threads={};runtime_stoped_queue=[];}
var is_runtime_of_debug_context=function(rt_id){return __runtimes[rt_id]&&
(__runtimes[rt_id]['window-id']==__selected_window||
__runtimes[rt_id]['opener-window-id']==__selected_window);}
var clear_thread_id=function(rt_id,thread_id){var cur='',i=0;var thread_queue=thread_queues[rt_id];var current_thread=current_threads[rt_id];if(current_thread){for(i=0;cur=current_thread[i];i++){if(cur==thread_id){current_thread.splice(i,1);break;}}
for(i=0;cur=thread_queue[i];i++){if(cur==thread_id){thread_queue.splice(i,1);delete stoped_threads[rt_id][thread_id];return true;}}}
else
{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'got a thread finished event \n'+'in a runtime where the thread \n'+'has never started: '+rt_id+' '+thread_id)}
return false;}
this.handleThreadStarted=function(xml){var rt_id=xml.getNodeData("runtime-id");if(is_runtime_of_debug_context(rt_id)){var id=xml.getNodeData("thread-id");var parent_thread_id=xml.getNodeData("parent-thread-id");var thread_queue=thread_queues[rt_id]||(thread_queues[rt_id]=[]);var current_thread=current_threads[rt_id]||(current_threads[rt_id]=[]);thread_queue[thread_queue.length]=id;if(!current_thread.length||
(parent_thread_id!='0'&&parent_thread_id==current_thread[current_thread.length-1])){current_thread[current_thread.length]=id;}
if(__log_threads){log_thread(xml,rt_id,id);views.threads.update();}}}
this.handleThreadStopedAt=function(xml){var rt_id=xml.getNodeData("runtime-id");var thread_id=xml.getNodeData("thread-id");if(is_runtime_of_debug_context(rt_id)){var current_thread=current_threads[rt_id];if(!stop_at.getControlsEnabled()
&&(!current_thread
||thread_id==current_thread[current_thread.length-1])){stop_at.handle(xml);}
else
{if(!stoped_threads[rt_id]){stoped_threads[rt_id]={};}
stoped_threads[rt_id]=xml;runtime_stoped_queue[runtime_stoped_queue.length]=rt_id;}
if(__log_threads){log_thread(xml,rt_id,thread_id);views.threads.update();}}
else
{services['ecmascript-debugger'].continue_run(rt_id,thread_id);}}
this.handleThreadFinished=function(xml){var rt_id=xml.getNodeData("runtime-id");if(is_runtime_of_debug_context(rt_id)){var thread_id=xml.getNodeData("thread-id");clear_thread_id(rt_id,thread_id);if(!stop_at.getControlsEnabled()&&runtime_stoped_queue.length){stop_at.handle(stoped_threads[runtime_stoped_queue.shift()]);}
if(__log_threads){log_thread(xml,rt_id,thread_id);views.threads.update();}}}
var onHostStateChange=function(msg){if(!stop_at.getControlsEnabled()&&runtime_stoped_queue.length){stop_at.handle(stoped_threads[runtime_stoped_queue.shift()]);}}
this.handleRuntimeStoped=function(xml){var rt_id=xml.getNodeData('runtime-id');if(rt_id){removeRuntime(rt_id);updateRuntimeViews();messages.post('runtime-stopped',{id:rt_id});}}
this.getWindows=function(){var ret=[],r='',is_unfolded=true;for(r in __runtimes){if(__runtimes[r]&&__runtimes[r]['html-frame-path']&&__runtimes[r]['html-frame-path'].indexOf('[')==-1){is_unfolded=true;if(__windowsFolding[__runtimes[r]['window-id']]===false){is_unfolded=false;}
ret[ret.length]={id:__runtimes[r]['window-id'],uri:__runtimes[r]['uri'],title:__runtimes[r]['title']||'',is_unfolded:is_unfolded,is_selected:__selected_window==__runtimes[r]['window-id']||
__selected_window==__runtimes[r]['opener-window-id'],runtimes:this.getRuntimes(__runtimes[r]['window-id'])}}}
return ret;}
this.getActiveWindowId=function(){return __selected_window;}
this.getRuntimes=function(window_id){var ret=[],r='';for(r in __runtimes){if(__runtimes[r]&&__runtimes[r]['window-id']&&
(__runtimes[r]['window-id']==window_id||
__runtimes[r]['opener-window-id']==window_id)){ret[ret.length]=__runtimes[r];}}
return ret;}
this.getRuntime=function(rt_id){return __runtimes[rt_id]||null;}
this.getRuntimeIdsFromWindow=function(window_id){var ret=[],r='';for(r in __runtimes){if(__runtimes[r]&&__runtimes[r]['window-id']&&
(__runtimes[r]['window-id']==window_id||
__runtimes[r]['opener-window-id']==window_id)){if(__runtimes[r].is_top&&!__runtimes[r]['opener-window-id']){ret=[__runtimes[r]['runtime-id']].concat(ret);}
else
{ret[ret.length]=__runtimes[r]['runtime-id'];}}}
return ret;}
this.getRuntimeIdWithURL=function(url){var r='';for(r in __runtimes){if(__runtimes[r]['uri']==url){return __runtimes[r];}}
return null;}
this.getURI=function(rt_id){for(var r in __runtimes){if(__runtimes[r]['runtime-id']==rt_id){return __runtimes[r]['uri'];}}
return '';}
this.getScript=function(scriptId){return __scripts[scriptId]||__scripts[__replaced_scripts[scriptId]]||null;}
this.getStoppedAt=function(scriptId){return __scripts[scriptId]&&__scripts[scriptId]['stop-ats']||null;}
this.getScriptsRuntimeId=function(scriptId){return __scripts[scriptId]&&__scripts[scriptId]['runtime-id']||null;}
this.getScriptSource=function(scriptId){if(__scripts[scriptId]){return __scripts[scriptId]['script-data']}
return null;}
this.getScripts=function(runtime_id){var ret=[],script=null,cur='';for(cur in __scripts){script=__scripts[cur];if(script['runtime-id']==runtime_id){ret[ret.length]=script;}}
return ret;}
this.hasBreakpoint=function(script_id,line_nr){return __scripts[script_id]&&(line_nr in __scripts[script_id]['breakpoints']);}
this.setBreakpoint=function(script_id,line_nr){var b_p_id=__scripts[script_id]['breakpoints'][line_nr]=getBreakpointId();services['ecmascript-debugger'].setBreakpoint(script_id,line_nr,b_p_id);}
this.removeBreakpoint=function(script_id,line_nr){services['ecmascript-debugger'].removeBreakpoint(__scripts[script_id]['breakpoints'][line_nr]);delete __scripts[script_id]['breakpoints'][line_nr];}
this.getBreakpoints=function(script_id){return __scripts[script_id]&&__scripts[script_id]['breakpoints'];}
this.setUnfolded=function(runtime_id,view,is_unfolded){if(__runtimes[runtime_id]){__runtimes[runtime_id]['unfolded-'+view]=is_unfolded;}}
this.setWindowUnfolded=function(window_id,is_unfolded){__windowsFolding[window_id]=is_unfolded;}
this.setObserve=function(runtime_id,observe){if(__runtimes[runtime_id]){__runtimes[runtime_id]['observe']=observe;}}
this.getObserve=function(runtime_id){return __runtimes[runtime_id]&&__runtimes[runtime_id]['observe']||false;}
this.setSelectedRuntime=function(runtime){var r='';for(r in __runtimes){if(__runtimes[r]==runtime){__runtimes[r]['selected']=true;__selected_runtime_id=__runtimes[r]['runtime-id'];}
else
{if(__runtimes[r]){__runtimes[r]['selected']=false;}}}}
this.setSelectedScript=function(script_id){__selected_script=script_id;}
this.getSelectedScript=function(){return __selected_script;}
this.setSelectedRuntimeId=function(id){if(__runtimes[id]){this.setSelectedRuntime(__runtimes[id]);}
else
{__next_runtime_id_to_select=id;}}
this.getSelectedRuntimeId=function(){return __selected_runtime_id;}
this.getSelecetdScriptIdFromSelectedRuntime=function(){var scripts=this.getScripts(__selected_runtime_id),script=null,i=0;for(;script=scripts[i];i++){if(script.selected){return script['script-id'];}}
return null;}
this.getRuntimeIdWithScriptId=function(scriptId){return __scripts[scriptId]&&__scripts[scriptId]['runtime-id']||null;}
this.reloadWindow=function(){if(__selected_window){if(!__windows_reloaded[__selected_window]){__windows_reloaded[__selected_window]=1;}
var rt_id=this.getRuntimeIdsFromWindow(__selected_window)[0];if(rt_id){services['ecmascript-debugger'].eval('-1',rt_id,'','','location.reload()');}}}
this.isReloadedWindow=function(window_id){return __windows_reloaded[window_id]==2;}
var onThreadStopped=function(msg){var script_id=msg.stop_at['script-id'];if(script_id&&__scripts[script_id]){var stop_ats=__scripts[script_id]['stop-ats'];stop_ats[stop_ats.length]=msg.stop_at;}}
var onThreadContinue=function(msg){var
script_id=msg.stop_at['script-id'],stop_ats=__scripts[script_id]&&__scripts[script_id]['stop-ats'],stop_at=null,i=0;if(stop_ats){for(;stop_at=stop_ats[i];i++){if(stop_at==msg.stop_at){stop_ats.splice(i,1);return;}}}}
messages.addListener("thread-stopped-event",onThreadStopped);messages.addListener("thread-continue-event",onThreadContinue);messages.addListener('host-state',onHostStateChange);messages.addListener('setting-changed',onSettingChange);messages.addListener('active-tab',onActiveTab);messages.addListener('application-setup',onApplicationSetup);messages.addListener('reset-state',onResetState);}
var stop_at=new function(){var stop_at_settings={script:1,exception:0,error:0,abort:0}
var stop_at_user_settings={script:0,exception:0,error:0,abort:0}
var self=this;var stopAt={};var runtime_id='';var callstack=[];var __controls_enabled=false;var __stopAtId=1;var cur_inspection_type='';var getStopAtId=function(){return __stopAtId++;}
var _is_initial_settings_set=false;this.getStopAts=function(){return stop_at_user_settings;}
var onSettingChange=function(msg){if(msg.id=='js_source'){var key=msg.key,value=settings['js_source'].get(key);if(key=='script'){}
else
{stop_at_settings[key]=value;services['ecmascript-debugger'].setConfiguration(key,value?'yes':'no');}}}
this.setUserStopAt=function(key,value){opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'clean up. this should no longer be called. stop_at.setUserStopAt');}
this.getRuntimeId=function(){return runtime_id;}
this.getControlsEnabled=function(){return __controls_enabled;}
this.getFrames=function(){return callstack;}
this.getFrame=function(id){return callstack[id];}
this.getThreadId=function(){return stopAt&&stopAt['thread-id']||'';}
var parseBacktrace=function(xml,runtime_id,thread_id){var _frames=xml.getElementsByTagName('frame'),frame=null,i=0;var fn_name='',line='',script_id='',argument_id='',scope_id='';var _frames_length=_frames.length;var is_all_frames=_frames_length<=ini.max_frames;callstack=[];for(;frame=_frames[i];i++){callstack[i]={fn_name:is_all_frames&&i==_frames_length-1
?'global scope'
:frame.getNodeData('function-name')||'anonymous',line:frame.getNodeData('line-number'),script_id:frame.getNodeData('script-id'),argument_id:frame.getNodeData('argument-object'),scope_id:frame.getNodeData('variable-object'),this_id:frame.getNodeData('this-object'),id:i,rt_id:runtime_id}}
views.callstack.update();if(cur_inspection_type!='frame'){messages.post('active-inspection-type',{inspection_type:'frame'});}
messages.post('frame-selected',{frame_index:0});}
this.setInitialSettings=function(){if(!_is_initial_settings_set){var config_arr=[],prop='';for(prop in stop_at_settings){config_arr[config_arr.length]=prop;config_arr[config_arr.length]=((stop_at_user_settings[prop]=settings['js_source'].get(prop))
||stop_at_settings[prop])&&'yes'||'no';}
services['ecmascript-debugger'].setConfiguration.apply(services['ecmascript-debugger'],config_arr);_is_initial_settings_set=true;}}
this.__continue=function(mode){__controls_enabled=false;callstack=[];runtimes.setObserve(stopAt['runtime-id'],mode!='run');services['ecmascript-debugger'].__continue(stopAt,mode);messages.post('frame-selected',{frame_index:-1});messages.post('thread-continue-event',{stop_at:stopAt});toolbars.js_source.disableButtons('continue');messages.post('host-state',{state:'ready'});}
this.handle=function(stop_at_event){stopAt={};var id=getStopAtId();var children=stop_at_event.documentElement.childNodes,child=null,i=0;for(;child=children[i];i++){if(child.firstChild){stopAt[child.nodeName]=child.firstChild.nodeValue;}
else
{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+"empty element in <thread-stopped-at> event");stopAt[child.nodeName]=null}}
var line=parseInt(stopAt['line-number']);if(typeof line=='number'){if(stopAt['stopped-reason']=='unknown'){runtime_id=stopAt['runtime-id'];if(settings['js_source'].get('script')
||runtimes.getObserve(runtime_id)
||runtimes.hasBreakpoint(stopAt['script-id'],line)){if(runtimes.getSelectedRuntimeId()!=runtime_id){runtimes.setSelectedRuntimeId(runtime_id);}
var tag=tagManager.setCB(null,parseBacktrace,[stopAt['runtime-id']]);services['ecmascript-debugger'].backtrace(tag,stopAt);if(!views.js_source.isvisible()){topCell.showView(views.js_source.id);}
var plus_lines=views.js_source.getMaxLines()<=10
?views.js_source.getMaxLines()/2>>0
:10;if(views.js_source.showLine(stopAt['script-id'],line-plus_lines)){runtimes.setSelectedScript(stopAt['script-id']);views.js_source.showLinePointer(line,true);}
__controls_enabled=true;window.focus();toolbars.js_source.enableButtons('continue');messages.post('thread-stopped-event',{stop_at:stopAt});messages.post('host-state',{state:'waiting'});}
else
{this.__continue('run');}}
else
{runtime_id=stopAt['runtime-id'];var tag=tagManager.setCB(null,parseBacktrace,[stopAt['runtime-id']]);services['ecmascript-debugger'].backtrace(tag,stopAt);if(!views.js_source.isvisible()){topCell.showView(views.js_source.id);}
var plus_lines=views.js_source.getMaxLines()<=10
?views.js_source.getMaxLines()/2>>0
:10;if(views.js_source.showLine(stopAt['script-id'],line-plus_lines)){runtimes.setSelectedScript(stopAt['script-id']);views.js_source.showLinePointer(line,true);}
__controls_enabled=true;window.focus();toolbars.js_source.enableButtons('continue');messages.post('thread-stopped-event',{stop_at:stopAt});messages.post('host-state',{state:'waiting'});}}
else
{throw 'not a line number: '+stopAt['line-number'];}}
var onRuntimeDestroyed=function(msg){if(stopAt&&stopAt['runtime-id']==msg.id){views.callstack.clearView();views.inspection.clearView();self.__continue('run');}}
messages.addListener('runtime-destroyed',onRuntimeDestroyed);var onActiveInspectionType=function(msg){cur_inspection_type=msg.inspection_type;}
messages.addListener('active-inspection-type',onActiveInspectionType);messages.addListener('setting-changed',onSettingChange);}
var runtime_onload_handler=new function(){const
COMPLETE='complete';var
__rts={},__onload_handlers={},poll_interval=50;var reset_state_handler=function(){__rts={};__onload_handlers={};}
var poll=function(rt_id){if(blocked_rts[rt_id]){setTimeout(poll,poll_interval,rt_id);}
else
{var tag=tagManager.setCB(null,handleReadyState,[rt_id]);var script="return document.readyState";services['ecmascript-debugger'].eval(tag,rt_id,'','',script);}}
var handleReadyState=function(xml,rt_id){if(xml.getNodeData('status')=='completed'){if(xml.getNodeData('string')==COMPLETE){__rts[rt_id]=COMPLETE;var onload_handlers=__onload_handlers[rt_id],cur=null,i=0;for(;cur=onload_handlers[i];i++){cur.callee.apply(null,cur);}
delete __onload_handlers[rt_id];}
else
{setTimeout(poll,poll_interval,rt_id);}}
else
{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'getting readyState has failed in runtime_onload_handler handleReadyState');}}
var register=function(rt_id,org_args){if(!__onload_handlers[rt_id]){__onload_handlers[rt_id]=[];poll(rt_id);}
var onload_handlers=__onload_handlers[rt_id],cur=null,i=0;for(;(cur=onload_handlers[i])&&cur.callee!=org_args.callee;i++);onload_handlers[i]=org_args;}
this.check=function(rt_id,org_args){if(__rts[rt_id]==COMPLETE){return true;}
else
{register(rt_id,org_args);return false;}}
var blocked_rts={};var onThreadStopped=function(msg){blocked_rts[msg.stop_at["runtime-id"]]=true;}
var onThreadContinue=function(msg){blocked_rts[msg.stop_at["runtime-id"]]=false;}
messages.addListener("thread-stopped-event",onThreadStopped);messages.addListener("thread-continue-event",onThreadContinue);messages.addListener('reset-state',reset_state_handler);}
var ObjectDataBase=new function(){const
KEY=0,VALUE=1,TYPE=2,DEPTH=3,QUERIED=4,SEARCH=5,CONSTRUCTOR=6,IS_VIRTUAL=7,ITEM=8,MAX_VALUE_LENGTH=50;this.rt_id='';this.data=[];this.parseXML=function(xml,rt_id,obj_id,org_args){var
obj=xml.getElementsByTagName('object')[0],class_name=xml.getNodeData('class-name'),props=null,prop=null,i=0,prop_type='',index=this.getObject(obj_id),unsorted=[index+1+this.getCountVirtualProperties(index),0],depth=0;this.data[index][CONSTRUCTOR]||(this.data[index][CONSTRUCTOR]=class_name);if(obj&&index>-1){props=obj.getElementsByTagName('property');depth=this.data[index][DEPTH]+1;this.data[index][QUERIED]=1;for(;prop=props[i];i++){switch(prop.getNodeData('data-type')){case 'object':{unsorted[unsorted.length]=[prop.getNodeData('property-name'),prop.getNodeData('object-id'),'object',depth]
break;}
case 'undefined':{unsorted[unsorted.length]=[prop.getNodeData('property-name'),'"undefined"','undefined',depth]
break;}
case 'null':{unsorted[unsorted.length]=[prop.getNodeData('property-name'),'null','null',depth]
break;}
case 'number':{unsorted[unsorted.length]=[prop.getNodeData('property-name'),prop.getNodeData('string'),'number',depth]
break;}
case 'string':{unsorted[unsorted.length]=[prop.getNodeData('property-name'),'"'+prop.getNodeData('string')+'"','string',depth]
break;}
case 'boolean':{unsorted[unsorted.length]=[prop.getNodeData('property-name'),prop.getNodeData('string'),'boolean',depth]
break;}}}
var sort_key=function(a,b){return a[KEY]<b[KEY]?-1:a[KEY]>b[KEY]?1:0;}
var sort_item=function(a,b){return a[ITEM]<b[ITEM]?-1:a[ITEM]>b[ITEM]?1:0;}
if(class_name=="Array"){var
items=[],attributes=[],cursor=null,i=2,re_d=/\d+/;for(;cursor=unsorted[i];i++){if(re_d.test(cursor[KEY])){cursor[ITEM]=parseInt(cursor[KEY]);items[items.length]=cursor;}
else
{attributes[attributes.length]=cursor;}}
items=items.sort(sort_item);attributes=attributes.sort(sort_key);unsorted=[unsorted[0],unsorted[1]].concat(items,attributes);}
else
{unsorted.sort(sort_key);}
this.data.splice.apply(this.data,unsorted);if(org_args&&!org_args[0].__call_count){org_args[0].__call_count=1;org_args.callee.apply(null,org_args)}}}
this.getObject=function(obj_id,depth,key){var prop=null,i=0;for(;prop=this.data[i];i++){if(prop[VALUE]==obj_id
&&(isNaN(depth)||prop[DEPTH]==depth)
&&(!key||prop[KEY]==key)){return i;}}
return -1;}
this.getCountVirtualProperties=function(index){var prop=null,i=index+1,depth=this.data[index][DEPTH]+1,count=0;for(;(prop=this.data[i])&&prop[IS_VIRTUAL]&&prop[DEPTH]==depth;i++){count+=1;}
return count;}
this.setObject=function(rt_id,obj_id,virtualProperties){this.rt_id=rt_id;this.__cache=null;this.__cached_index=0;this.data=[['',obj_id,'object',-1]]
if(virtualProperties){var prop=null,i=0;for(;prop=virtualProperties[i];i++){prop[IS_VIRTUAL]=1;}
this.data=this.data.concat(virtualProperties);}}
this.__cache=null;this.__cached_index=0;this.__getData=function(index,target_depth){var ret=[],i=index+1,depth=this.data[index][DEPTH],prop=null;ret.object_index=index;if(target_depth>depth){depth+=1;for(;(prop=this.data[i]);i++){if(prop[DEPTH]==depth&&!prop[IS_VIRTUAL]){ret[ret.length]=prop;}}}
else
{for(;(prop=this.data[i])&&prop[DEPTH]>depth;i++){ret[ret.length]=prop;}}
return ret;}
this.getData=function(rt_id,obj_id,depth,org_args){var index=this.getObject(obj_id);if(rt_id==this.rt_id&&index>-1){if(this.data[index][QUERIED]){return this.__getData(index,depth);}}
var tag=tagManager.setCB(this,this.parseXML,[rt_id,obj_id,org_args]);services['ecmascript-debugger'].examineObjects(tag,rt_id,obj_id);return null;}
this.clearData=function(rt_id,obj_id,depth,key){if(obj_id){var index=this.getObject(obj_id,depth,key),i=0,depth=0,prop=null;if(rt_id==this.rt_id&&index>-1){i=index+1;depth=this.data[index][DEPTH];for(;(prop=this.data[i])&&prop[DEPTH]>depth;i++);this.data.splice(index+1,i-(index+1));delete this.data[index][QUERIED];}}
else
{this.data=[];}}
this.prettyPrint=function(data,target_depth,use_filter,filter_type){var
ret="",prop=null,i=0,val="",short_val="",filter={};if(use_filter){if(filter_type==VALUE){filter={'""':1,"null":1};}
else
{filter=js_object_filters[this.data[data.object_index][CONSTRUCTOR]]||{};}}
var forced_depth=data[0]&&target_depth>=data[0][DEPTH]&&target_depth+1||0;var depth=0;for(;prop=data[i];i++){val=prop[VALUE];short_val="";if(filter&&prop[filter_type]in filter){if(filter_type==KEY){switch(prop[TYPE]){case 'object':case 'null':case 'undefined':{if(prop[TYPE]==filter[prop[KEY]]){continue;}}
case 'string':{if(val=='"'+filter[prop[KEY]]+'"'){continue;}}
case 'number':case 'boolean':{if(val==filter[prop[KEY]]){continue;}}}}
else
{continue;}}
if(val.length>MAX_VALUE_LENGTH){short_val=val.slice(0,MAX_VALUE_LENGTH)+"...";val=val.replace(/</g,'&lt;').replace(/'/g,'&#39;');}
val=val.replace(/</g,"&lt;");depth=forced_depth||prop[DEPTH];if(prop[TYPE]=='object'){ret+="<item style='padding-left:"+(9+16*depth)+"px'"+" obj-id='"+prop[VALUE]+"' "+" depth='"+depth+"'>"+"<input type='button' handler='examine-object-2'  class='folder-key'/>"+"<key>"+prop[KEY]+"</key>"+"<value class='object'>object</value>"+"</item>";}
else
{if(short_val){ret+="<item style='padding-left:"+(9+16*depth)+"px'>"+"<key>"+prop[KEY]+"</key>"+"<value class='"+prop[TYPE]+"' title='"+val+"'>"+short_val+"</value>"+"</item>";}
else
{ret+="<item style='padding-left:"+(9+16*depth)+"px'>"+"<key>"+prop[KEY]+"</key>"+"<value class='"+prop[TYPE]+"'>"+val+"</value>"+"</item>";}}}
return ret;}}
var Frame_inspection_data=function(){const
KEY=0,VALUE=1;var __selectedObject=null;var __views=['inspection'];var __is_active_inspection=true;this.rt_id='';this.data=[];this.filter_type=KEY;var self=this;this.getSelectedObject=function(){return __selectedObject;}
this.getSelectedObjectData=function(){if(__selectedObject){return this.getData(__selectedObject.rt_id,__selectedObject.obj_id);}}
this.examineObject=function(rt_id,obj_id){__selectedObject={rt_id:rt_id,obj_id:obj_id};self.setObject(rt_id,obj_id);var view_id='',i=0;for(;view_id=__views[i];i++){topCell.showView(views[view_id].id);}}
var handleShowGlobalScope=function(xml,rt_id){if(xml.getNodeData('status')=='completed'){frame_inspection_data.examineObject(rt_id,xml.getNodeData('object-id'));}
else
{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'getting window id has failed in handleShowGlobalScope in frame_inspection');}}
this.showGlobalScope=function(rt_id){var tag=tagManager.setCB(null,handleShowGlobalScope,[rt_id]);var script="return window";services['ecmascript-debugger'].eval(tag,rt_id,'','',script);}
var onFrameSelected=function(msg){var frame=stop_at.getFrame(msg.frame_index);if(frame){__selectedObject={rt_id:frame.rt_id,obj_id:frame.scope_id};var virtualProperties=[['arguments',frame.argument_id,'object',0],['this',frame.this_id=='0'?frame.rt_id:frame.this_id,'object',0]];self.setObject(__selectedObject.rt_id,__selectedObject.obj_id,virtualProperties);}
else
{__selectedObject=null;self.clearData();}
var view_id='',i=0;if(__is_active_inspection){for(;view_id=__views[i];i++){views[view_id].update();}}}
var onActiveInspectionType=function(msg){__is_active_inspection=msg.inspection_type=='frame';}
messages.addListener('frame-selected',onFrameSelected);messages.addListener('active-inspection-type',onActiveInspectionType);}
Frame_inspection_data.prototype=ObjectDataBase;frame_inspection_data=new Frame_inspection_data();var Object_inspection_data=function(){const
KEY=0,VALUE=1;var __selectedObject=null;var __views=['inspection'];var __is_active_inspection=false;this.rt_id='';this.data=[];this.filter_type=KEY;var self=this;this.getSelectedObject=function(){return __selectedObject;}
this.getSelectedObjectData=function(){if(__selectedObject){return this.getData(__selectedObject.rt_id,__selectedObject.obj_id);}}
this.examineObject=function(rt_id,obj_id){__selectedObject={rt_id:rt_id,obj_id:obj_id};self.setObject(rt_id,obj_id);var view_id='',i=0;if(__is_active_inspection){for(;view_id=__views[i];i++){views[view_id].update();}}}
var handleShowGlobalScope=function(xml,rt_id){if(xml.getNodeData('status')=='completed'){self.examineObject(rt_id,xml.getNodeData('object-id'));}
else
{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'getting window id has failed in handleShowGlobalScope in object_inspection_data');}}
this.showGlobalScope=function(rt_id){var tag=tagManager.setCB(null,handleShowGlobalScope,[rt_id]);var script="return window";services['ecmascript-debugger'].eval(tag,rt_id,'','',script);}
var onObjectSelected=function(msg){__selectedObject={rt_id:msg.rt_id,obj_id:msg.obj_id};self.setObject(__selectedObject.rt_id,__selectedObject.obj_id);var view_id='',i=0;if(__is_active_inspection){for(;view_id=__views[i];i++){views[view_id].update();}}}
messages.addListener('object-selected',onObjectSelected);var onActiveInspectionType=function(msg){__is_active_inspection=msg.inspection_type=='object';}
messages.addListener('active-inspection-type',onActiveInspectionType);var onRuntimeDestroyed=function(msg){if(__selectedObject&&__selectedObject.rt_id==msg.id){__selectedObject=null;views.inspection.clearAllContainers();}}
messages.addListener('runtime-destroyed',onRuntimeDestroyed);}
Object_inspection_data.prototype=ObjectDataBase;object_inspection_data=new Object_inspection_data();var cls=window.cls||(window.cls={});cls.RuntimesView=function(id,name,container_class){this.init(id,name,container_class);}
cls.RuntimesView.prototype=ViewBase;new cls.RuntimesView('runtimes',ui_strings.M_VIEW_LABEL_SCRIPTS,'scroll runtimes');new Settings
('runtimes',{'selected-window':'','reload-runtime-automatically':true},{'reload-runtime-automatically':ui_strings.S_SWITCH_RELOAD_SCRIPTS_AUTOMATICALLY},{checkboxes:['reload-runtime-automatically']});var cls=window.cls||(window.cls={});cls.EnvironmentView=function(id,name,container_class){var self=this;this.createView=function(container){container.innerHTML='';container.render(templates.hello(services['ecmascript-debugger'].getEnvironment()));}
this.init(id,name,container_class);}
cls.EnvironmentView.prototype=ViewBase;new cls.EnvironmentView('environment',ui_strings.M_VIEW_LABEL_ENVIRONMENT,'scroll');new Settings
('environment',{},{},{},function(setting){return templates.hello(services['ecmascript-debugger'].getEnvironment());});cls.CallstackView=function(id,name,container_class){var container_id='backtrace';var __clear_timeout=0;var __clearView=function(){var container=document.getElementById(container_id);if(container){container.innerHTML='';__clear_timeout=0;}}
this.createView=function(container){var list=container.getElementsByTagName('ul')[0];if(!list){container.innerHTML="<div id='backtrace-container'><ul id='backtrace'></ul></div>";list=container.getElementsByTagName('ul')[0];}
if(__clear_timeout){__clear_timeout=clearTimeout(__clear_timeout);}
var _frames=stop_at.getFrames(),frame=null,i=0;list.innerHTML='';for(;frame=_frames[i];i++){list.render(templates.frame(frame,i==0));}}
this.clearView=function(){__clear_timeout=setTimeout(__clearView,150);}
this.init(id,name,container_class);}
cls.CallstackView.prototype=ViewBase;new cls.CallstackView('callstack',ui_strings.M_VIEW_LABEL_CALLSTACK,'scroll');cls.GeneralView=function(id,name,container_class){this.ishidden_in_menu=true;this.createView=function(container){}
this.init(id,name,container_class);}
cls.GeneralView.prototype=ViewBase;new cls.GeneralView('general',ui_strings.M_SETTING_LABEL_GENERAL,'');new Settings
('general',{"show-views-menu":false,"window-attached":true,"show-only-normal-and-gadget-type-windows":true},{"show-views-menu":ui_strings.S_SWITCH_SHOW_VIEWS_MENU,"show-only-normal-and-gadget-type-windows":ui_strings.S_SWITCH_SHOW_ONLY_NORMAL_AND_GADGETS_TYPE_WINDOWS},{checkboxes:["show-only-normal-and-gadget-type-windows",]},function(setting){return[['hr'],['setting-composite','User Interface Language'+': ',['select',templates.uiLangOptions(),'handler','set-ui-language']]];});eventHandlers.change['set-ui-language']=function(event){helpers.setCookie('ui-lang',event.target.value);helpers.setCookie('ui-lang-set','1');location.reload();}
cls.DocumentationView=function(id,name,container_class){var __url='';this.setURL=function(url){__url=url;}
this.createView=function(container){if(__url){container.render(['iframe','width','100%','height','100%','style','dispaly:block;border:none','src',__url])}}
this.init(id,name,container_class);}
cls.DocumentationView.prototype=ViewBase;new cls.DocumentationView('documentation','Documentation','');cls.DebugRemoteSettingView=function(id,name,container_class){this.ishidden_in_menu=true;this.createView=function(container){;}
this.init(id,name,container_class);}
cls.DebugRemoteSettingView.prototype=ViewBase;new cls.DebugRemoteSettingView('debug_remote_setting',ui_strings.S_SWITCH_REMOTE_DEBUG,'');new Settings
('debug_remote_setting',{"debug-remote":false,"port":7001},{"debug-remote":ui_strings.S_SWITCH_REMOTE_DEBUG},{checkboxes:[]},function(setting){return[['setting-composite',['label',['input','type','checkbox','checked',this.get('debug-remote'),'handler','toggle-remote-debug'],this.label_map['debug-remote']],['label',ui_strings.S_LABEL_PORT+': ',['input','type','number','value',this.get('port'),'disabled',!this.get('debug-remote'),'handler','change-port-number-remote-debug','current-port',this.get('port').toString()]],['input','type','button','disabled','disabled','value',ui_strings.S_BUTTON_TEXT_APPLY,'handler','apply-remote-debugging']]];});eventHandlers.change['change-port-number-remote-debug']=function(event,target){target.parentNode.nextSibling.disabled=target.getAttribute('current-port')==target.value;}
eventHandlers.change['toggle-remote-debug']=function(event,target){target.parentNode.nextSibling.childNodes[1].disabled=!event.target.checked;target.parentNode.nextSibling.nextSibling.disabled=event.target.checked==settings.debug_remote_setting.get('debug-remote')}
eventHandlers.click['apply-remote-debugging']=function(event,target){var is_debug_remote=target.parentNode.getElementsByTagName('input')[0].checked;var port=parseInt(target.parentNode.getElementsByTagName('input')[1].value);if(port){settings.debug_remote_setting.set('debug-remote',is_debug_remote);settings.debug_remote_setting.set('port',port);client.scopeSetupClient();target.disabled=target.previousSibling.previousSibling.firstChild.checked==settings.debug_remote_setting.get('debug-remote');}}
var templates=window.templates||(window.templates={});templates.windowSelect=function(){return['window-select',['select','handler',this.handler]];}
new ToolbarConfig
('main-view',[{handler:'reload-window',title:ui_strings.S_BUTTON_LABEL_RELOAD_HOST}],null,null,[{handler:'select-window',title:ui_strings.S_BUTTON_LABEL_SELECT_WINDOW,type:'dropdown',class:'window-select-dropdown',template:templates.windowSelect}])
eventHandlers.click['reload-window']=function(event,target){runtimes.reloadWindow();}
var dom_data=new function(){var self=this;var view_ids=['dom'];var settings_id='dom';var data=[];var mime='';var data_runtime_id='';var current_target='';var __next_rt_id='';var activeWindow=[];const
ID=0,TYPE=1,NAME=2,DEPTH=3,NAMESPACE=4,VALUE=4,ATTRS=5,ATTR_PREFIX=0,ATTR_KEY=1,ATTR_VALUE=2,CHILDREN_LENGTH=6,PUBLIC_ID=4,SYSTEM_ID=5;var onResetState=function(){data=[];mime='';data_runtime_id='';current_target='';__next_rt_id='';activeWindow=[];}
var is_view_visible=function(){var id='',i=0;for(;(id=view_ids[i])&&!views[id].isvisible();i++);return i<view_ids.length;}
var onActiveTab=function(msg){data=[];mime='';var view_id='',i=0;data_runtime_id=__next_rt_id||msg.activeTab[0];messages.post("runtime-selected",{id:data_runtime_id});window['cst-selects']['document-select'].updateElement();activeWindow=msg.activeTab.slice(0);for(;view_id=view_ids[i];i++){if(views[view_id].isvisible()){onShowView({id:view_id})}}}
var clickHandlerHost=function(event){var rt_id=event['runtime-id'],obj_id=event['object-id'];current_target=obj_id;data=[];mime='';var tag=tagManager.setCB(null,handleGetDOM,[rt_id,obj_id]);services['ecmascript-debugger'].inspectDOM(tag,obj_id,'parent-node-chain-with-children','json');}
var domNodeRemovedHandler=function(event){var rt_id=event['runtime-id'],obj_id=event['object-id'];var node=null,i=0,j=0,level=0,k=0,view_id='';if(!(actions['dom'].editor&&actions['dom'].editor.is_active)&&data_runtime_id==rt_id){for(;(node=data[i])&&obj_id!=node[ID];i++);if(node&&node[TYPE]==1){level=node[DEPTH];j=i+1;while(data[j]&&data[j][DEPTH]>level)j++;data.splice(i,j-i);for(;view_id=view_ids[k];k++){views[view_id].update();}}}}
var set_mime=function(){var
node=null,i=0;for(;node=data[i];i++){if(node[TYPE]==1){return/^[A-Z]*$/.test(node[NAME])&&"text/html"||"application/xml";}}}
this.isTextHtml=function(){return data.length&&mime=="text/html"||false;}
var handleGetDOM=function(xml,rt_id,obj_id){var json=xml.getNodeData('jsondata');if(json){data=eval('('+json+')');mime=set_mime();if(rt_id!=data_runtime_id||__next_rt_id){data_runtime_id=rt_id;messages.post("runtime-selected",{id:data_runtime_id});window['cst-selects']['document-select'].updateElement();__next_rt_id='';}
var view_id='',i=0;for(;view_id=view_ids[i];i++){views[view_id].update();views[view_id].scrollTargetIntoView();}
if(obj_id){messages.post("element-selected",{obj_id:obj_id,rt_id:rt_id});}}}
var onSettingChange=function(msg){if(msg.id==settings_id){if(is_view_visible()){switch(msg.key){case 'highlight-on-hover':{if(settings[settings_id].get(msg.key)){host_tabs.activeTab.addEventListener('mouseover',spotlight);}
else
{services['ecmascript-debugger'].clearSpotlight(data_runtime_id);host_tabs.activeTab.removeEventListener('mouseover',spotlight);}
break;}
case 'find-with-click':{if(settings[settings_id].get(msg.key)){host_tabs.activeTab.addEventListener('click',clickHandlerHost);}
else
{host_tabs.activeTab.removeEventListener('click',clickHandlerHost);}
break;}
case 'update-on-dom-node-inserted':{if(settings[settings_id].get(msg.key)){host_tabs.activeTab.addEventListener('DOMNodeRemoved',domNodeRemovedHandler);}
else
{host_tabs.activeTab.removeEventListener('DOMNodeRemoved',domNodeRemovedHandler);}
break;}}}}}
var onShowView=function(msg){var msg_id=msg.id,id='',i=0;for(;(id=view_ids[i])&&id!=msg_id;i++);if(id){if(activeWindow.length){if(!data_runtime_id){data_runtime_id=activeWindow[0];}
if(settings[settings_id].get('find-with-click')){host_tabs.activeTab.addEventListener('click',clickHandlerHost);}
if(settings[settings_id].get('highlight-on-hover')){host_tabs.activeTab.addEventListener('mouseover',spotlight);}
if(settings[settings_id].get('update-on-dom-node-inserted')){host_tabs.activeTab.addEventListener('DOMNodeRemoved',domNodeRemovedHandler);}
if(!data.length){getInitialView(data_runtime_id);}}
else
{views[id].update();}}}
var onHideView=function(msg){var msg_id=msg.id,id='',i=0;for(;(id=view_ids[i])&&id!=msg_id;i++);if(id){host_tabs.activeTab.removeEventListener('click',clickHandlerHost);host_tabs.activeTab.removeEventListener('mouseover',spotlight);host_tabs.activeTab.removeEventListener('DOMNodeRemoved',domNodeRemovedHandler);}}
var onRuntimeStopped=function(msg){if(msg.id==data_runtime_id){data=[];mime="";data_runtime_id='';var id='',i=0;for(;id=view_ids[i];i++){views[id].clearAllContainers();}}}
var getInitialView=function(rt_id){var tag=tagManager.setCB(null,handleInitialView,[rt_id]);var script_data="return ( document.body || document.documentElement )";services['ecmascript-debugger'].eval(tag,rt_id,'','',script_data);}
this.getDOM=function(rt_id){if(!(rt_id==data_runtime_id&&data.length)&&runtime_onload_handler.check(rt_id,arguments)){getInitialView(rt_id);}}
this.getData=function(){return data;}
this.getDataRuntimeId=function(){return data_runtime_id;}
this.setActiveRuntime=function(rt_id){__next_rt_id=rt_id;}
var handleInitialView=function(xml,rt_id){if(xml.getNodeData('status')=='completed'){clickHandlerHost({'runtime-id':rt_id,'object-id':xml.getNodeData('object-id')})}
else
{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'handleInitialView failed in dom_data\n');}}
var handleGetChildren=function(xml,runtime_id,object_id){var json=xml.getNodeData('jsondata');if(json){var _data=eval('('+json+')'),i=0,view_id='';for(;data[i]&&data[i][ID]!=object_id;i+=1);if(data[i]){if(object_id==_data[0][ID]){Array.prototype.splice.apply(data,[i,1].concat(_data));}
else
{Array.prototype.splice.apply(data,[i+1,0].concat(_data));}
for(i=0;view_id=view_ids[i];i++){views[view_id].update();}}
else
{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'missing refrence');}}}
this.getChildernFromNode=function(object_id,traversal){var tag=tagManager.setCB(null,handleGetChildren,[data_runtime_id,object_id]);services['ecmascript-debugger'].inspectDOM(tag,object_id,traversal,'json');}
this.closeNode=function(object_id,do_not_update){var i=0,j=0,level=0,k=0,view_id='';for(;data[i]&&data[i][ID]!=object_id;i++);if(data[i]){level=data[i][DEPTH];i+=1;j=i;while(data[j]&&data[j][DEPTH]>level)j++;data.splice(i,j-i);if(!do_not_update){for(;view_id=view_ids[k];k++){views[view_id].update();}}}
else
{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'missing refrence');}}
this.getSnapshot=function(){var tag=tagManager.setCB(null,handleSnapshot,[data_runtime_id]);var script_data='return document.document';services['ecmascript-debugger'].eval(tag,data_runtime_id,'','',script_data);}
var handleSnapshot=function(xml,runtime_id){if(xml.getNodeData('status')=='completed'){var tag=tagManager.setCB(null,handleGetDOM,[runtime_id]);services['ecmascript-debugger'].inspectDOM(tag,xml.getNodeData('object-id'),'subtree','json');}
else
{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'handleSnapshot in dom_data has failed');}}
var spotlight=function(event){services['ecmascript-debugger'].spotlight(event['runtime-id'],event['object-id']);}
this.highlight_on_hover=function(event){if(event.target.checked){host_tabs.activeTab.addEventListener('mouseover',spotlight);}
else
{services['ecmascript-debugger'].clearSpotlight(data_runtime_id);host_tabs.activeTab.removeEventListener('mouseover',spotlight);}}
this.setCurrentTarget=function(obj_id){messages.post("element-selected",{obj_id:obj_id,rt_id:data_runtime_id});current_target=obj_id;}
this.getCurrentTarget=function(obj_id){return current_target;}
var get_element_name=function(data_entry,with_ids_and_classes){var
name=data_entry[NAME],attrs=data_entry[ATTRS],attr=null,i=0,id='',class_name='';if(settings.dom.get('force-lowercase')){name=name.toLowerCase();}
if(with_ids_and_classes){for(;attr=attrs[i];i++){if(attr[ATTR_KEY]=='id'){id="#"+attr[ATTR_VALUE];}
if(attr[ATTR_KEY]=='class'){class_name="."+attr[ATTR_VALUE].replace(/ /g,".");}}}
return name+id+class_name;}
var parse_parent_offset=function(chain){var
ret=false,cur=null;if(chain){cur=chain.pop();if(cur){ret=cur[1]=='1';}
else
{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+"failed in parse_parent_offset in dom_data");}}
return ret;}
this.getCSSPath=function(parent_offset_chain){var
i=0,j=-1,path='',show_siblings=settings.dom.get('show-siblings-in-breadcrumb'),show_id_and_classes=settings.dom.get('show-id_and_classes-in-breadcrumb');if(current_target){for(;data[i]&&data[i][ID]!=current_target;i++);if(data[i]){path=[{name:get_element_name(data[i],show_id_and_classes),id:data[i][ID],combinator:"",is_parent_offset:parse_parent_offset(parent_offset_chain)}];j=i;i--;for(;data[i];i--){if(data[i][TYPE]==1){if(data[i][DEPTH]<=data[j][DEPTH]){if(data[i][DEPTH]<data[j][DEPTH]){path.splice
(0,0,{name:get_element_name(data[i],show_id_and_classes),id:data[i][ID],combinator:">",is_parent_offset:parse_parent_offset(parent_offset_chain)});}
else if(show_siblings){path.splice
(0,0,{name:get_element_name(data[i],show_id_and_classes),id:data[i][ID],combinator:"+",is_parent_offset:false});}
j=i;}}}}
else
{current_target='';}
return path;}}
var postElementSeleceted=function(obj_id,rt_id){messages.post("element-selected",{obj_id:obj_id,rt_id:rt_id});}
this.set_click_handler=function(event){if(event.target.checked){host_tabs.activeTab.addEventListener('click',clickHandlerHost);}
else
{host_tabs.activeTab.removeEventListener('click',clickHandlerHost);}}
this.update=function(state){if(state.rt_id==data_runtime_id){var
entry=null,i=0,obj_id=state.obj_id,attrs=null,attr=null,j=0;for(;data[i]&&data[i][ID]!=obj_id;i++);if(data[i]){switch(state.type){case "key":case "value":{if(state.key){attrs=data[i][ATTRS];for(;(attr=attrs[j])&&attr[ATTR_KEY]!=state.key;j++);attr||(attr=attrs[j]=["",state.key,""]);if(state.value){attr[ATTR_VALUE]=state.value;}
else
{attrs.splice(j,1);}}
break;}
case "text":{data[i][VALUE]=state.text;break;}}}}}
this.getParentElement=function(obj_id){var
i=0,depth=0;for(;data[i]&&data[i][ID]!=obj_id;i++);if(data[i]){depth=data[i][DEPTH];for(;data[i]&&!((data[i][TYPE]==1||data[i][TYPE]==9)&&data[i][DEPTH]<depth);i--);return data[i]&&data[i][ID]||'';}}
messages.addListener('active-tab',onActiveTab);messages.addListener('show-view',onShowView);messages.addListener('hide-view',onHideView);messages.addListener('setting-changed',onSettingChange);messages.addListener('runtime-stopped',onRuntimeStopped);messages.addListener('runtime-destroyed',onRuntimeStopped);messages.addListener('reset-state',onResetState);};css_initial_values={"-apple-dashboard-region":"","-o-background-size":"","-o-link":"","-o-link-source":"","-o-table-baseline":"","-o-text-overflow":"","-wap-accesskey":"","-wap-input-format":"","-wap-input-required":"","-wap-marquee-dir":"","-wap-marquee-loop":"","-wap-marquee-speed":"","-wap-marquee-style":"","-xv-interpret-as":"","-xv-phonemes":"","-xv-voice-balance":"","-xv-voice-duration":"","-xv-voice-pitch":"","-xv-voice-pitch-range":"","-xv-voice-rate":"","-xv-voice-stress":"","-xv-voice-volume":"","alignment-baseline":"","audio-level":"","background":"transparent none repeat scroll 0px 0px","background-attachment":"scroll","background-color":"transparent","background-image":"none","background-position":"0px 0px","background-repeat":"repeat","baseline-shift":"","border":"0px #000000","border-bottom":"0px #000000","border-bottom-color":"#000000","border-bottom-style":"none","border-bottom-width":"0px","border-collapse":"separate","border-color":"#000000","border-left":"0px #000000","border-left-color":"#000000","border-left-style":"none","border-left-width":"0px","border-right":"0px #000000","border-right-color":"#000000","border-right-style":"none","border-right-width":"0px","border-spacing":"0px","border-style":"none","border-top":"0px #000000","border-top-color":"#000000","border-top-style":"none","border-top-width":"0px","border-width":"0px","bottom":"auto","box-sizing":"","caption-side":"top","cell-spacing":"","clear":"none","clip":"rect(0px, 0px, 0px, 0px)","clip-path":"","clip-rule":"","color":"#000000","color-interpolation":"","color-interpolation-filters":"","color-profile":"","color-rendering":"","column-span":"","content":"none","counter-increment":"none","counter-reset":"none","cue":"","cue-after":"","cue-before":"","cursor":"default","direction":"ltr","display":"inline","display-align":"","dominant-baseline":"","empty-cells":"show","enable-background":"","fill":"#000000","fill-opacity":"","fill-rule":"","filter":"","float":"none","flood-color":"","flood-opacity":"","font":"shorthand","font-family":"Times New Roman","font-size":"16px","font-size-adjust":"none","font-stretch":"normal","font-style":"normal","font-variant":"normal","font-weight":"400","glyph-orientation-horizontal":"","glyph-orientation-vertical":"","height":"auto","image-rendering":"","kerning":"","left":"auto","letter-spacing":"0px","lighting-color":"","line-height":"normal","line-increment":"","list-style":"disc outside none","list-style-image":"none","list-style-position":"outside","list-style-type":"disc","margin":"0px","margin-bottom":"0px","margin-left":"0px","margin-right":"0px","margin-top":"0px","mark":"","mark-after":"","mark-before":"","marker":"","marker-end":"","marker-mid":"","marker-offset":"","marker-start":"","marks":"none","mask":"none","max-height":"-1px","max-width":"-1px","min-height":"0px","min-width":"0px","nav-down":"","nav-index":"","nav-left":"","nav-right":"","nav-up":"","opacity":"1","orphans":"2","outline":"3px","outline-color":"invert","outline-offset":"","outline-style":"none","outline-width":"3px","overflow":"visible","overflow-x":"visible","overflow-y":"visible","padding":"0px","padding-bottom":"0px","padding-left":"0px","padding-right":"0px","padding-top":"0px","page":"auto","page-break-after":"auto","page-break-before":"auto","page-break-inside":"auto","pause":"","pause-after":"","pause-before":"","pointer-events":"","position":"static","quotes":"none","rest":"","rest-after":"","rest-before":"","right":"auto","row-span":"","scrollbar-3dlight-color":"","scrollbar-arrow-color":"","scrollbar-base-color":"","scrollbar-darkshadow-color":"","scrollbar-face-color":"","scrollbar-highlight-color":"","scrollbar-shadow-color":"","scrollbar-track-color":"","shape-rendering":"","size":"portrait","solid-color":"","solid-opacity":"","speak":"","stop-color":"","stop-opacity":"","stroke":"","stroke-dasharray":"","stroke-dashoffset":"","stroke-linecap":"","stroke-linejoin":"","stroke-miterlimit":"","stroke-opacity":"","stroke-width":"","table-layout":"auto","text-align":"left","text-anchor":"","text-decoration":"none","text-indent":"0px","text-rendering":"","text-shadow":"","text-transform":"none","top":"auto","unicode-bidi":"normal","vector-effect":"","vertical-align":"baseline","viewport-fill":"","viewport-fill-opacity":"","visibility":"visible","voice-family":"","white-space":"normal","widows":"2","width":"auto","word-spacing":"0px","writing-mode":"","z-index":"auto"}
css_inheritable_properties={"-xv-voice-balance":1,"-xv-voice-pitch":1,"-xv-voice-pitch-range":1,"-xv-voice-rate":1,"-xv-voice-stress":1,"-xv-voice-volume":1,"alignment-baseline":1,"border-collapse":1,"border-spacing":1,"box-sizing":1,"caption-side":1,"cell-spacing":1,"color":1,"color-interpolation":1,"color-interpolation-filters":1,"color-rendering":1,"cursor":1,"direction":1,"display-align":1,"empty-cells":1,"font":1,"font-family":1,"font-size":1,"font-stretch":1,"font-style":1,"font-variant":1,"font-weight":1,"image-rendering":1,"letter-spacing":1,"line-height":1,"line-increment":1,"list-style":1,"list-style-image":1,"list-style-position":1,"list-style-type":1,"marker":1,"orphans":1,"overflow":1,"page":1,"page-break-inside":1,"pointer-events":1,"quotes":1,"scrollbar-3dlight-color":1,"scrollbar-arrow-color":1,"scrollbar-base-color":1,"scrollbar-darkshadow-color":1,"scrollbar-face-color":1,"scrollbar-highlight-color":1,"scrollbar-shadow-color":1,"scrollbar-track-color":1,"shape-rendering":1,"size":1,"speak":1,"stroke-linecap":1,"stroke-linejoin":1,"text-align":1,"text-anchor":1,"text-indent":1,"text-rendering":1,"text-shadow":1,"text-transform":1,"unicode-bidi":1,"visibility":1,"voice-family":1,"white-space":1,"widows":1,"word-spacing":1,"writing-mode":1}
window.js_object_filters||(window.js_object_filters={})
window.dom_interfaces||(window.dom_interfaces={})
dom_interfaces.NodeList=function(){this.item="object";this.length="0";this.namedItem="object";this.tags="object";}
js_object_filters.NodeList=new dom_interfaces.NodeList();dom_interfaces.Window=function(){this.Array="object";this.Attr="object";this.Audio="object";this.Boolean="object";this.ByteArray="object";this.CDATASection="object";this.CSSMediaRule="object";this.CSSPrimitiveValue="object";this.CSSRule="object";this.CSSRuleList="object";this.CSSStyleDeclaration="object";this.CSSStyleSheet="object";this.CanvasGradient="object";this.CanvasPattern="object";this.CanvasRenderingContext2D="object";this.CanvasRenderingContext2DGame="object";this.CanvasRenderingContext3D="undefined";this.ClientRect="object";this.ClientRectList="object";this.Comment="object";this.DOMError="object";this.DOMException="object";this.DOMImplementationLS="object";this.DOMParser="object";this.Date="object";this.Document="object";this.DocumentFragment="object";this.DocumentType="object";this.Element="object";this.Entity="object";this.EntityReference="object";this.Error="object";this.EvalError="object";this.Event="object";this.Function="object";this.HTMLAnchorElement="object";this.HTMLAppletElement="object";this.HTMLAreaElement="object";this.HTMLBRElement="object";this.HTMLBaseElement="object";this.HTMLBaseFontElement="object";this.HTMLBodyElement="object";this.HTMLButtonElement="object";this.HTMLCanvasElement="object";this.HTMLCollection="object";this.HTMLDListElement="object";this.HTMLDataListElement="object";this.HTMLDirectoryElement="object";this.HTMLDivElement="object";this.HTMLDocument="object";this.HTMLElement="object";this.HTMLEmbedElement="object";this.HTMLFieldSetElement="object";this.HTMLFontElement="object";this.HTMLFormElement="object";this.HTMLFrameElement="object";this.HTMLFrameSetElement="object";this.HTMLHRElement="object";this.HTMLHeadElement="object";this.HTMLHeadingElement="object";this.HTMLHtmlElement="object";this.HTMLIFrameElement="object";this.HTMLImageElement="object";this.HTMLInputElement="object";this.HTMLIsIndexElement="object";this.HTMLLIElement="object";this.HTMLLabelElement="object";this.HTMLLegendElement="object";this.HTMLLinkElement="object";this.HTMLMapElement="object";this.HTMLMarqueeElement="object";this.HTMLMenuElement="object";this.HTMLMetaElement="object";this.HTMLModElement="object";this.HTMLOListElement="object";this.HTMLObjectElement="object";this.HTMLOptGroupElement="object";this.HTMLOptionElement="object";this.HTMLOptionsCollection="object";this.HTMLOutputElement="object";this.HTMLParagraphElement="object";this.HTMLParamElement="object";this.HTMLPreElement="object";this.HTMLQuoteElement="object";this.HTMLScriptElement="object";this.HTMLSelectElement="object";this.HTMLStyleElement="object";this.HTMLTableCaptionElement="object";this.HTMLTableCellElement="object";this.HTMLTableColElement="object";this.HTMLTableElement="object";this.HTMLTableRowElement="object";this.HTMLTableSectionElement="object";this.HTMLTextAreaElement="object";this.HTMLTitleElement="object";this.HTMLUListElement="object";this.HTMLUnknownElement="object";this.Image="object";this.ImageData="object";this.Infinity="Infinity";this.LSException="object";this.LSParser="object";this.LSParserFilter="object";this.Math="object";this.MediaList="object";this.MemoryError="object";this.MutationEvent="object";this.NaN="NaN";this.NamedNodeMap="object";this.Node="object";this.NodeFilter="object";this.NodeList="object";this.Notation="object";this.Number="object";this.Object="object";this.Option="object";this.Packages="object";this.ProcessingInstruction="object";this.RGBColor="object";this.Range="object";this.RangeError="object";this.RangeException="object";this.ReferenceError="object";this.RegExp="object";this.RepetitionElement="object";this.RepetitionEvent="object";this.SVGAElement="object";this.SVGAngle="object";this.SVGAnimateColorElement="object";this.SVGAnimateElement="object";this.SVGAnimateMotionElement="object";this.SVGAnimateTransformElement="object";this.SVGAnimationElement="object";this.SVGAudioElement="object";this.SVGCircleElement="object";this.SVGClipPathElement="object";this.SVGDefsElement="object";this.SVGDescElement="object";this.SVGDocument="object";this.SVGEllipseElement="object";this.SVGException="object";this.SVGFEBlendElement="object";this.SVGFEColorMatrixElement="object";this.SVGFEComponentTransferElement="object";this.SVGFECompositeElement="object";this.SVGFEConvolveMatrixElement="object";this.SVGFEDiffuseLightingElement="object";this.SVGFEDisplacementMapElement="object";this.SVGFEDistantLightElement="object";this.SVGFEFloodElement="object";this.SVGFEFuncAElement="object";this.SVGFEFuncBElement="object";this.SVGFEFuncGElement="object";this.SVGFEFuncRElement="object";this.SVGFEGaussianBlurElement="object";this.SVGFEImageElement="object";this.SVGFEMergeElement="object";this.SVGFEMergeNodeElement="object";this.SVGFEMorphologyElement="object";this.SVGFEOffsetElement="object";this.SVGFEPointLightElement="object";this.SVGFESpecularLightingElement="object";this.SVGFESpotLightElement="object";this.SVGFETileElement="object";this.SVGFETurbulenceElement="object";this.SVGFilterElement="object";this.SVGFontElement="object";this.SVGForeignObjectElement="object";this.SVGGElement="object";this.SVGGlyphElement="object";this.SVGImageElement="object";this.SVGLength="object";this.SVGLineElement="object";this.SVGLinearGradientElement="object";this.SVGMPathElement="object";this.SVGMarkerElement="object";this.SVGMaskElement="object";this.SVGMatrix="object";this.SVGMissingGlyphElement="object";this.SVGNumber="object";this.SVGPaint="object";this.SVGPath="object";this.SVGPathElement="object";this.SVGPathSeg="object";this.SVGPatternElement="object";this.SVGPoint="object";this.SVGPolygonElement="object";this.SVGPolylineElement="object";this.SVGPreserveAspectRatio="object";this.SVGRGBColor="object";this.SVGRadialGradientElement="object";this.SVGRect="object";this.SVGRectElement="object";this.SVGSVGElement="object";this.SVGScriptElement="object";this.SVGSetElement="object";this.SVGStopElement="object";this.SVGStyleElement="object";this.SVGSwitchElement="object";this.SVGSymbolElement="object";this.SVGTRefElement="object";this.SVGTSpanElement="object";this.SVGTextAreaElement="object";this.SVGTextContentElement="object";this.SVGTextElement="object";this.SVGTextPathElement="object";this.SVGTitleElement="object";this.SVGTransform="object";this.SVGUnitTypes="object";this.SVGUseElement="object";this.SVGVideoElement="object";this.SVGViewElement="object";this.SVGZoomAndPan="object";this.String="object";this.StyleSheetList="object";this.SyntaxError="object";this.Text="object";this.TypeError="object";this.URIError="object";this.VXMLAudioRecording="object";this.XMLDocument="object";this.XMLHttpRequest="object";this.XMLSerializer="object";this.XPathEvaluator="object";this.XPathException="object";this.XPathExpression="object";this.XPathNSResolver="object";this.XPathNamespace="object";this.XPathResult="object";this.XSLTProcessor="object";this.__Opera_Internal_OHVBS="object";this.addEventListener="object";this.addEventStream="object";this.alert="object";this.attachEvent="object";this.back="object";this.captureEvents="object";this.clearInterval="object";this.clearTimeout="object";this.closed="false";this.confirm="object";this.decodeURI="object";this.decodeURIComponent="object";this.defaultStatus="";this.detachEvent="object";this.dispatchEvent="object";this.document="object";this.encodeURI="object";this.encodeURIComponent="object";this.escape="object";this.eval="object";this.event="object";this.forward="object";this.frameElement="null";this.frames="object";this.getComputedStyle="object";this.getSelection="object";this.history="object";this.innerHeight="730";this.innerWidth="1056";this.isFinite="object";this.isNaN="object";this.java="object";this.length="0";this.location="object";this.name="";this.navigate="object";this.navigator="object";this.netscape="object";this.open="object";this.opener="null";this.opera="object";this.outerHeight="793";this.outerWidth="1065";this.pageXOffset="0";this.pageYOffset="0";this.parent="object";this.parseFloat="object";this.parseInt="object";this.print="object";this.prompt="object";this.releaseEvents="object";this.removeEventListener="object";this.removeEventStream="object";this.screen="object";this.screenLeft="1386";this.screenTop="217";this.screenX="-4";this.screenY="-23";this.self="object";this.setDocument="undefined";this.setInterval="object";this.setTimeout="object";this.status="";this.stop="object";this.sun="object";this.top="object";this.undefined="undefined";this.unescape="object";this.window="object";}
js_object_filters.Window=new dom_interfaces.Window();dom_interfaces.Node=function(){this.ATTRIBUTE_NODE="2";this.CDATA_SECTION_NODE="4";this.COMMENT_NODE="8";this.DOCUMENT_FRAGMENT_NODE="11";this.DOCUMENT_NODE="9";this.DOCUMENT_POSITION_CONTAINED_BY="16";this.DOCUMENT_POSITION_CONTAINS="8";this.DOCUMENT_POSITION_DISCONNECTED="1";this.DOCUMENT_POSITION_FOLLOWING="4";this.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC="32";this.DOCUMENT_POSITION_PRECEDING="2";this.DOCUMENT_TYPE_NODE="10";this.ELEMENT_NODE="1";this.ENTITY_NODE="6";this.ENTITY_REFERENCE_NODE="5";this.NOTATION_NODE="12";this.PROCESSING_INSTRUCTION_NODE="7";this.TEXT_NODE="3";this.addEventListener="object";this.addEventSource="object";this.appendChild="object";this.attachEvent="object";this.attributes="null";this.childNodes="object";this.cloneNode="object";this.compareDocumentPosition="object";this.detachEvent="object";this.dispatchEvent="object";this.document="object";this.firstChild="null";this.getFeature="object";this.hasAttributes="object";this.hasChildNodes="object";this.insertBefore="object";this.isDefaultNamespace="object";this.isSameNode="object";this.isSupported="object";this.lastChild="null";this.localName="null";this.lookupNamespaceURI="object";this.lookupPrefix="object";this.namespaceURI="null";this.nextSibling="null";this.nodeName="";this.nodeType="";this.nodeValue="null";this.normalize="object";this.ownerDocument="null";this.parentNode="null";this.prefix="null";this.previousSibling="null";this.removeChild="object";this.removeEventListener="object";this.removeEventSource="object";this.replaceChild="object";this.selectNodes="object";this.selectSingleNode="object";this.textContent="null";}
js_object_filters.Node=new dom_interfaces.Node();dom_interfaces.NamedNodeMap=function(){this.getNamedItem="object";this.getNamedItemNS="object";this.item="object";this.length="0";this.removeNamedItem="object";this.removeNamedItemNS="object";this.setNamedItem="object";this.setNamedItemNS="object";}
js_object_filters.NamedNodeMap=new dom_interfaces.NamedNodeMap();dom_interfaces.Event=function(){this.bubbles="false";this.cancelBubble="false";this.cancelable="false";this.currentTarget="null";this.eventPhase="1";this.initEvent="object";this.preventDefault="object";this.srcElement="null";this.stopPropagation="object";this.target="null";this.timeStamp="0";this.type="";}
js_object_filters.Event=new dom_interfaces.Event();dom_interfaces.Document=function(){this.adoptNode="object";this.characterSet="windows-1252";this.charset="windows-1252";this.cookie="";this.createAttribute="object";this.createAttributeNS="object";this.createCDATASection="object";this.createComment="object";this.createDocumentFragment="object";this.createElement="object";this.createElementNS="object";this.createEvent="object";this.createExpression="object";this.createNSResolver="object";this.createNodeIterator="object";this.createProcessingInstruction="object";this.createRange="object";this.createTextNode="object";this.createTreeWalker="object";this.defaultView="null";this.designMode="off";this.doctype="null";this.documentElement="object";this.documentURI="null";this.evaluate="object";this.execCommand="object";this.firstChild="object";this.getElementById="object";this.getElementsByClassName="object";this.getElementsByTagName="object";this.getElementsByTagNameNS="object";this.implementation="object";this.importNode="object";this.lastChild="object";this.lastModified="January 1, 1970 GMT";this.location="null";this.nodeName="#document";this.nodeType="9";this.parentWindow="null";this.queryCommandEnabled="object";this.queryCommandState="object";this.queryCommandSupported="object";this.queryCommandValue="object";this.querySelector="object";this.querySelectorAll="object";this.readyState="complete";this.referrer="";this.styleSheets="object";}
dom_interfaces.Document.prototype=js_object_filters.Node;js_object_filters.Document=new dom_interfaces.Document();dom_interfaces.CharacterData=function(){this.appendData="object";this.data="";this.deleteData="object";this.insertData="object";this.length="0";this.nodeValue="";this.ownerDocument="object";this.replaceData="object";this.substringData="object";this.textContent="";}
dom_interfaces.CharacterData.prototype=js_object_filters.Node;js_object_filters.CharacterData=new dom_interfaces.CharacterData();dom_interfaces.Attr=function(){this.name="foo";this.nodeName="foo";this.nodeType="2";this.nodeValue="";this.ownerDocument="object";this.ownerElement="null";this.specified="true";this.text="";this.textContent="";this.value="";}
dom_interfaces.Attr.prototype=js_object_filters.Node;js_object_filters.Attr=new dom_interfaces.Attr();dom_interfaces.DocumentFragment=function(){this.nodeName="#document-fragment";this.nodeType="11";this.ownerDocument="object";this.querySelector="object";this.querySelectorAll="object";this.textContent="";}
dom_interfaces.DocumentFragment.prototype=js_object_filters.Node;js_object_filters.DocumentFragment=new dom_interfaces.DocumentFragment();dom_interfaces.Element=function(){this.addRepetitionBlock="object";this.addRepetitionBlockByIndex="object";this.all="object";this.attributes="object";this.blur="object";this.childElementCount="0";this.children="object";this.className="";this.clientHeight="0";this.clientLeft="0";this.clientTop="0";this.clientWidth="0";this.contains="object";this.contentEditable="false";this.currentStyle="object";this.dir="";this.firstElementChild="null";this.focus="object";this.getAttribute="object";this.getAttributeNS="object";this.getAttributeNode="object";this.getAttributeNodeNS="object";this.getBoundingClientRect="object";this.getClientRects="object";this.getElementsByClassName="object";this.getElementsByTagName="object";this.getElementsByTagNameNS="object";this.hasAttribute="object";this.hasAttributeNS="object";this.id="";this.innerHTML="";this.innerText="";this.insertAdjacentElement="object";this.insertAdjacentHTML="object";this.insertAdjacentText="object";this.isContentEditable="false";this.lang="";this.lastElementChild="null";this.localName="";this.moveRepetitionBlock="object";this.nextElementSibling="null";this.nodeType="1";this.offsetHeight="0";this.offsetLeft="0";this.offsetParent="null";this.offsetTop="0";this.offsetWidth="0";this.onblur="null";this.onclick="null";this.ondblclick="null";this.onfocus="null";this.onkeydown="null";this.onkeypress="null";this.onkeyup="null";this.onload="null";this.onmousedown="null";this.onmousemove="null";this.onmouseout="null";this.onmouseover="null";this.onmouseup="null";this.onunload="null";this.outerHTML="";this.outerText="";this.ownerDocument="object";this.parentElement="null";this.previousElementSibling="null";this.querySelector="object";this.querySelectorAll="object";this.removeAttribute="object";this.removeAttributeNS="object";this.removeAttributeNode="object";this.removeNode="object";this.removeRepetitionBlock="object";this.repeatMax="";this.repeatMin="";this.repeatStart="";this.repetitionBlocks="null";this.repetitionIndex="0";this.repetitionTemplate="null";this.repetitionType="0";this.scrollHeight="0";this.scrollIntoView="object";this.scrollLeft="0";this.scrollTop="0";this.scrollWidth="0";this.setAttribute="object";this.setAttributeNS="object";this.setAttributeNode="object";this.setAttributeNodeNS="object";this.sourceIndex="-1";this.style="object";this.tabIndex="-1";this.tagName="";this.textContent="";this.title="";this.toString="object";this.unselectable="";}
dom_interfaces.Element.prototype=js_object_filters.Node;js_object_filters.Element=new dom_interfaces.Element();dom_interfaces.XMLDocument=function(){this.async="true";this.load="object";}
dom_interfaces.XMLDocument.prototype=js_object_filters.Document;js_object_filters.XMLDocument=new dom_interfaces.XMLDocument();dom_interfaces.HTMLDocument=function(){this.URL="http://localhost:8881/html-document";this.activeElement="object";this.alinkColor="";this.all="[object HTMLCollection]";this.anchors="object";this.applets="object";this.bgColor="";this.body="object";this.captureEvents="object";this.clear="object";this.close="object";this.compatMode="CSS1Compat";this.dir="";this.domain="localhost";this.elementFromPoint="object";this.embeds="object";this.fgColor="";this.forms="object";this.frames="object";this.getElementsByName="object";this.getSelection="object";this.images="object";this.linkColor="";this.links="object";this.moveFocusDown="object";this.moveFocusLeft="object";this.moveFocusRight="object";this.moveFocusUp="object";this.onload="null";this.onunload="null";this.open="object";this.plugins="object";this.releaseEvents="object";this.scripts="object";this.selection="object";this.title="";this.vlinkColor="";this.write="object";this.writeln="object";}
dom_interfaces.HTMLDocument.prototype=js_object_filters.Document;js_object_filters.HTMLDocument=new dom_interfaces.HTMLDocument();dom_interfaces.HTMLElement=function(){}
dom_interfaces.HTMLElement.prototype=js_object_filters.Element;js_object_filters.HTMLElement=new dom_interfaces.HTMLElement();dom_interfaces.Comment=function(){this.nodeName="#comment";this.nodeType="8";}
dom_interfaces.Comment.prototype=js_object_filters.CharacterData;js_object_filters.Comment=new dom_interfaces.Comment();dom_interfaces.Text=function(){this.nodeName="#cdata-section";this.nodeType="4";this.replaceWholeText="object";this.splitText="object";this.wholeText="";}
dom_interfaces.Text.prototype=js_object_filters.CharacterData;js_object_filters.Text=new dom_interfaces.Text();dom_interfaces.HTMLBRElement=function(){this.clear="";this.localName="BR";this.nodeName="BR";this.outerHTML="<BR>";this.outerText="%0A";this.tagName="BR";this.text="";}
dom_interfaces.HTMLBRElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLBRElement=new dom_interfaces.HTMLBRElement();dom_interfaces.HTMLOListElement=function(){this.compact="false";this.localName="OL";this.nodeName="OL";this.outerHTML="<OL></OL>";this.start="1";this.tagName="OL";this.text="";this.type="";}
dom_interfaces.HTMLOListElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLOListElement=new dom_interfaces.HTMLOListElement();dom_interfaces.HTMLFontElement=function(){this.color="";this.face="";this.localName="FONT";this.nodeName="FONT";this.outerHTML="<FONT></FONT>";this.size="";this.tagName="FONT";this.text="";}
dom_interfaces.HTMLFontElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLFontElement=new dom_interfaces.HTMLFontElement();dom_interfaces.HTMLMapElement=function(){this.areas="object";this.localName="MAP";this.name="";this.nodeName="MAP";this.outerHTML="<MAP></MAP>";this.tagName="MAP";this.text="";}
dom_interfaces.HTMLMapElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLMapElement=new dom_interfaces.HTMLMapElement();dom_interfaces.HTMLButtonElement=function(){this.accessKey="";this.action="";this.autofocus="false";this.checkValidity="object";this.click="object";this.disabled="false";this.dispatchChange="object";this.dispatchFormChange="object";this.enctype="";this.form="null";this.forms="object";this.htmlTemplate="null";this.labels="object";this.localName="BUTTON";this.method="";this.name="";this.nodeName="BUTTON";this.onchange="null";this.onformchange="null";this.onforminput="null";this.oninput="null";this.onreset="null";this.onselect="null";this.onsubmit="null";this.outerHTML="<BUTTON></BUTTON>";this.replace="";this.selectionEnd="0";this.selectionStart="0";this.setCustomValidity="object";this.tabIndex="0";this.tagName="BUTTON";this.target="";this.template="null";this.text="";this.textLength="0";this.type="submit";this.validationMessage="";this.validity="object";this.value="";this.willValidate="false";}
dom_interfaces.HTMLButtonElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLButtonElement=new dom_interfaces.HTMLButtonElement();dom_interfaces.HTMLFrameSetElement=function(){this.cols="";this.localName="FRAMESET";this.nodeName="FRAMESET";this.outerHTML="<FRAMESET></FRAMESET>";this.rows="";this.tagName="FRAMESET";this.text="";}
dom_interfaces.HTMLFrameSetElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLFrameSetElement=new dom_interfaces.HTMLFrameSetElement();dom_interfaces.HTMLOptGroupElement=function(){this.disabled="false";this.label="";this.localName="OPTGROUP";this.nodeName="OPTGROUP";this.outerHTML="<OPTGROUP></OPTGROUP>";this.tagName="OPTGROUP";this.text="";}
dom_interfaces.HTMLOptGroupElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLOptGroupElement=new dom_interfaces.HTMLOptGroupElement();dom_interfaces.HTMLLinkElement=function(){this.charset="";this.disabled="false";this.href="";this.hreflang="";this.localName="LINK";this.media="";this.nodeName="LINK";this.outerHTML="<LINK>";this.rel="";this.rev="";this.tagName="LINK";this.target="";this.text="";this.type="";}
dom_interfaces.HTMLLinkElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLLinkElement=new dom_interfaces.HTMLLinkElement();dom_interfaces.HTMLObjectElement=function(){this.align="";this.archive="";this.border="";this.classId="";this.code="";this.codeBase="";this.codeType="";this.contentDocument="null";this.contentWindow="null";this.data="";this.declare="false";this.form="null";this.getSVGDocument="object";this.height="";this.hspace="0";this.localName="OBJECT";this.name="";this.nodeName="OBJECT";this.outerHTML="<OBJECT></OBJECT>";this.standby="";this.tagName="OBJECT";this.text="";this.type="";this.useMap="";this.vspace="0";this.width="";}
dom_interfaces.HTMLObjectElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLObjectElement=new dom_interfaces.HTMLObjectElement();dom_interfaces.HTMLTableSectionElement=function(){this.align="";this.ch="";this.chOff="";this.deleteRow="object";this.insertRow="object";this.localName="TBODY";this.nodeName="TBODY";this.outerHTML="<TBODY></TBODY>";this.rows="object";this.tagName="TBODY";this.text="";this.vAlign="";}
dom_interfaces.HTMLTableSectionElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLTableSectionElement=new dom_interfaces.HTMLTableSectionElement();dom_interfaces.CDATASection=function(){}
dom_interfaces.CDATASection.prototype=js_object_filters.Text;js_object_filters.CDATASection=new dom_interfaces.CDATASection();dom_interfaces.HTMLFrameElement=function(){this.contentDocument="null";this.contentWindow="null";this.frameBorder="";this.getSVGDocument="object";this.localName="FRAME";this.location="null";this.longDesc="";this.marginHeight="";this.marginWidth="";this.name="";this.noResize="false";this.nodeName="FRAME";this.outerHTML="<FRAME>";this.scrolling="";this.src="";this.tagName="FRAME";this.text="";}
dom_interfaces.HTMLFrameElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLFrameElement=new dom_interfaces.HTMLFrameElement();dom_interfaces.HTMLTableCaptionElement=function(){this.align="";this.localName="CAPTION";this.nodeName="CAPTION";this.outerHTML="<CAPTION></CAPTION>";this.tagName="CAPTION";this.text="";}
dom_interfaces.HTMLTableCaptionElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLTableCaptionElement=new dom_interfaces.HTMLTableCaptionElement();dom_interfaces.HTMLBaseFontElement=function(){this.color="";this.face="";this.localName="BASEFONT";this.nodeName="BASEFONT";this.outerHTML="<BASEFONT>";this.size="";this.tagName="BASEFONT";this.text="";}
dom_interfaces.HTMLBaseFontElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLBaseFontElement=new dom_interfaces.HTMLBaseFontElement();dom_interfaces.HTMLDListElement=function(){this.compact="false";this.localName="DL";this.nodeName="DL";this.outerHTML="<DL></DL>";this.tagName="DL";this.text="";}
dom_interfaces.HTMLDListElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLDListElement=new dom_interfaces.HTMLDListElement();dom_interfaces.HTMLBodyElement=function(){this.aLink="";this.background="";this.bgColor="";this.leftMargin="0";this.link="";this.localName="BODY";this.nodeName="BODY";this.outerHTML="<BODY></BODY>";this.tagName="BODY";this.text="";this.topMargin="0";this.vLink="";}
dom_interfaces.HTMLBodyElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLBodyElement=new dom_interfaces.HTMLBodyElement();dom_interfaces.HTMLTableRowElement=function(){this.align="";this.bgColor="";this.cells="object";this.ch="";this.chOff="";this.deleteCell="object";this.height="";this.insertCell="object";this.localName="TR";this.nodeName="TR";this.outerHTML="<TR></TR>";this.rowIndex="-1";this.sectionRowIndex="-1";this.tagName="TR";this.text="";this.vAlign="";this.width="";}
dom_interfaces.HTMLTableRowElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLTableRowElement=new dom_interfaces.HTMLTableRowElement();dom_interfaces.HTMLTextAreaElement=function(){this.accept="";this.accessKey="";this.autofocus="false";this.checkValidity="object";this.cols="0";this.createTextRange="object";this.defaultValue="";this.disabled="false";this.dispatchChange="object";this.dispatchFormChange="object";this.form="null";this.forms="object";this.inputmode="";this.labels="object";this.localName="TEXTAREA";this.maxLength="0";this.name="";this.nodeName="TEXTAREA";this.onchange="null";this.onformchange="null";this.onforminput="null";this.oninput="null";this.onreset="null";this.onselect="null";this.onsubmit="null";this.outerHTML="<TEXTAREA></TEXTAREA>";this.pattern="";this.readOnly="false";this.required="false";this.rows="0";this.select="object";this.selectionEnd="0";this.selectionStart="0";this.setCustomValidity="object";this.setSelectionRange="object";this.tabIndex="0";this.tagName="TEXTAREA";this.template="null";this.text="";this.textLength="0";this.type="textarea";this.validationMessage="";this.validity="object";this.value="";this.willValidate="false";this.wrap="";}
dom_interfaces.HTMLTextAreaElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLTextAreaElement=new dom_interfaces.HTMLTextAreaElement();dom_interfaces.HTMLInputElement=function(){this.accept="";this.accessKey="";this.action="";this.align="";this.alt="";this.autocomplete="";this.autofocus="false";this.checkValidity="object";this.checked="false";this.click="object";this.createTextRange="object";this.defaultChecked="false";this.defaultValue="";this.disabled="false";this.dispatchChange="object";this.dispatchFormChange="object";this.enctype="";this.form="null";this.forms="object";this.htmlTemplate="null";this.inputmode="";this.labels="object";this.list="null";this.localName="INPUT";this.max="";this.maxLength="-1";this.method="";this.min="";this.name="";this.nodeName="INPUT";this.onchange="null";this.onformchange="null";this.onforminput="null";this.oninput="null";this.onreset="null";this.onselect="null";this.onsubmit="null";this.outerHTML="<INPUT>";this.pattern="";this.readOnly="false";this.replace="";this.required="false";this.select="object";this.selectedOption="null";this.selectionEnd="0";this.selectionStart="0";this.setCustomValidity="object";this.setSelectionRange="object";this.size="0";this.src="";this.step="";this.stepDown="object";this.stepUp="object";this.tabIndex="0";this.tagName="INPUT";this.target="";this.template="null";this.text="";this.textLength="0";this.type="text";this.useMap="";this.validationMessage="";this.validity="object";this.value="";this.valueAsDate="null";this.valueAsNumber="NaN";this.willValidate="false";}
dom_interfaces.HTMLInputElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLInputElement=new dom_interfaces.HTMLInputElement();dom_interfaces.HTMLIsIndexElement=function(){this.form="null";this.forms="object";this.labels="object";this.localName="ISINDEX";this.nodeName="ISINDEX";this.outerHTML="<ISINDEX>";this.prompt="";this.tagName="ISINDEX";this.template="null";this.text="";this.validationMessage="";this.validity="object";this.willValidate="false";}
dom_interfaces.HTMLIsIndexElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLIsIndexElement=new dom_interfaces.HTMLIsIndexElement();dom_interfaces.HTMLDivElement=function(){this.align="";this.localName="DIV";this.nodeName="DIV";this.outerHTML="<DIV></DIV>";this.tagName="DIV";this.text="";}
dom_interfaces.HTMLDivElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLDivElement=new dom_interfaces.HTMLDivElement();dom_interfaces.HTMLFieldSetElement=function(){this.checkValidity="object";this.disabled="false";this.elements="object";this.form="null";this.forms="object";this.labels="object";this.localName="FIELDSET";this.nodeName="FIELDSET";this.outerHTML="<FIELDSET></FIELDSET>";this.setCustomValidity="object";this.tagName="FIELDSET";this.template="null";this.text="";this.validationMessage="";this.validity="object";this.willValidate="false";}
dom_interfaces.HTMLFieldSetElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLFieldSetElement=new dom_interfaces.HTMLFieldSetElement();dom_interfaces.HTMLScriptElement=function(){this.charset="";this.defer="false";this.localName="SCRIPT";this.nodeName="SCRIPT";this.outerHTML="<SCRIPT></SCRIPT>";this.readyState="loaded";this.src="";this.tagName="SCRIPT";this.text="";this.type="";}
dom_interfaces.HTMLScriptElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLScriptElement=new dom_interfaces.HTMLScriptElement();dom_interfaces.HTMLStyleElement=function(){this.disabled="false";this.localName="STYLE";this.media="";this.nodeName="STYLE";this.outerHTML="<STYLE></STYLE>";this.sheet="object";this.tagName="STYLE";this.text="";this.type="";}
dom_interfaces.HTMLStyleElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLStyleElement=new dom_interfaces.HTMLStyleElement();dom_interfaces.HTMLUnknownElement=function(){this.localName="foo";this.nodeName="foo";this.outerHTML="<foo></foo>";this.tagName="foo";this.text="";}
dom_interfaces.HTMLUnknownElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLUnknownElement=new dom_interfaces.HTMLUnknownElement();dom_interfaces.HTMLMetaElement=function(){this.content="";this.httpEquiv="";this.localName="META";this.name="";this.nodeName="META";this.outerHTML="<META>";this.scheme="";this.tagName="META";this.text="";}
dom_interfaces.HTMLMetaElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLMetaElement=new dom_interfaces.HTMLMetaElement();dom_interfaces.HTMLAppletElement=function(){this.align="";this.alt="";this.archive="";this.code="";this.codeBase="";this.height="";this.hspace="0";this.localName="APPLET";this.name="";this.nodeName="APPLET";this.object="";this.outerHTML="<APPLET></APPLET>";this.tagName="APPLET";this.text="";this.vspace="0";this.width="";}
dom_interfaces.HTMLAppletElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLAppletElement=new dom_interfaces.HTMLAppletElement();dom_interfaces.HTMLSelectElement=function(){this.accessKey="";this.add="object";this.autocomplete="";this.autofocus="false";this.checkValidity="object";this.data="";this.disabled="false";this.dispatchChange="object";this.dispatchFormChange="object";this.form="null";this.forms="object";this.item="object";this.labels="object";this.length="0";this.localName="SELECT";this.multiple="false";this.name="";this.namedItem="object";this.nodeName="SELECT";this.onchange="null";this.onformchange="null";this.onforminput="null";this.oninput="null";this.onreset="null";this.onselect="null";this.onsubmit="null";this.options="object";this.outerHTML="<SELECT></SELECT>";this.remove="object";this.selectedIndex="-1";this.selectedOptions="object";this.selectionEnd="0";this.selectionStart="0";this.setCustomValidity="object";this.size="0";this.tabIndex="0";this.tagName="SELECT";this.template="null";this.type="select-one";this.validationMessage="";this.validity="object";this.value="";this.willValidate="false";}
dom_interfaces.HTMLSelectElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLSelectElement=new dom_interfaces.HTMLSelectElement();dom_interfaces.HTMLImageElement=function(){this.align="";this.alt="";this.border="";this.complete="true";this.height="0";this.hspace="0";this.isMap="false";this.localName="IMG";this.longDesc="";this.lowsrc="";this.name="";this.nodeName="IMG";this.outerHTML="<IMG>";this.src="";this.tagName="IMG";this.text="";this.useMap="";this.vspace="0";this.width="0";}
dom_interfaces.HTMLImageElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLImageElement=new dom_interfaces.HTMLImageElement();dom_interfaces.HTMLModElement=function(){this.cite="";this.dateTime="";this.localName="INS";this.nodeName="INS";this.outerHTML="<INS></INS>";this.tagName="INS";this.text="";}
dom_interfaces.HTMLModElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLModElement=new dom_interfaces.HTMLModElement();dom_interfaces.HTMLHtmlElement=function(){this.localName="HTML";this.nodeName="HTML";this.outerHTML="<HTML></HTML>";this.tagName="HTML";this.text="";this.version="";}
dom_interfaces.HTMLHtmlElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLHtmlElement=new dom_interfaces.HTMLHtmlElement();dom_interfaces.HTMLFormElement=function(){this.accept="";this.acceptCharset="";this.action="";this.checkValidity="object";this.data="";this.dispatchFormChange="object";this.dispatchFormInput="object";this.elements="object";this.encoding="";this.enctype="";this.item="object";this.length="0";this.localName="FORM";this.method="";this.name="";this.namedItem="object";this.nodeName="FORM";this.outerHTML="<FORM></FORM>";this.replace="";this.reset="object";this.resetFromData="object";this.submit="object";this.tagName="FORM";this.target="";this.templateElements="object";this.text="";}
dom_interfaces.HTMLFormElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLFormElement=new dom_interfaces.HTMLFormElement();dom_interfaces.HTMLParagraphElement=function(){this.align="";this.localName="P";this.nodeName="P";this.outerHTML="<P></P>";this.tagName="P";this.text="";}
dom_interfaces.HTMLParagraphElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLParagraphElement=new dom_interfaces.HTMLParagraphElement();dom_interfaces.HTMLIFrameElement=function(){this.align="";this.contentDocument="null";this.contentWindow="null";this.frameBorder="";this.getSVGDocument="object";this.height="";this.localName="IFRAME";this.location="null";this.longDesc="";this.marginHeight="";this.marginWidth="";this.name="";this.noResize="false";this.nodeName="IFRAME";this.outerHTML="<IFRAME></IFRAME>";this.scrolling="";this.src="";this.tagName="IFRAME";this.text="";this.width="";}
dom_interfaces.HTMLIFrameElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLIFrameElement=new dom_interfaces.HTMLIFrameElement();dom_interfaces.HTMLQuoteElement=function(){this.cite="";this.localName="BLOCKQUOTE";this.nodeName="BLOCKQUOTE";this.outerHTML="<BLOCKQUOTE></BLOCKQUOTE>";this.tagName="BLOCKQUOTE";this.text="";}
dom_interfaces.HTMLQuoteElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLQuoteElement=new dom_interfaces.HTMLQuoteElement();dom_interfaces.HTMLBaseElement=function(){this.href="";this.localName="BASE";this.nodeName="BASE";this.outerHTML="<BASE>";this.tagName="BASE";this.target="";this.text="";}
dom_interfaces.HTMLBaseElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLBaseElement=new dom_interfaces.HTMLBaseElement();dom_interfaces.HTMLTableColElement=function(){this.align="";this.ch="";this.chOff="";this.localName="COL";this.nodeName="COL";this.outerHTML="<COL>";this.span="0";this.tagName="COL";this.text="";this.vAlign="";this.width="";}
dom_interfaces.HTMLTableColElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLTableColElement=new dom_interfaces.HTMLTableColElement();dom_interfaces.HTMLHeadElement=function(){this.localName="HEAD";this.nodeName="HEAD";this.outerHTML="<HEAD></HEAD>";this.profile="";this.tagName="HEAD";this.text="";}
dom_interfaces.HTMLHeadElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLHeadElement=new dom_interfaces.HTMLHeadElement();dom_interfaces.HTMLHeadingElement=function(){this.align="";this.localName="H1";this.nodeName="H1";this.outerHTML="<H1></H1>";this.tagName="H1";this.text="";}
dom_interfaces.HTMLHeadingElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLHeadingElement=new dom_interfaces.HTMLHeadingElement();dom_interfaces.HTMLTableCellElement=function(){this.abbr="";this.align="";this.axis="";this.bgColor="";this.cellIndex="undefined";this.ch="";this.chOff="";this.colSpan="1";this.headers="";this.height="";this.localName="TD";this.noWrap="false";this.nodeName="TD";this.outerHTML="<TD></TD>";this.rowSpan="1";this.scope="";this.tagName="TD";this.text="";this.vAlign="";this.width="";}
dom_interfaces.HTMLTableCellElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLTableCellElement=new dom_interfaces.HTMLTableCellElement();dom_interfaces.HTMLOptionElement=function(){this.defaultSelected="false";this.disabled="false";this.form="null";this.forms="object";this.index="0";this.label="";this.labels="object";this.length="undefined";this.localName="OPTION";this.nodeName="OPTION";this.outerHTML="<OPTION></OPTION>";this.selected="false";this.tagName="OPTION";this.template="null";this.text="";this.validationMessage="";this.validity="object";this.value="";this.willValidate="false";}
dom_interfaces.HTMLOptionElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLOptionElement=new dom_interfaces.HTMLOptionElement();dom_interfaces.HTMLLIElement=function(){this.localName="LI";this.nodeName="LI";this.outerHTML="<LI></LI>";this.tagName="LI";this.text="";this.type="";this.value="0";}
dom_interfaces.HTMLLIElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLLIElement=new dom_interfaces.HTMLLIElement();dom_interfaces.HTMLParamElement=function(){this.localName="PARAM";this.name="";this.nodeName="PARAM";this.outerHTML="<PARAM>";this.tagName="PARAM";this.text="";this.type="";this.value="";this.valueType="";}
dom_interfaces.HTMLParamElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLParamElement=new dom_interfaces.HTMLParamElement();dom_interfaces.HTMLLegendElement=function(){this.accessKey="";this.align="";this.form="null";this.forms="object";this.labels="object";this.localName="LEGEND";this.nodeName="LEGEND";this.outerHTML="<LEGEND></LEGEND>";this.tagName="LEGEND";this.template="null";this.text="";this.validationMessage="";this.validity="object";this.willValidate="false";}
dom_interfaces.HTMLLegendElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLLegendElement=new dom_interfaces.HTMLLegendElement();dom_interfaces.HTMLUListElement=function(){this.compact="false";this.localName="UL";this.nodeName="UL";this.outerHTML="<UL></UL>";this.tagName="UL";this.text="";this.type="";}
dom_interfaces.HTMLUListElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLUListElement=new dom_interfaces.HTMLUListElement();dom_interfaces.HTMLLabelElement=function(){this.accessKey="";this.control="null";this.form="null";this.forms="object";this.htmlFor="";this.labels="object";this.localName="LABEL";this.nodeName="LABEL";this.outerHTML="<LABEL></LABEL>";this.tagName="LABEL";this.template="null";this.text="";this.validationMessage="";this.validity="object";this.willValidate="false";}
dom_interfaces.HTMLLabelElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLLabelElement=new dom_interfaces.HTMLLabelElement();dom_interfaces.HTMLDirectoryElement=function(){this.compact="false";this.localName="DIR";this.nodeName="DIR";this.outerHTML="<DIR></DIR>";this.tagName="DIR";this.text="";}
dom_interfaces.HTMLDirectoryElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLDirectoryElement=new dom_interfaces.HTMLDirectoryElement();dom_interfaces.HTMLMenuElement=function(){this.compact="false";this.localName="MENU";this.nodeName="MENU";this.outerHTML="<MENU></MENU>";this.tagName="MENU";this.text="";}
dom_interfaces.HTMLMenuElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLMenuElement=new dom_interfaces.HTMLMenuElement();dom_interfaces.HTMLTitleElement=function(){this.localName="TITLE";this.nodeName="TITLE";this.outerHTML="<TITLE></TITLE>";this.tagName="TITLE";this.text="";}
dom_interfaces.HTMLTitleElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLTitleElement=new dom_interfaces.HTMLTitleElement();dom_interfaces.HTMLPreElement=function(){this.localName="PRE";this.nodeName="PRE";this.outerHTML="<PRE></PRE>";this.tagName="PRE";this.text="";this.width="0";}
dom_interfaces.HTMLPreElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLPreElement=new dom_interfaces.HTMLPreElement();dom_interfaces.HTMLTableElement=function(){this.align="";this.bgColor="";this.border="";this.caption="null";this.cellPadding="";this.cellSpacing="";this.cells="object";this.createCaption="object";this.createTFoot="object";this.createTHead="object";this.deleteCaption="object";this.deleteRow="object";this.deleteTFoot="object";this.deleteTHead="object";this.frame="";this.insertRow="object";this.localName="TABLE";this.nodeName="TABLE";this.outerHTML="<TABLE></TABLE>";this.rows="object";this.rules="";this.summary="";this.tBodies="object";this.tFoot="null";this.tHead="null";this.tagName="TABLE";this.text="";this.width="";}
dom_interfaces.HTMLTableElement.prototype=js_object_filters.HTMLElement;js_object_filters.HTMLTableElement=new dom_interfaces.HTMLTableElement();suggest_values={};suggest_values['azimuth']=['left-side','far-left','left','center-left','center','center-right','right','far-right','right-side','behind','leftwards','rightwards']
suggest_values['background-attachment']=['scroll','fixed']
suggest_values['background-image']=['none']
suggest_values['background-position']=['left','center','right','top','center','bottom','left','center','right','top','center','bottom']
suggest_values['background-repeat']=['repeat','repeat-x','repeat-y','no-repeat']
suggest_values['background']=[]
suggest_values['border-collapse']=['collapse','separate']
suggest_values['border-spacing']=[]
suggest_values['border-style']=['none','hidden','dotted ','dashed','solid','double','groove','ridge','inset','outset']
suggest_values['border-top']=suggest_values['border-right']=suggest_values['border-bottom']=suggest_values['border-left']=[]
suggest_values['border-top-color']=suggest_values['border-right-color']=suggest_values['border-bottom-color']=suggest_values['border-left-color']=['transparent']
suggest_values['border-top-style']=suggest_values['border-right-style']=suggest_values['border-bottom-style']=suggest_values['border-left-style']=[]
suggest_values['border-top-width']=suggest_values['border-right-width']=suggest_values['border-bottom-width']=suggest_values['border-left-width']=[]
suggest_values['border-width']=[]
suggest_values['border']=[]
suggest_values['bottom']=['auto']
suggest_values['caption-side']=['top','bottom']
suggest_values['clear']=['none','left','right','both']
suggest_values['clip']=['auto']
suggest_values['color']=['aqua','black','blue','fuchsia','gray','green','lime','maroon','navy','olive','orange','purple','red','silver','teal','white','yellow','ActiveBorder','ActiveCaption','AppWorkspace','Background','ButtonFace','ButtonHighlight','ButtonShadow','ButtonText','CaptionText','GrayText','Highlight','HighlightText','InactiveBorder','InactiveCaption','InactiveCaptionText','InfoBackground','InfoText','Menu','MenuText','Scrollbar','ThreeDDarkShadow','ThreeDFace','ThreeDHighlight','ThreeDLightShadow','ThreeDShadow','Window','WindowFrame','WindowText']
suggest_values['border-color']=suggest_values['background-color']=['transparent'].concat(suggest_values['color']);suggest_values['content']=['normal','none','attr()','open-quote','close-quote','no-open-quote','no-close-quote']
suggest_values['counter-increment']=['none']
suggest_values['counter-reset']=['none']
suggest_values['cue-after']=['none']
suggest_values['cue-before']=['none']
suggest_values['cue']=[]
suggest_values['cursor']=['auto','crosshair','default','pointer','move','e-resize','ne-resize','nw-resize','n-resize','se-resize','sw-resize','s-resize','w-resize','text','wait','help','progress']
suggest_values['direction']=['ltr','rtl']
suggest_values['display']=['inline','block','list-item','run-in','inline-block','table','inline-table','table-row-group','table-header-group','table-footer-group','table-row','table-column-group','table-column','table-cell','table-caption','none']
suggest_values['elevation']=['below','level','above','higher','lower']
suggest_values['empty-cells']=['show','hide']
suggest_values['float']=['left','right','none']
suggest_values['font-family']=[]
suggest_values['font-size']=[]
suggest_values['font-style']=['normal','italic','oblique']
suggest_values['font-variant']=['normal','small-caps']
suggest_values['font-weight']=['normal','bold','bolder','lighter']
suggest_values['font']=['caption','icon','menu','message-box','small-caption','status-bar']
suggest_values['height']=['auto']
suggest_values['left']=['auto']
suggest_values['letter-spacing']=['normal']
suggest_values['line-height']=['normal']
suggest_values['list-style-image']=['none']
suggest_values['list-style-position']=['inside','outside']
suggest_values['list-style-type']=['disc','circle','square','decimal','decimal-leading-zero','lower-roman','upper-roman','lower-greek','lower-latin','upper-latin','armenian','georgian','lower-alpha','upper-alpha','none']
suggest_values['list-style']=[]
suggest_values['margin-right']=suggest_values['margin-left']=[]
suggest_values['margin-top']=suggest_values['margin-bottom']=[]
suggest_values['margin']=[]
suggest_values['max-height']=['none']
suggest_values['max-width']=['none']
suggest_values['min-height']=[]
suggest_values['min-width']=[]
suggest_values['orphans']=[]
suggest_values['outline-color']=['invert']
suggest_values['outline-style']=[]
suggest_values['outline-width']=[]
suggest_values['outline']=[]
suggest_values['overflow']=['visible','hidden','scroll','auto']
suggest_values['padding-top']=suggest_values['padding-right']=suggest_values['padding-bottom']=suggest_values['padding-left']=[]
suggest_values['padding']=[]
suggest_values['page-break-after']=['auto','always','avoid','left','right']
suggest_values['page-break-before']=['auto','always','avoid','left','right']
suggest_values['page-break-inside']=['avoid','auto']
suggest_values['pause-after']=[]
suggest_values['pause-before']=[]
suggest_values['pause']=[]
suggest_values['pitch-range']=[]
suggest_values['pitch']=['x-low','low','medium','high','x-high']
suggest_values['play-during']=['mix','repeat','auto','none']
suggest_values['position']=['static','relative','absolute','fixed']
suggest_values['quotes']=['none']
suggest_values['richness']=[]
suggest_values['right']=['auto']
suggest_values['speak-header']=['once','always']
suggest_values['speak-numeral']=['digits','continuous']
suggest_values['speak-punctuation']=['code','none']
suggest_values['speak']=['normal','none','spell-out']
suggest_values['speech-rate']=['x-slow','slow','medium','fast','x-fast','faster','slower']
suggest_values['stress']=[]
suggest_values['table-layout']=['auto','fixed']
suggest_values['text-align']=['left','right','center','justify']
suggest_values['text-decoration']=['none','underline','overline','line-through','blink']
suggest_values['text-indent']=[]
suggest_values['text-transform']=['capitalize','uppercase','lowercase','none']
suggest_values['top']=['auto']
suggest_values['unicode-bidi']=['normal','embed','bidi-override']
suggest_values['vertical-align']=['baseline','sub','super','top','text-top','middle','bottom','text-bottom']
suggest_values['visibility']=['visible','hidden','collapse']
suggest_values['voice-family']=[]
suggest_values['volume']=['silent','x-soft','soft','medium','loud','x-loud']
suggest_values['white-space']=['normal','pre','nowrap','pre-wrap','pre-line']
suggest_values['widows']=[]
suggest_values['width']=['auto']
suggest_values['word-spacing']=['normal']
suggest_values['z-index']=['auto']
var Node_dom_attrs=function(){const
KEY=0,VALUE=1;var __selectedElement=null;var __views=['dom_attrs'];this.rt_id='';this.data=[];var self=this;this.filter_type=VALUE;this.getSelectedNode=function(){return __selectedElement;}
this.getSelectedNodeData=function(){if(__selectedElement){return this.getData(__selectedElement.rt_id,__selectedElement.obj_id);}}
var onElementSelected=function(msg){__selectedElement={rt_id:msg.rt_id,obj_id:msg.obj_id};self.setObject(msg.rt_id,msg.obj_id);var view_id='',i=0;for(;view_id=__views[i];i++){views[view_id].update();}}
messages.addListener('element-selected',onElementSelected);}
Node_dom_attrs.prototype=ObjectDataBase;node_dom_attrs=new Node_dom_attrs();var elementLayout=new function(){const
PADDING_TOP=0,PADDING_RIGHT=1,PADDING_BOTTOM=2,PADDING_LEFT=3,BORDER_TOP_WIDTH=4,BORDER_RIGHT_WIDTH=5,BORDER_BOTTOM_WIDTH=6,BORDER_LEFT_WIDTH=7,MARGIN_TOP=8,MARGIN_RIGHT=9,MARGIN_BOTTOM=10,MARGIN_LEFT=11,WIDTH=12,HEIGHT=13,OFFSET_TOP=1,OFFSET_LEFT=2,OFFSET_WIDTH=3,OFFSET_HEIGHT=4,SCROLL_TOP=5,SCROLL_LEFT=6,SCROLL_WIDTH=7,SCROLL_HEIGHT=8,CLIENT_TOP=9,CLIENT_LEFT=10,CLIENT_WIDTH=11,CLIENT_HEIGHT=12,OFFSETS=['','offsetTop','offsetLeft','offsetWidth','offsetHeight','scrollTop','scrollLeft','scrollWidth','scrollHeight','clientTop','clientLeft','clientWidth','clientHeight'],GET_OFFSETS_SCRIPT="\
    (function(ele)\
    {\
      var \
      parent = ele,\
      log = ele.nodeName + '|0;',\
      offsetParent = ele.offsetParent,\
      offsets =\
      [\
        '"+OFFSETS[OFFSET_TOP]+"',\
        '"+OFFSETS[OFFSET_LEFT]+"',\
        '"+OFFSETS[OFFSET_WIDTH]+"',\
        '"+OFFSETS[OFFSET_HEIGHT]+"',\
        '"+OFFSETS[SCROLL_TOP]+"',\
        '"+OFFSETS[SCROLL_LEFT]+"',\
        '"+OFFSETS[SCROLL_WIDTH]+"',\
        '"+OFFSETS[SCROLL_HEIGHT]+"',\
        '"+OFFSETS[CLIENT_TOP]+"',\
        '"+OFFSETS[CLIENT_LEFT]+"',\
        '"+OFFSETS[CLIENT_WIDTH]+"',\
        '"+OFFSETS[CLIENT_HEIGHT]+"'\
      ],\
      offset = '',\
      i = 0;\
      while( ( parent = parent.parentNode ) && parent.nodeType == 1 )\
      {\
        if(parent == offsetParent)\
        {\
          log = parent.nodeName + '|1,' + log;\
          offsetParent = parent.offsetParent;\
        }\
        else\
        {\
          log = parent.nodeName + '|0,' + log;\
        }\
      };\
      for( ; offset = offsets[i]; i++)\
      {\
        log += ele[offset] + ';';\
      }\
      return log;\
    })(ele)\
    ";var layout_map=[];var setup_layout_map=function(){var prop='',i=0;for(;prop=css_index_map[i];i++){switch(prop){case 'padding-top':{layout_map[PADDING_TOP]=i;break;}
case 'padding-right':{layout_map[PADDING_RIGHT]=i;break;}
case 'padding-bottom':{layout_map[PADDING_BOTTOM]=i;break;}
case 'padding-left':{layout_map[PADDING_LEFT]=i;break;}
case 'border-top-width':{layout_map[BORDER_TOP_WIDTH]=i;break;}
case 'border-right-width':{layout_map[BORDER_RIGHT_WIDTH]=i;break;}
case 'border-bottom-width':{layout_map[BORDER_BOTTOM_WIDTH]=i;break;}
case 'border-left-width':{layout_map[BORDER_LEFT_WIDTH]=i;break;}
case 'margin-top':{layout_map[MARGIN_TOP]=i;break;}
case 'margin-right':{layout_map[MARGIN_RIGHT]=i;break;}
case 'margin-bottom':{layout_map[MARGIN_BOTTOM]=i;break;}
case 'margin-left':{layout_map[MARGIN_LEFT]=i;break;}
case 'width':{layout_map[WIDTH]=i;break;}
case 'height':{layout_map[HEIGHT]=i;break;}}}}
var __selectedElement=null;var __comp_style=null;var __offsets_values="";var __views=['css-layout'];var onElementSelected=function(msg){__comp_style=null;__offsets_values="";__selectedElement={rt_id:msg.rt_id,obj_id:msg.obj_id};var i=0,view_id='';for(i=0;view_id=__views[i];i++){views[view_id].update();}}
this.getLayoutValues=function(org_args){if(!__selectedElement){return null;}
if(__comp_style){return __comp_style;}
var
rt_id=__selectedElement.rt_id,obj_id=__selectedElement.obj_id;if(stylesheets.hasStylesheetsRuntime(rt_id)){var tag=tagManager.setCB(null,handleGetMetricsData,[rt_id,obj_id,org_args]);services['ecmascript-debugger'].cssGetStyleDeclarations(tag,rt_id,obj_id,'10000','json');}
else
{stylesheets.getStylesheets(__selectedElement.rt_id,arguments);}
return null;}
var handleGetMetricsData=function(xml,rt_id,obj_id,org_args){var
json=xml.getNodeData('matching-style-declarations'),declarations=null;if(json){declarations=eval('('+json+')');__comp_style=declarations[0];if(!layout_map.length){setup_layout_map();}
if(org_args&&!org_args[0].__call_count){org_args[0].__call_count=1;org_args.callee.apply(null,org_args)}}}
this.getOffsetsValues=function(org_args){if(!__selectedElement){return null;}
if(__offsets_values){return __offsets_values;}
var
rt_id=__selectedElement.rt_id,obj_id=__selectedElement.obj_id,tag=tagManager.setCB(null,handleGetOffsetsData,[rt_id,obj_id,org_args]);services['ecmascript-debugger'].eval(tag,rt_id,'','',GET_OFFSETS_SCRIPT,['ele',obj_id]);return null;}
this.prettyprintOffsetValues=function(){var
data=__offsets_values.split(';'),ret='<h2>'+ui_strings.M_VIEW_SUB_LABEL_PARENT_OFFSETS+'</h2><parent-node-chain>',i=0,chain=data[0].split(','),cur='';for(i=0;cur=chain[i];i++){chain[i]=cur.split('|');}
ret+=document.renderInner(templates.breadcrumb(dom_data.getCSSPath(chain)));ret+="</parent-node-chain><h2>"+ui_strings.M_VIEW_SUB_LABEL_OFFSET_VALUES+"</h2><offsets>";for(i=1;data[i];i++){ret+="<item>"+"<key>"+OFFSETS[i]+"</key>"+"<value>"+data[i]+"</value>"+"</item>";}
ret+="</offsets>";return ret;}
var handleGetOffsetsData=function(xml,rt_id,obj_id,org_args){if(xml.getNodeData('status')=='completed'){__offsets_values=xml.getNodeData('string')
if(org_args&&!org_args[0].__call_count){org_args[0].__call_count=1;org_args.callee.apply(null,org_args)}}
else
{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'handleGetOffsetsData failed')}}
this.metricsTemplate=function(styles){return['div',['ul',['li',['p','\u00a0',['span','margin']]],['li',__comp_style[layout_map[MARGIN_TOP]]],['li']],['ul',['li',__comp_style[layout_map[MARGIN_LEFT]]],['li',['ul',['li',['p','\u00a0',['span','border']]],['li',__comp_style[layout_map[BORDER_TOP_WIDTH]]],['li']],['ul',['li',__comp_style[layout_map[BORDER_LEFT_WIDTH]]],['li',['ul',['li',['p','\u00a0',['span','padding']]],['li',__comp_style[layout_map[PADDING_TOP]]],['li']],['ul',['li',__comp_style[layout_map[PADDING_LEFT]]],['li',['ul',['li',__comp_style[layout_map[WIDTH]],'class','elementWidth']],['ul',['li',__comp_style[layout_map[HEIGHT]],'class','elementHeight']],['ul',['li','\u00a0']],'class','element'],['li',__comp_style[layout_map[PADDING_RIGHT]]]],['ul',['li',__comp_style[layout_map[PADDING_BOTTOM]],'colspan','3']],'class','padding'],['li',__comp_style[layout_map[BORDER_RIGHT_WIDTH]]]],['ul',['li',__comp_style[layout_map[BORDER_BOTTOM_WIDTH]],'colspan','3']],'class','border'],['li',__comp_style[layout_map[MARGIN_RIGHT]]]],['ul',['li',__comp_style[layout_map[MARGIN_BOTTOM]],'colspan','3']],'class','metrics border'];}
messages.addListener('element-selected',onElementSelected);}
var stylesheets=new function(){var self=this;var __sheets={};var __rules={};var __indexMap=null;var __indexMapLength=0;var __sortedIndexMap=[];var __initialValues=[];var __shorthandIndexMap=[];var __selectedRules=null;var __colorIndex=0;var __new_rts=null;var __top_rt_id='';var __on_new_stylesheets_cbs={};var line_height_index=0;var onResetState=function(){__sheets={};__rules={};__indexMap=null;__indexMapLength=0;__sortedIndexMap=[];__initialValues=[];__shorthandIndexMap=[];__selectedRules=null;__colorIndex=0;__new_rts=null;__top_rt_id='';__on_new_stylesheets_cbs={};}
const
SHEET_OBJECT_ID=0,SHEET_DISABLED=1,SHEET_HREF=2,SHEET_MEDIA_LIST=3,SHEET_OWNERNODE=4,SHEET_OWNERRULE=5,SHEET_PARENT_STYLESHEET=6,SHEET_TITLE=7,SHEET_TYPE=8,UNKNOWN_RULE=0,STYLE_RULE=1,CHARSET_RULE=2,IMPORT_RULE=3,MEDIA_RULE=4,FONT_FACE_RULE=5,PAGE_RULE=6,COMMON=11,MARKUP_KEY="<property><key>",MARKUP_KEY_OW="<property class='overwritten'><key>",MARKUP_KEY_CLOSE="</key>: ",MARKUP_VALUE="<value>",MARKUP_VALUE_OW="<value>",MARKUP_VALUE_CLOSE="</value>;</property>",MARKUP_PROP_NL="",MARKUP_IMPORTANT=" !important",MARKUP_SPACE=" ",MARKUP_EMPTY="",HEADER=0,COMP_STYLE=0,CSS=1,PROP_LIST=1,VAL_LIST=2,PRIORITY_LIST=3,OVERWRITTEN_LIST=4,SEARCH_LIST=6,HAS_MATCHING_SEARCH_PROPS=7;var
SHORTHAND=[];var short_hand_counts={"background":6,"list-style":4,"font":7}
var initials={"background-attachment":"scroll","background-color":"transparent","background-image":"none","background-position":"0% 0%","background-repeat":"repeat","list-style-image":"none","list-style-position":"outside","list-style-type":"disc","font-family":"","font-size":"medium","font-style":"normal","font-variant":"normal","font-weight":"400","line-height":"normal"};var short_hand_props={'font':1,'padding':1,'margin':1,'list-style':1,'border':1,'border-top':1,'border-right':1,'border-bottom':1,'border-left':1,'border-width':1,'border-style':1,'border-color':1,'background':1,'outline':1}
var special_default_values={};special_default_values["border-bottom-color"]=special_default_values["border-left-color"]=special_default_values["border-right-color"]=special_default_values["border-top-color"]=function(data,value){return value==data[__colorIndex];}
const
RULE_HEADER=0,INDENT='  ';var shorthands={};shorthands.padding=shorthands.margin=function(prop,index_list,value_list,priority_list){var
consistent_pri_flag=priority_list[1]==priority_list[2]&&
priority_list[1]==priority_list[3]&&priority_list[1]==priority_list[4];if(consistent_pri_flag){var
priority_flag=priority_list[1]?MARKUP_IMPORTANT:MARKUP_EMPTY,top_bottom=value_list[1]==value_list[3],left_right=value_list[2]==value_list[4];if(top_bottom&&left_right&&value_list[1]==value_list[2]){return INDENT+MARKUP_KEY+prop+MARKUP_KEY_CLOSE+MARKUP_VALUE+value_list[1]+priority_flag+MARKUP_VALUE_CLOSE;}
if(top_bottom&&left_right){return INDENT+MARKUP_KEY+prop+MARKUP_KEY_CLOSE+MARKUP_VALUE+value_list[1]+MARKUP_SPACE+value_list[2]+priority_flag+MARKUP_VALUE_CLOSE;}
if(left_right){return INDENT+MARKUP_KEY+prop+MARKUP_KEY_CLOSE+MARKUP_VALUE+value_list[1]+MARKUP_SPACE+value_list[2]+MARKUP_SPACE+value_list[3]+priority_flag+MARKUP_VALUE_CLOSE;}
return INDENT+MARKUP_KEY+prop+MARKUP_KEY_CLOSE+MARKUP_VALUE+value_list[1]+MARKUP_SPACE+value_list[2]+MARKUP_SPACE+value_list[3]+MARKUP_SPACE+value_list[4]+priority_flag+MARKUP_VALUE_CLOSE;}
else
{var ret='',i=1;for(;i<index_list.length;i++){if(value_list[i]){ret+=(ret?MARKUP_PROP_NL:"")+INDENT+MARKUP_KEY+__indexMap[index_list[i]]+MARKUP_KEY_CLOSE+MARKUP_VALUE+value_list[i]+(priority_list[i]?MARKUP_IMPORTANT:MARKUP_EMPTY)+MARKUP_VALUE_CLOSE;}}
return ret;}}
shorthands.fallback=function(index,value,priority_flag){return INDENT+MARKUP_KEY+__indexMap[index]+MARKUP_KEY_CLOSE+MARKUP_VALUE+value+(priority_flag?MARKUP_IMPORTANT:MARKUP_EMPTY)+MARKUP_VALUE_CLOSE;}
shorthands.border=function(prop,index_list,value_list,priority_list){var
key_list=['border-top','border-right','border-bottom','border-left'],key_type_list=['border-width','border-style','border-color'],is_short_width=value_list[1]&&value_list[4]&&value_list[7]&&value_list[10]&&1||0,is_short_style=value_list[2]&&value_list[5]&&value_list[8]&&value_list[11]&&1||0,is_short_color=value_list[3]&&value_list[6]&&value_list[9]&&value_list[12]&&1||0,is_short_type=is_short_width+is_short_style+is_short_color==1,short_value_list=[],is_short_priority_list=[],short_priority_list=[],i=1,j=0,index_short=0,previous_value='',is_short_short=true,is_all_and_consistent_pri_flag=true,priority_flag='',ret='',_0_1_=false,_2_3_=false,three_equals=null;if(is_short_type){i=is_short_color&&2||is_short_style&&1||0;if(priority_list[i+1]==priority_list[i+4]&&priority_list[i+1]==priority_list[i+7]&&
priority_list[i+1]==priority_list[i+10]){priority_flag=priority_list[i+1]?MARKUP_IMPORTANT:MARKUP_EMPTY;if(value_list[i+1]==value_list[i+4]&&value_list[i+1]==value_list[i+7]&&
value_list[i+1]==value_list[i+10]){return INDENT+MARKUP_KEY+key_type_list[i]+MARKUP_KEY_CLOSE+MARKUP_VALUE+value_list[i+1]+priority_flag+MARKUP_VALUE_CLOSE;}
else
{return INDENT+MARKUP_KEY+key_type_list[i]+MARKUP_KEY_CLOSE+MARKUP_VALUE+value_list[i+1]+MARKUP_SPACE+value_list[i+4]+MARKUP_SPACE+value_list[i+7]+MARKUP_SPACE+value_list[i+10]+priority_flag+MARKUP_VALUE_CLOSE;}}
else
{for(j=1;j<11;j+=3){ret+=(ret?MARKUP_PROP_NL:"")+this.fallback(index_list[i+j],value_list[i+j],priority_list[i+j]);}
return ret;}}
for(i=1;i<13;i+=3){if(value_list[i]&&value_list[i+1]&&value_list[i+2]){if(is_short_priority_list[index_short]=priority_list[i]==priority_list[i+1]&&
priority_list[i]==priority_list[i+2]){short_priority_list[index_short]=priority_list[i]?MARKUP_IMPORTANT:MARKUP_EMPTY;short_value_list[index_short]=value_list[i+1]=='none'
?value_list[i+1]
:value_list[i]+MARKUP_SPACE+value_list[i+1]+MARKUP_SPACE+value_list[i+2];}
else
{short_value_list[index_short]=i;}}
is_short_short=is_short_short&&is_short_priority_list[index_short];if(index_short&&is_short_short){is_short_short=previous_value&&previous_value==short_value_list[index_short];}
is_all_and_consistent_pri_flag=is_all_and_consistent_pri_flag&&
(index_short
?is_short_priority_list[index_short-1]==is_short_priority_list[index_short]
:is_short_priority_list[index_short]);previous_value=short_value_list[index_short];index_short++;}
if(is_short_short){return INDENT+MARKUP_KEY+prop+MARKUP_KEY_CLOSE+MARKUP_VALUE+short_value_list[0]+MARKUP_VALUE_CLOSE;}
else if(is_all_and_consistent_pri_flag){_0_1_=short_value_list[0]==short_value_list[1];_2_3_=short_value_list[2]==short_value_list[3];three_equals=[_2_3_&&short_value_list[1]==short_value_list[2],_2_3_&&short_value_list[0]==short_value_list[2],_0_1_&&short_value_list[0]==short_value_list[3],_0_1_&&short_value_list[0]==short_value_list[2],]
for(i=0;i<4&&!three_equals[i];i++);if(i!=4){return INDENT+MARKUP_KEY+prop+MARKUP_KEY_CLOSE+MARKUP_VALUE+(i
?short_value_list[0]+short_priority_list[0]
:short_value_list[1]+short_priority_list[1])+MARKUP_VALUE_CLOSE+MARKUP_PROP_NL+INDENT+MARKUP_KEY+key_list[i]+MARKUP_KEY_CLOSE+MARKUP_VALUE+short_value_list[i]+short_priority_list[i]+MARKUP_VALUE_CLOSE;}}
for(i=0;i<4;i++){if(short_value_list[i]){if(is_short_priority_list[i]){ret+=(ret?MARKUP_PROP_NL:"")+INDENT+MARKUP_KEY+key_list[i]+MARKUP_KEY_CLOSE+MARKUP_VALUE+short_value_list[i]+short_priority_list[i]+MARKUP_VALUE_CLOSE;}
else
{for(j=short_value_list[i];j<short_value_list[i]+3;j++){ret+=(ret?MARKUP_PROP_NL:"")+this.fallback(index_list[j],value_list[j],priority_list[j]);}}}}
return ret;}
shorthands.font=shorthands['list-style']=shorthands.background=function(prop,index_list,value_list,priority_list){var
priority_flag=-1,count=short_hand_counts[prop],i=1,short_values='',ret='';for(;i<count;i++){if(value_list[i]){if(priority_flag==-1){priority_flag=priority_list[i];}
else if(priority_flag!=priority_list[i]){break;}}
else
{break;}}
if(i==count){priority_flag=priority_flag?MARKUP_IMPORTANT:MARKUP_EMPTY;for(i=0;i<count;i++){if(value_list[i]&&value_list[i]!=initials[__indexMap[index_list[i]]]){short_values+=
(short_values?(__indexMap[index_list[i]]=='line-height'?'/':' '):'')+value_list[i];}}
ret+=(ret?MARKUP_PROP_NL:"")+INDENT+MARKUP_KEY+prop+MARKUP_KEY_CLOSE+MARKUP_VALUE+(short_values?short_values:initials[__indexMap[index_list[1]]])+priority_flag+MARKUP_VALUE_CLOSE;}
else
{for(i=1;i<count;i++){if(value_list[i]){ret+=(ret?MARKUP_PROP_NL:"")+this.fallback(index_list[i],value_list[i],priority_list[i]);}}}
return ret;}
var prettyPrintRule=[];prettyPrintRule[COMMON]=function(rule,do_shortcuts,search_active){const
HEADER=0,INDEX_LIST=1,VALUE_LSIT=2,PROPERTY_LIST=3;var ret='',index_list=rule[INDEX_LIST],value_list=rule[VALUE_LSIT],priority_list=rule[PROPERTY_LIST],overwrittenlist=rule[OVERWRITTEN_LIST],search_list=rule[SEARCH_LIST],length=index_list.length,i=0,index=0,s_h_index=[],s_h_value=[],s_h_priority=[],s_h_prop='',s_h_count=0;for(;i<length;i++){index=index_list[i];if(search_active&&!search_list[i]){continue;}
if(do_shortcuts&&SHORTHAND[index]){if(__shorthandIndexMap[index]=='font'){SHORTHAND[line_height_index]=5;}
s_h_index=[];s_h_value=[];s_h_priority=[];s_h_prop=__shorthandIndexMap[index];s_h_count=0;do
{if(__shorthandIndexMap[index]!='line-height'&&
__shorthandIndexMap[index]!=s_h_prop){ret+=(ret?MARKUP_PROP_NL:"")+shorthands[s_h_prop](s_h_prop,s_h_index,s_h_value,s_h_priority);s_h_count=s_h_count%4;while(s_h_prop=='border'&&s_h_count){ret+=(ret?MARKUP_PROP_NL:MARKUP_EMPTY)+INDENT+MARKUP_KEY_OW+__indexMap[index_list[i-s_h_count]]+MARKUP_KEY_CLOSE+MARKUP_VALUE_OW+value_list[i-s_h_count]+(priority_list[i-s_h_count]?MARKUP_IMPORTANT:"")+MARKUP_VALUE_CLOSE;s_h_count--;}
SHORTHAND[line_height_index]=__shorthandIndexMap[index]=='font'?5:0;s_h_index=[];s_h_value=[];s_h_priority=[];s_h_prop=__shorthandIndexMap[index];s_h_count=0;}
s_h_index[SHORTHAND[index]]=index;s_h_value[SHORTHAND[index]]=value_list[i];s_h_priority[SHORTHAND[index]]=priority_list[i];index=index_list[++i];s_h_count++;}
while(SHORTHAND[index]);ret+=(ret?MARKUP_PROP_NL:MARKUP_EMPTY)+shorthands[s_h_prop](s_h_prop,s_h_index,s_h_value,s_h_priority);s_h_count=s_h_count%4;while(s_h_prop=='border'&&s_h_count){ret+=(ret?MARKUP_PROP_NL:MARKUP_EMPTY)+INDENT+MARKUP_KEY_OW+__indexMap[index_list[i-s_h_count]]+MARKUP_KEY_CLOSE+MARKUP_VALUE_OW+value_list[i-s_h_count]+(priority_list[i-s_h_count]?MARKUP_IMPORTANT:"")+MARKUP_VALUE_CLOSE;s_h_count--;}
SHORTHAND[line_height_index]=0;}
else
{if(overwrittenlist&&overwrittenlist[i]){ret+=(ret?MARKUP_PROP_NL:MARKUP_EMPTY)+INDENT+MARKUP_KEY+__indexMap[index]+MARKUP_KEY_CLOSE+MARKUP_VALUE+value_list[i]+(priority_list[i]?MARKUP_IMPORTANT:"")+MARKUP_VALUE_CLOSE;}
else
{ret+=(ret?MARKUP_PROP_NL:MARKUP_EMPTY)+INDENT+MARKUP_KEY_OW+__indexMap[index]+MARKUP_KEY_CLOSE+MARKUP_VALUE_OW+value_list[i]+(priority_list[i]?MARKUP_IMPORTANT:"")+MARKUP_VALUE_CLOSE;}}}
return ret;}
prettyPrintRule[UNKNOWN_RULE]=function(rule,do_shortcuts){return '';}
prettyPrintRule[STYLE_RULE]=function(rule,do_shortcuts){return "<rule rule-id='"+rule[HEADER][1]+"'>"+"<selector>"+rule[HEADER][3].join(', ')+"</selector>"+" {\n"+prettyPrintRule[COMMON](rule,do_shortcuts)+"\n}</rule>";}
prettyPrintRule[CHARSET_RULE]=function(rule,do_shortcuts){return 'TODO';}
prettyPrintRule[IMPORT_RULE]=function(rule,do_shortcuts){return "<import-rule rule-id='"+rule[0][1]+"' imported-sheet='"+rule[0][5]+"'>"+"<span class='import-rule'>@import url(\""+rule[0][3]+"\") "+rule[0][4].join(', ')+"</span>"+"</import-rule>";}
prettyPrintRule[MEDIA_RULE]=function(rule,do_shortcuts){var ret='',_rule=null,header=null,i=0;for(;_rule=rule[1][i];i++){ret+=prettyPrintRule[_rule[RULE_HEADER][2]](_rule,do_shortcuts);}
return "<media-rule rule-id='"+rule[0][1]+"'>"+"<media>@media "+rule[0][3].join(', ')+"   </media>{"+"<rules>"+ret+"</rules>"+"}</media-rule>";}
prettyPrintRule[FONT_FACE_RULE]=function(rule,do_shortcuts){return "<font-face-rule rule-id='"+rule[HEADER][1]+"'>"+"<at>@font-face</at> {\n"+prettyPrintRule[COMMON](rule,do_shortcuts)+"\n}</font-face-rule>";}
prettyPrintRule[PAGE_RULE]=function(rule,do_shortcuts){return "<page-rule rule-id='"+rule[HEADER][1]+"'>"+"<at>@page</at>"+(rule[0][4]?"<selector>"+rule[HEADER][4]+"</selector>":"")+" {\n"+prettyPrintRule[COMMON](rule,do_shortcuts)+"\n}</page-rule>";}
this.prettyPrintRules=function(rules,do_shortcuts){var ret='',rule=null,header=null,i=0;if(rules.length){for(;rule=rules[i];i++){ret+=prettyPrintRule[rule[RULE_HEADER][2]](rule,do_shortcuts);}
return "<stylesheet stylesheet-id='"+rules[0][0][0]+"' runtime-id='"+rules['runtime-id']+"'>"
+ret+"</stylesheet>";}
else
{return "<div class='info-box'><p>"+ui_strings.S_INFO_STYLESHEET_HAS_NO_RULES+"</p></div>";}}
var prettyPrintCat=[];var prettyPrintCat_2=[];prettyPrintCat_2[COMP_STYLE]=prettyPrintCat[COMP_STYLE]=function(data,search_active){var ret="",i=0,index=0,prop='',value='';var setProps=elementStyle.getSetProps();var hideInitialValue=settings['css-inspector'].get('hide-initial-values');var hide_shorthands=settings['css-inspector'].get('hide-shorthands');var serach_map=search_active&&elementStyle.getSearchMap()||[];var is_not_initial_value=false;var display=false;for(;i<__indexMapLength;i++){index=__sortedIndexMap[i];prop=__indexMap[index];value=data[index];is_not_initial_value=hideInitialValue
&&value
&&value!=__initialValues[index]
&&!(prop in special_default_values&&special_default_values[prop](data,value))
||false;display=(!hideInitialValue
||setProps[index]
||is_not_initial_value)
&&!(hide_shorthands&&short_hand_props[prop])
&&!(search_active&&!serach_map[index]);if(display){ret+=(ret?MARKUP_PROP_NL:"")+MARKUP_KEY+prop+MARKUP_KEY_CLOSE+MARKUP_VALUE+value+MARKUP_VALUE_CLOSE;}}
return ret;}
prettyPrintCat_2[CSS]=function(data,search_active){var
node_casc=null,i=0,ret='',j=0,css_style_dec=null,rt_id=data.rt_id,node_casc_header=null,style_dec_list=null,style_dec=null;for(;node_casc=data[i];i++){if(search_active&&!node_casc[HAS_MATCHING_SEARCH_PROPS]){continue;}
if(i){ret+="<h2>inherited from <b>"+node_casc[0][1]+"</b></h2>";}
node_casc_header=node_casc[0];style_dec_list=node_casc[1];for(j=0;style_dec=style_dec_list[j];j++){ret+=prettyPrintStyleDec[style_dec[0][0]](rt_id,node_casc_header,style_dec,search_active);}}
return ret;}
const
PROT_4_USER_AGENT=1,PROT_4_LOCAL=2,PROT_4_AUTHOR=3,PROT_4_ELEMENT=4;var prettyPrintStyleDec=[];prettyPrintStyleDec[PROT_4_USER_AGENT]=function(rt_id,node_casc_header,style_dec,search_active){return "<rule>"+"<stylesheet-link class='pseudo'>default values</stylesheet-link>"+"<inline-style>"+node_casc_header[1]+"</inline-style>"+" {\n"+prettyPrintRule[COMMON](style_dec,false,search_active)+"\n}</rule>";}
prettyPrintStyleDec[PROT_4_LOCAL]=function(rt_id,node_casc_header,style_dec,search_active){return "<rule>"+"<stylesheet-link class='pseudo'>local user stylesheet</stylesheet-link>"+"<inline-style>"+style_dec[0][2]+"</inline-style>"+" {\n"+prettyPrintRule[COMMON](style_dec,false,search_active)+"\n}</rule>";}
prettyPrintStyleDec[PROT_4_AUTHOR]=function(rt_id,node_casc_header,style_dec,search_active){var
ret='',header=null,i=0,sheet=self.getSheetWithObjId(rt_id,style_dec[HEADER][1]);if(sheet){if(!search_active||style_dec[HAS_MATCHING_SEARCH_PROPS]){ret+="<rule rule-id='"+style_dec[HEADER][2]+"'>"+"<stylesheet-link rt-id='"+sheet[0]+"'"+" index='"+sheet[1]+"' handler='display-rule-in-stylesheet'>"+sheet[2]+"</stylesheet-link>"+"<selector>"+style_dec[HEADER][5]+"</selector>"+" {\n"+prettyPrintRule[COMMON](style_dec,false,search_active)+"\n}</rule>";}}
else
{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'stylesheet is missing in stylesheets, prettyPrintStyleDec[PROT_4_AUTHOR]');}
return ret;}
prettyPrintStyleDec[PROT_4_ELEMENT]=function(rt_id,node_casc_header,style_dec,search_active){return "<rule>"+"<inline-style>element.style</inline-style>"+" {\n"+prettyPrintRule[COMMON](style_dec,false,search_active)+"\n}</rule>";}
this.prettyPrintCat=function(cat_index,data,org_args,search_active){if(!__sheets[data.rt_id]){var tag=tagManager.setCB(null,handleGetAllStylesheets,[data.rt_id,org_args]);services['ecmascript-debugger'].getAllStylesheets(tag,data.rt_id,'json');return '';}
if(!__indexMap){var tag=tagManager.setCB(null,handleGetIndexMap,[org_args]);services['ecmascript-debugger'].getIndexMap(tag,'json');return '';}
return prettyPrintCat_2[cat_index](data,search_active);}
this.getStylesheets=function(rt_id,org_args){if(__sheets[rt_id]){return __sheets[rt_id];}
if(org_args&&runtime_onload_handler.check(rt_id,org_args)){if(!__indexMap){var tag=tagManager.setCB(null,handleGetIndexMap,[]);services['ecmascript-debugger'].getIndexMap(tag,'json');}
var tag=tagManager.setCB(null,handleGetAllStylesheets,[rt_id,org_args]);services['ecmascript-debugger'].getAllStylesheets(tag,rt_id,'json');return null;}}
this.hasStylesheetsRuntime=function(rt_id){return __sheets[rt_id]&&true||false;}
this.getSheetWithObjId=function(rt_id,obj_id){if(__sheets[rt_id]){var sheet=null,i=0;for(;sheet=__sheets[rt_id][i];i++){if(sheet[SHEET_OBJECT_ID]==obj_id){return[rt_id,i,(sheet[SHEET_HREF]&&/\/([^/]*$)/.exec(sheet[SHEET_HREF])[1]
||sheet[SHEET_TITLE]
||'stylesheet '+i)];}}
return null;}}
this.getSheetWithRtIdAndIndex=function(rt_id,index){return __sheets[rt_id]&&__sheets[rt_id][index]||null;}
this.invalidateSheet=function(rt_id,index){if(__rules[rt_id]&&__rules[rt_id][index]){__rules[rt_id][index]=null;if(__selectedRules&&
__selectedRules.runtime_id==rt_id&&
__selectedRules.index==index){__selectedRules=null;}}}
this.getRulesWithSheetIndex=function(rt_id,index,org_args){if(__rules[rt_id][index]){return __rules[rt_id][index];}
else if(__sheets[rt_id][index]){var tag=tagManager.setCB(null,handleGetRulesWithIndex,[rt_id,index,org_args]);var sheet_id=__sheets[rt_id][index][SHEET_OBJECT_ID];services['ecmascript-debugger'].getCSSRules(tag,rt_id,sheet_id,'json');return null;}
else
{return null;}}
this.setSelectedSheet=function(rt_id,index,rules,rule_id){__selectedRules={runtime_id:rt_id,index:index,rules:rules,rule_id:rule_id||''}}
this.getSelectedSheet=function(org_args){if(__selectedRules){return __selectedRules;}
if(org_args){onNewStylesheets(__top_rt_id,[null,selectFirstSheet,__top_rt_id,0,org_args]);}
return null;}
var selectFirstSheet=function(rt_id,index,org_args){var rules=stylesheets.getRulesWithSheetIndex(rt_id,index,arguments);if(rules){self.setSelectedSheet(rt_id,index,rules);org_args.callee.apply(null,org_args);}
window['cst-selects']['stylesheet-select'].updateElement();}
this.hasSelectedSheetRuntime=function(rt_id){return __selectedRules&&__selectedRules.runtime_id==rt_id||false;}
this.isSelectedSheet=function(rt_id,index){return(__selectedRules&&rt_id==__selectedRules.runtime_id&&
index==__selectedRules.index&&true||false);}
var handleGetIndexMap=function(xml,org_args){var json=xml.getNodeData('index');if(json){window.css_index_map=__indexMap=eval('('+json+')');window.inherited_props_index_list=[];var prop='',i=0;var temp=[];for(;prop=__indexMap[i];i++){temp[i]={index:i,key:prop};__initialValues[i]=css_initial_values[prop];if(prop in css_inheritable_properties){inherited_props_index_list[i]=true;}
switch(prop){case 'color':{__colorIndex=i;break;}
case 'margin-top':{SHORTHAND[i]=1;__shorthandIndexMap[i]='margin';break;}
case 'margin-right':{SHORTHAND[i]=2;__shorthandIndexMap[i]='margin';break;}
case 'margin-bottom':{SHORTHAND[i]=3;__shorthandIndexMap[i]='margin';break;}
case 'margin-left':{SHORTHAND[i]=4;__shorthandIndexMap[i]='margin';break;}
case 'padding-top':{SHORTHAND[i]=1;__shorthandIndexMap[i]='padding';break;}
case 'padding-right':{SHORTHAND[i]=2;__shorthandIndexMap[i]='padding';break;}
case 'padding-bottom':{SHORTHAND[i]=3;__shorthandIndexMap[i]='padding';break;}
case 'padding-left':{SHORTHAND[i]=4;__shorthandIndexMap[i]='padding';break;}
case 'border-top-width':{SHORTHAND[i]=1;__shorthandIndexMap[i]='border';break;}
case 'border-top-style':{SHORTHAND[i]=2;__shorthandIndexMap[i]='border';break;}
case 'border-top-color':{SHORTHAND[i]=3;__shorthandIndexMap[i]='border';break;}
case 'border-right-width':{SHORTHAND[i]=4;__shorthandIndexMap[i]='border';break;}
case 'border-right-style':{SHORTHAND[i]=5;__shorthandIndexMap[i]='border';break;}
case 'border-right-color':{SHORTHAND[i]=6;__shorthandIndexMap[i]='border';break;}
case 'border-bottom-width':{SHORTHAND[i]=7;__shorthandIndexMap[i]='border';break;}
case 'border-bottom-style':{SHORTHAND[i]=8;__shorthandIndexMap[i]='border';break;}
case 'border-bottom-color':{SHORTHAND[i]=9;__shorthandIndexMap[i]='border';break;}
case 'border-left-width':{SHORTHAND[i]=10;__shorthandIndexMap[i]='border';break;}
case 'border-left-style':{SHORTHAND[i]=11;__shorthandIndexMap[i]='border';break;}
case 'border-left-color':{SHORTHAND[i]=12;__shorthandIndexMap[i]='border';break;}
case 'background-color':{SHORTHAND[i]=1;__shorthandIndexMap[i]='background';break;}
case 'background-image':{SHORTHAND[i]=2;__shorthandIndexMap[i]='background';break;}
case 'background-attachment':{SHORTHAND[i]=3;__shorthandIndexMap[i]='background';break;}
case 'background-repeat':{SHORTHAND[i]=4;__shorthandIndexMap[i]='background';break;}
case 'background-position':{SHORTHAND[i]=5;__shorthandIndexMap[i]='background';break;}
case 'list-style-type':{SHORTHAND[i]=1;__shorthandIndexMap[i]='list-style';break;}
case 'list-style-position':{SHORTHAND[i]=2;__shorthandIndexMap[i]='list-style';break;}
case 'list-style-image':{SHORTHAND[i]=3;__shorthandIndexMap[i]='list-style';break;}
case 'font-style':{SHORTHAND[i]=1;__shorthandIndexMap[i]='font';break;}
case 'font-variant':{SHORTHAND[i]=2;__shorthandIndexMap[i]='font';break;}
case 'font-weight':{SHORTHAND[i]=3;__shorthandIndexMap[i]='font';break;}
case 'font-size':{SHORTHAND[i]=4;__shorthandIndexMap[i]='font';break;}
case 'line-height':{line_height_index=i;SHORTHAND[i]=0;__shorthandIndexMap[i]='font';break;}
case 'font-family':{SHORTHAND[i]=6;__shorthandIndexMap[i]='font';break;}}}
temp.sort(function(a,b){return a.key<b.key?-1:a.key>b.key?1:0});for(i=0;prop=temp[i];i++){__sortedIndexMap[i]=prop.index;}
__indexMapLength=__indexMap.length;if(org_args&&(!org_args[0].__call_count||org_args[0].__call_count==1)){org_args[0].__call_count=org_args[0].__call_count?org_args[0].__call_count+1:1;org_args.callee.apply(null,org_args)}}}
var handleGetRulesWithIndex=function(xml,rt_id,index,org_args){var json=xml.getNodeData('rule-list');if(json){__rules[rt_id][index]=eval('('+json+')');__rules[rt_id][index]['runtime-id']=rt_id;if(org_args&&!org_args[0].__call_count){org_args[0].__call_count=1
org_args.callee.apply(null,org_args);}}}
var handleGetAllStylesheets=function(xml,rt_id,org_args){var json=xml.getNodeData('stylesheets');if(json){__sheets[rt_id]=eval('('+json+')');__sheets[rt_id]['runtime-id']=rt_id;__rules[rt_id]=[];if(org_args&&!org_args[0].__call_count){org_args[0].__call_count=1;org_args.callee.apply(null,org_args);}}}
var onRuntimeDestroyed=function(msg){if(__selectedRules&&__selectedRules.runtime_id==msg.id){views.stylesheets.clearAllContainers();}}
var onNewStylesheets=function(rt_id,cb_arr){if(__on_new_stylesheets_cbs[rt_id]){__on_new_stylesheets_cbs[rt_id][__on_new_stylesheets_cbs[rt_id].length]=cb_arr;}
else
{cb_arr[1].apply(cb_arr[0],cb_arr.slice(2));}}
var updateOnNewStylesheets=function(rt_ids){var
rt_id_c_1='',rt_id_c_2='',i=0;for(rt_id_c_1 in __on_new_stylesheets_cbs){for(i=0;(rt_id_c_2=rt_ids[i])&&rt_id_c_1!=rt_id_c_2;i++);if(!rt_id_c_2){delete __on_new_stylesheets_cbs[rt_id_c_1];}}
for(i=0;rt_id_c_1=rt_ids[i];i++){if(!(rt_id_c_1 in __on_new_stylesheets_cbs)){__on_new_stylesheets_cbs[rt_id_c_1]=[];}}
__new_rts=rt_ids;if(rt_ids[0]!=__top_rt_id){__top_rt_id=rt_ids[0];__selectedRules=null;views['stylesheets'].update();}}
var checkNewRts=function(obj){var
cursor=null,cbs=null,cb=null,i=0;for(i=0;cursor=__new_rts[i];i++){if(!__sheets[cursor]){delete obj.__call_count;self.getStylesheets(cursor,arguments);}
else
{if(cbs=__on_new_stylesheets_cbs[cursor]){for(i=0;cb=cbs[i];i++){cb[1].apply(cb[0],cb.slice(2));}
delete __on_new_stylesheets_cbs[cursor];}}}}
var onActiveTab=function(msg){if(__selectedRules){var rt_id=__selectedRules.runtime_id,cur_rt_id='',i=0;for(;(cur_rt_id=msg.activeTab[i])&&cur_rt_id!=rt_id;i++);if(!cur_rt_id){views.stylesheets.clearAllContainers();}}
updateOnNewStylesheets(msg.activeTab.slice(0));checkNewRts({});}
this.getSortedProperties=function(){var ret=[],i=0,dashs=[],value='';for(;i<__indexMapLength;i++){value=__indexMap[__sortedIndexMap[i]];if(value.indexOf('-')==0){dashs[dashs.length]=value;}
else
{ret[ret.length]=value;}}
return ret.concat(dashs);}
messages.addListener('runtime-destroyed',onRuntimeDestroyed);messages.addListener('active-tab',onActiveTab);messages.addListener('reset-state',onResetState);}
var cls=window.cls||(window.cls={});cls.CSSInspectorView=function(id,name,container_class){var self=this;this.createView=function(container){container.innerHTML='';var cats=elementStyle.getCategories(),cat_key='',cat=null,i=0;container.render(templates.cssInspector(cats));for(;cat=cats[i];i++){cat_key+=cat.unfolded?'1':'0';}
this.updateCategories({},cat_key);var quick_find=this.getToolbarControl(container,'css-inspector-text-search');if(quick_find&&elementStyle.getSearchTerm()){quick_find.value=elementStyle.getSearchTerm();quick_find.previousElementSibling.textContent="";}}
this.updateCategories=function(ev,cats){if(self.isvisible()){if(ev.__call_count&&ev.__call_count>2){opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'failed updateCategories, missing indexMap, views-css-inspector')
return;}
var containers=self.getAllContainers(),c=null,i=0;var styles=null,s_c=null,cat_index=0,data=null;var search_active=elementStyle.getSearchActive();for(;c=containers[i];i++){styles=c.getElementsByTagName('styles');if(!styles.length){this.createView(c);return;}
for(cat_index=0;cat_index<2;cat_index++){if(cats[cat_index]=='1'){data=elementStyle.getCategoryData(cat_index);if(data){styles[cat_index].innerHTML=stylesheets.prettyPrintCat(cat_index,data,arguments,search_active);styles[cat_index].setAttribute('rt-id',data.rt_id);}}}}}}
this.init(id,name,container_class);}
cls.CSSInspectorView.prototype=ViewBase;new cls.CSSInspectorView('css-inspector',ui_strings.M_VIEW_LABEL_STYLES,'scroll css-inspector');new Settings
('css-inspector',{'computedStyle':false,'css':true,'hide-initial-values':true,'hide-shorthands':true},{'hide-initial-values':ui_strings.S_SWITCH_SHOW_INITIAL_VALUES,'hide-shorthands':ui_strings.S_SWITCH_SHOW_SHORTHANDS},{checkboxes:['hide-initial-values','hide-shorthands',]});new ToolbarConfig
('css-inspector',null,[{handler:'css-inspector-text-search',title:'text search',label:ui_strings.S_INPUT_DEFAULT_TEXT_FILTER}])
new Switches
('css-inspector',['hide-initial-values','hide-shorthands',])
var cls=window.cls||(window.cls={});cls.CSSLayoutView=function(id,name,container_class){var self=this;this.createView=function(container){if(!container.getElementsByTagName('layout-container')[0]){container.innerHTML="<div class='padding'>\
          <h2>"+ui_strings.M_VIEW_SUB_LABEL_METRICS+"</h2>\
          <layout-container></layout-container>\
          <offsets-container></offsets-container>\
          </div>";}
this.updateLayout({});this.updateOffsets({});}
this.updateLayout=function(ev){var containers=self.getAllContainers(),c=null,i=0;for(;c=containers[i];i++){c=c.getElementsByTagName('layout-container')[0];if(elementLayout.getLayoutValues(arguments)){c.clearAndRender(elementLayout.metricsTemplate());}}}
this.updateOffsets=function(ev){var containers=self.getAllContainers(),c=null,i=0,data='';for(;c=containers[i];i++){c=c.getElementsByTagName('offsets-container')[0];if(elementLayout.getOffsetsValues(arguments)){c.innerHTML=elementLayout.prettyprintOffsetValues();}}}
this.init(id,name,container_class);var onSettingChange=function(msg){if(msg.id=="dom"
&&(msg.key=="show-siblings-in-breadcrumb"||msg.key=="show-id_and_classes-in-breadcrumb")){self.updateOffsets({});}}
messages.addListener("setting-changed",onSettingChange);}
cls.CSSLayoutView.prototype=ViewBase;new cls.CSSLayoutView('css-layout',ui_strings.M_VIEW_LABEL_LAYOUT,'scroll css-layout');var cls=window.cls||(window.cls={});cls.StylesheetsView=function(id,name,container_class){var self=this;this.createView=function(container){var selected_sheet=stylesheets.getSelectedSheet(arguments);if(selected_sheet){container.innerHTML="<div class='padding'>"+stylesheets.prettyPrintRules(selected_sheet.rules,settings[self.id].get('shortcuts'))+"</div>";if(selected_sheet.rule_id){var rules=container.getElementsByTagName('rule'),rule=null,i=0;for(;rule=rules[i];i++){if(rule.getAttribute('rule-id')==selected_sheet.rule_id){container.scrollTop=rule.offsetTop;break;}}}}
else
{container.innerHTML="<div class='info-box'><p>"+ui_strings.S_INFO_DOCUMENT_HAS_NO_STYLESHEETS+"</p></div>";}}
this.show=function(rules){if(!this.isvisible()){topCell.showView(this.id);}
var cs=this.getAllContainers(),c=null,i=0;for(;c=cs[i];i++){}}
this.init(id,name,container_class);}
cls.StylesheetsView.prototype=ViewBase;new cls.StylesheetsView('stylesheets',ui_strings.M_VIEW_LABEL_STYLESHEET,'scroll stylesheets');cls.StylesheetSelect=function(id,class_name){var selected_value="";var self=this;const
HREF=2,TITLE=7;this.getSelectedOptionText=function(){var
title=ui_strings.S_INFO_DOCUMENT_HAS_NO_STYLESHEETS,selected_sheet=stylesheets.getSelectedSheet(),sheet=null;if(selected_sheet){sheet=stylesheets.getSheetWithRtIdAndIndex(selected_sheet.runtime_id,selected_sheet.index);if(sheet){title=sheet[TITLE]||sheet[HREF]||'inline stylesheet '+(selected_sheet.index+1);}}
return title;}
this.getSelectedOptionValue=function(){}
this.templateOptionList=function(select_obj){var active_window_id=runtimes.getActiveWindowId();if(active_window_id){return templates.runtimes(runtimes.getRuntimes(active_window_id),'css');}
opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'no active window in templateOptionList in cls.StylesheetSelect');return[];}
this.checkChange=function(target_ele){var index=parseInt(target_ele.getAttribute('index'));var rt_id=target_ele.getAttribute('runtime-id');var rules=stylesheets.getRulesWithSheetIndex(rt_id,index,arguments);if(rules&&rules.index!=index){delete target_ele.__call_count;stylesheets.setSelectedSheet(rt_id,index,rules);views['stylesheets'].update();self.updateElement();}
return false;}
this.init(id,class_name);}
cls.StylesheetSelect.prototype=new CstSelect();new cls.StylesheetSelect('stylesheet-select','stylesheet-options');new Settings
('stylesheets',{'shortcuts':true},{'shortcuts':ui_strings.S_SWITCH_CREATE_SHORTHANDS},{checkboxes:['shortcuts']});new ToolbarConfig
('stylesheets',null,[{handler:'stylesheets-text-search',title:'text search'}],null,[{handler:'select-window',title:ui_strings.S_BUTTON_LABEL_SELECT_WINDOW,type:'dropdown',class:'window-select-dropdown',template:window['cst-selects']['stylesheet-select'].getTemplate()}])
new Switches
('stylesheets',['shortcuts']);(function(){var textSearch=new TextSearch();var onViewCreated=function(msg){if(msg.id=='stylesheets'){textSearch.setContainer(msg.container);textSearch.setFormInput(views.stylesheets.getToolbarControl(msg.container,'stylesheets-text-search'));}}
var onViewDestroyed=function(msg){if(msg.id=='stylesheets'){textSearch.cleanup();}}
messages.addListener('view-created',onViewCreated);messages.addListener('view-destroyed',onViewDestroyed);eventHandlers.input['stylesheets-text-search']=function(event,target){textSearch.searchDelayed(target.value);}
eventHandlers.keyup['stylesheets-text-search']=function(event,target){if(event.keyCode==13){textSearch.highlight();}}})();var cls=window.cls||(window.cls={});cls.JsSourceView=function(id,name,container_class){var self=this;var frame_id='js-source';var container_id='js-source-content';var container_line_nr_id='js-source-line-numbers';var scroll_id='js-source-scroller';var scroll_container_id='js-source-scroll-container';var container_breakpoints_id='break-point-container';var horizontal_scoller='js-source-scroll-content';var context={};var setup_map=[{id:frame_id,property:'height',target:'container-height',getValue:function(){return document.getElementById(this.id).clientHeight}},{id:'test-line-height',property:'lineHeight',target:'line-height',getValue:function(){return parseInt(document.getElementById(this.id).currentStyle[this.property])}},{id:'test-scrollbar-width',target:'scrollbar-width',getValue:function(){return(100-document.getElementById(this.id).offsetWidth)}}];var script={};var source_content=null;var line_numbers=null;var max_lines=0;var __current_line=0;var __current_pointer=0;var __current_pointer_type=0;var __scroll_interval=0;var __scrollEvent=0;var __target_scroll_top=-1;var __keyEvent=0;var __isHorizontalScrollbar=false;var __timeoutUpdateLayout=0;var templates={};var __timeout_clear_view=0;var __container=null;var view_invalid=true;templates.line_nummer_container=function(lines){var ret=['ul'],i=0;for(;i<lines;i++){ret[ret.length]=templates.line_nummer();}
return ret.concat(['id',container_line_nr_id]);}
templates.line_nummer=function(){return['li',['input','disabled','disabled'],['span','handler','set-break-point'],];}
var updateLineNumbers=function(fromLine){var lines=line_numbers.getElementsByTagName('input'),line=null,i=0;var breakpoints=line_numbers.getElementsByTagName('span');if(script.breakpoints){for(;line=lines[i];i++){line.value=fromLine++;}
updateBreakpoints();}
else
{lines[0].value=1;}}
var clearLineNumbers=function(){var lines=line_numbers.getElementsByTagName('input'),line=null,i=0;var breakpoints=line_numbers.getElementsByTagName('span');for(;line=lines[i];i++){if(i==0){line.value='1';}
else
{line.value='';}
breakpoints[i].style.removeProperty('background-position');}}
var updateBreakpoints=function(){var breakpoints=line_numbers.getElementsByTagName('span'),breakpoint=null,i=0;var script_breakpoints=script.breakpoints;var line_height=context['line-height'];if(script_breakpoints){for(;breakpoint=breakpoints[i];i++){if(script_breakpoints[__current_line+i]){breakpoint.style.backgroundPosition='0 '+(-1*script_breakpoints[__current_line+i]*line_height)+'px';}
else
{breakpoint.style.removeProperty('background-position');}}}}
this.createView=function(container){view_invalid=view_invalid
&&script.id
&&runtimes.getSelectedScript()
&&runtimes.getSelectedScript()!=script.id
||!runtimes.getSelectedScript();if(view_invalid){script={};__current_line=0;__current_pointer=0;__current_pointer_type=0;}
__container=container;frame_id=container.id;container.innerHTML=\
"<div id='js-source-scroll-content'>"+"<div id='js-source-content'></div>"+"</div>"+"<div id='js-source-scroll-container' handler='scroll-js-source'>"+"<div id='js-source-scroller'></div>"+"</div>";if(!context['line-height']){context['line-height']=defaults['js-source-line-height'];context['scrollbar-width']=defaults['scrollbar-width'];}
context['container-height']=parseInt(container.style.height);var set=null,i=0;source_content=document.getElementById(container_id);if(source_content){max_lines=context['container-height']/context['line-height']>>0;var lines=document.getElementById(container_line_nr_id);if(lines){lines.parentElement.removeChild(lines);}
container.render(templates.line_nummer_container(max_lines||1));line_numbers=document.getElementById(container_line_nr_id);var selected_script_id=runtimes.getSelectedScript();if(selected_script_id&&selected_script_id!=script.id){var stop_at=runtimes.getStoppedAt(selected_script_id);if(stop_at&&stop_at[0]){var line=parseInt(stop_at[0]['line-number']);var plus_lines=max_lines<=10
?max_lines/2>>0
:10;this.showLine(selected_script_id,line-plus_lines);this.showLinePointer(line,true);}
else
{this.showLine(selected_script_id,0);}}
else if(script.id){script.has_context=setScriptContext(script.id,__current_line);this.showLine(script.id,__current_line);}
else
{updateLineNumbers(0);if(runtimes.getSelectedRuntimeId()){document.getElementById('js-source-scroller').render(runtimes.isReloadedWindow(runtimes.getActiveWindowId())?
['div',['p',ui_strings.S_INFO_RUNTIME_HAS_NO_SCRIPTS],'class','info-box']:['div',['span','class','ui-button','handler','reload-window'],['p',ui_strings.S_INFO_RELOAD_FOR_SCRIPT],'class','info-box']);}
else
{document.getElementById('js-source-scroller').render(['div',['p',ui_strings.S_INFO_WINDOW_HAS_NO_RUNTIME],'class','info-box']);}}}}
this.onresize=function(container){if(this.isvisible()){this.createView(container);messages.post('view-created',{id:this.id,container:container});}}
var updateLayout=function(){if(source_content&&source_content.innerHTML){source_content.innerHTML='';}
if(!__timeoutUpdateLayout){__timeoutUpdateLayout=setTimeout(__updateLayout,60);}}
var __updateLayout=function(){if(script.line_arr){self.setup();setScriptContext(script.id,__current_line);self.showLine(script.id,__current_line);}
else
{self.setup(1);}
__timeoutUpdateLayout=0;}
var getMaxLineLength=function(){var time=new Date().getTime();var i=0,max=0,max_index=0,previous=0,line_arr=script.line_arr,length=line_arr.length;for(;i<length;i++){if((line_arr[i]-previous)>max){max=line_arr[i]-previous;max_index=i;}
previous=line_arr[i];}
return max_index;}
var updateScriptContext=function(){if(script.scrollWidth>script.offsetWidth){document.getElementById(scroll_container_id).style.bottom=context['scrollbar-width']+'px';source_content.style.width=script.scrollWidth+'px';}
else
{document.getElementById(scroll_container_id).style.removeProperty('bottom');source_content.style.removeProperty('width');}
document.getElementById(scroll_id).style.height=script.scrollHeight+'px';if(script.scrollHeight>context['line-height']*max_lines){document.getElementById(horizontal_scoller).style.right=context['scrollbar-width']+'px';}
else
{document.getElementById(horizontal_scoller).style.right='0px';}}
var setScriptContext=function(script_id,line_nr){source_content.innerHTML="<div style='visibility:hidden'>"+simple_js_parser.parse(script,getMaxLineLength()-1,1).join('')+"</div>";var scrollWidth=script.scrollWidth=source_content.firstChild.firstChild.scrollWidth;var offsetWidth=script.offsetWidth=source_content.firstChild.firstChild.offsetWidth;if(scrollWidth>offsetWidth){max_lines=(context['container-height']-context['scrollbar-width'])/context['line-height']>>0;}
else
{max_lines=context['container-height']/context['line-height']>>0;}
if(max_lines>script.line_arr.length){max_lines=script.line_arr.length;}
var lines=document.getElementById(container_line_nr_id);if(lines){lines.parentElement.removeChild(lines);}
document.getElementById(frame_id).render(templates.line_nummer_container(max_lines));line_numbers=document.getElementById(container_line_nr_id);source_content.style.height=(context['line-height']*max_lines)+'px';script.scrollHeight=script.line_arr.length*context['line-height'];updateScriptContext();return true;}
var clearScriptContext=function(){max_lines=1;document.getElementById(scroll_container_id).style.removeProperty('bottom');source_content.style.removeProperty('width');var lines=document.getElementById(container_line_nr_id);lines.parentElement.removeChild(lines);document.getElementById(frame_id).render(templates.line_nummer_container(max_lines));document.getElementById(scroll_id).style.height='auto';document.getElementById(horizontal_scoller).style.right='0px';}
this.showLine=function(script_id,line_nr,clear_scroll){if(__timeout_clear_view){__timeout_clear_view=clearTimeout(__timeout_clear_view);}
if(clear_scroll&&__scroll_interval){__scroll_interval=clearInterval(__scroll_interval);}
var is_visible=(source_content=document.getElementById(container_id))?true:false;if(script.id!=script_id){var script_obj=runtimes.getScript(script_id);if(script_obj){if(!script_obj.line_arr){script_obj.source_data=new String(script_obj['script-data']);script_obj.line_arr=[];script_obj.state_arr=[];pre_lexer(script_obj);}
script={id:script_id,source:script_obj.source_data,line_arr:script_obj.line_arr,state_arr:script_obj.state_arr,breakpoints:[],has_context:false}
var b_ps=runtimes.getBreakpoints(script_id),b_p='';if(b_ps){for(b_p in b_ps){script.breakpoints[parseInt(b_p)]=1;}}
__current_pointer=0;__current_pointer_type=0;if(is_visible){script.has_context=setScriptContext(script_id,line_nr);}
messages.post('script-selected',{script:script});}
else
{document.getElementById(scroll_id).innerHTML="";opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+"script source is missing for given id in views.js_source.showLine");return;}}
if(line_nr<1){line_nr=1;}
else if(line_nr>script.line_arr.length-max_lines){line_nr=script.line_arr.length-max_lines+1;}
__current_line=line_nr;if(is_visible){if(!script.has_context){script.has_context=setScriptContext(script_id,line_nr);}
if(view_invalid){updateScriptContext();}
source_content.innerHTML=simple_js_parser.parse(script,line_nr-1,max_lines-1).join('');updateLineNumbers(line_nr);if(!__scroll_interval){var scroll_container=document.getElementById(scroll_container_id),scroll_lines=scroll_container.scrollTop/context['line-height']>>0;if((scroll_lines<__current_line-5)||(scroll_lines>__current_line+6)){scroll_container.scrollTop=(__current_line-1)*context['line-height'];__target_scroll_top=scroll_container.scrollTop;}}}
view_invalid=false;if(!clear_scroll){messages.post
('view-scrolled',{id:this.id,top_line:this.getTopLine(),bottom_line:this.getBottomLine()});}
return is_visible;}
this.getTopLine=function(){return __current_line;}
this.getMaxLines=function(){return max_lines;}
this.getBottomLine=function(){return __current_line+max_lines;}
this.showLinePointer=function(line,is_top_frame){var script_breakpoints=script.breakpoints;if(!script_breakpoints){return;}
if(__current_pointer){script_breakpoints[__current_pointer]-=__current_pointer_type;}
__current_pointer=line;__current_pointer_type=is_top_frame?2:4;if(!script_breakpoints[line])script_breakpoints[line]=0;script_breakpoints[line]+=__current_pointer_type;updateBreakpoints();}
this.clearLinePointer=function(){if(__current_pointer){script.breakpoints[__current_pointer]-=__current_pointer_type;}
__current_pointer=0;__current_pointer_type=0;}
this.addBreakpoint=function(line){if(!script.breakpoints[line])script.breakpoints[line]=0;script.breakpoints[line]+=1;updateBreakpoints();}
this.removeBreakpoint=function(line){script.breakpoints[line]-=1;updateBreakpoints();}
this.scroll=function(){if(view_invalid){return;}
if(!__scroll_interval&&script.id){__scroll_interval=setInterval(__scroll,60);}
__scrollEvent=new Date().getTime()+100;}
var __scroll=function(){var top=document.getElementById(scroll_container_id).scrollTop;if(__target_scroll_top==top){__scroll_interval=clearInterval(__scroll_interval);}
else
{__target_scroll_top=-1;var target_line=(top/context['line-height']>>0)+1;if(__keyEvent){target_line=__keyEvent;}
if(new Date().getTime()>__scrollEvent){__scroll_interval=clearInterval(__scroll_interval);self.showLine(script.id,target_line);__keyEvent=0;}
else
{self.showLine(script.id,((__current_line+target_line)/2)>>0);}}}
this.scrollUp=function(){__keyEvent=__current_line-38;if(__keyEvent<1)__keyEvent=1;self.scroll();}
this.scrollDown=function(){__keyEvent=__current_line+38;self.scroll();}
this.getCurrentScriptId=function(){return script.id;}
this.getCurrentScriptId=function(){return script.id;}
this.clearView=function(){if(!__timeout_clear_view){__timeout_clear_view=setTimeout(__clearView,100);}}
var __clearView=function(){if((source_content=document.getElementById(container_id))&&source_content.parentElement){var
divs=source_content.parentElement.parentElement.getElementsByTagName('div'),div=null,i=0;source_content.innerHTML='';for(;div=divs[i];i++){div.removeAttribute('style');}
clearLineNumbers();}
self.clearLinePointer();__current_line=0;__timeout_clear_view=0;view_invalid=true;}
var onRuntimeDestroyed=function(msg){if(script&&runtimes.getRuntimeIdWithScriptId(script.id)==msg.id){__clearView();}}
this.init(id,name,container_class);messages.addListener('update-layout',updateLayout);messages.addListener('runtime-destroyed',onRuntimeDestroyed);}
cls.JsSourceView.prototype=ViewBase;new cls.JsSourceView('js_source',ui_strings.M_VIEW_LABEL_SOURCE,'scroll js-source');cls.helper_collection||(cls.helper_collection={});cls.helper_collection.getSelectedOptionText=function(){var selected_script_id=runtimes.getSelectedScript();if(selected_script_id){var script=runtimes.getScript(selected_script_id);var display_uri=helpers.shortenURI(script['uri']);if(script){return(display_uri.uri
?display_uri.uri
:ui_strings.S_TEXT_ECMA_SCRIPT_SCRIPT_ID+': '+script['script-id'])}
else
{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'missing script in getSelectedOptionText in cls.ScriptSelect');}}
else if(runtimes.getSelectedRuntimeId()&&
runtimes.isReloadedWindow(runtimes.getActiveWindowId())){return ui_strings.S_INFO_RUNTIME_HAS_NO_SCRIPTS;}
return '';}
cls.ScriptSelect=function(id,class_name){var selected_value="";var stopped_script_id='';this.getSelectedOptionText=cls.helper_collection.getSelectedOptionText;this.getSelectedOptionValue=function(){}
this.templateOptionList=function(select_obj){var active_window_id=runtimes.getActiveWindowId();if(active_window_id){var
_runtimes=runtimes.getRuntimes(active_window_id),rt=null,i=0;for(;(rt=_runtimes[i])&&!rt['selected'];i++);if(!rt&&_runtimes[0]){opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'no runtime selected')
return;}
return templates.runtimes(_runtimes,'script',[stopped_script_id,runtimes.getSelectedScript()]);}}
this.checkChange=function(target_ele){var script_id=target_ele.getAttribute('script-id');if(script_id){runtimes.setSelectedScript(script_id);topCell.showView(views.js_source.id);}
else
{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+"missing script id in handlers['display-script']")}
selected_value=target_ele.textContent;return true;}
var onThreadStopped=function(msg){stopped_script_id=msg.stop_at['script-id'];}
var onThreadContinue=function(msg){stopped_script_id='';}
messages.addListener("thread-stopped-event",onThreadStopped);messages.addListener("thread-continue-event",onThreadContinue);this.init(id,class_name);}
cls.ScriptSelect.prototype=new CstSelect();new cls.ScriptSelect('js-script-select','script-options');new ToolbarConfig
('js_source',[{handler:'continue',title:ui_strings.S_BUTTON_LABEL_CONTINUE,id:'continue-run',disabled:true},{handler:'continue',title:ui_strings.S_BUTTON_LABEL_STEP_INTO,id:'continue-step-into-call',disabled:true},{handler:'continue',title:ui_strings.S_BUTTON_LABEL_STEP_OVER,id:'continue-step-next-line',disabled:true},{handler:'continue',title:ui_strings.S_BUTTON_LABEL_STEP_OUT,id:'continue-step-out-of-call',disabled:true}],[{handler:'js-source-text-search',title:ui_strings.S_INPUT_DEFAULT_TEXT_SEARCH,label:ui_strings.S_INPUT_DEFAULT_TEXT_SEARCH}],null,[{handler:'select-window',title:ui_strings.S_BUTTON_LABEL_SELECT_WINDOW,type:'dropdown',class:'window-select-dropdown',template:window['cst-selects']["js-script-select"].getTemplate()}]);new Settings
('js_source',{script:0,exception:0,error:0,abort:0},{script:ui_strings.S_BUTTON_LABEL_STOP_AT_THREAD,exception:ui_strings.S_BUTTON_LABEL_AT_EXCEPTION,error:ui_strings.S_BUTTON_LABEL_AT_ERROR,abort:ui_strings.S_BUTTON_LABEL_AT_ABORT},{checkboxes:['script','exception','error','abort']});new Switches
('js_source',['script','error','threads.log-threads']);(function(){var textSearch=new VirtualTextSearch();var onViewCreated=function(msg){if(msg.id=='js_source'){textSearch.setContainer(msg.container);textSearch.setFormInput(views.js_source.getToolbarControl(msg.container,'js-source-text-search'));}}
var onViewDestroyed=function(msg){if(msg.id=='js_source'){textSearch.cleanup();}}
var onScriptSeleceted=function(msg){textSearch.setScript(msg.script);}
var onViewScrolled=function(msg){if(msg.id=='js_source'){textSearch.checkHit(msg.top_line,msg.bottom_line);}}
messages.addListener('view-created',onViewCreated);messages.addListener('view-destroyed',onViewDestroyed);messages.addListener('script-selected',onScriptSeleceted);messages.addListener('view-scrolled',onViewScrolled);eventHandlers.input['js-source-text-search']=function(event,target){textSearch.searchDelayed(target.value);}
eventHandlers.keyup['js-source-text-search']=function(event,target){if(event.keyCode==13){textSearch.highlight();}}})()
var cls=window.cls||(window.cls={});cls.CommandLineView=function(id,name,container_class,html,default_handler){var self=this;var __frame_index=-1;var __container=null;var __console_output=null;var __console_input=null;var __prefix=null;var __textarea=null;var __textarea_value='';var submit_buffer=[];var line_buffer=[];var line_buffer_cursor=0;var __selection_start=-1;var __selection_end=0;var __is_tab=false;var console_output_data=[];var toolbar_visibility=true;var cons_out_render_return_val=function(entry){if(__console_output){__console_output.render
(['pre',entry.value].concat
(entry.obj_id
?['handler','inspect-object-link','rt-id',entry.runtime_id,'obj-id',entry.obj_id]
:[]));}}
var cons_out_render_input=function(entry){if(__console_output){__console_output.render(['div',entry.value,'class','log-entry']);}}
var type_map={"return-value":cons_out_render_return_val,"input-value":cons_out_render_input}
var cons_out_update=function(){if(__console_output){__console_output.innerHTML='';var entry=null,i=0;for(;entry=console_output_data[i];i++){type_map[entry.type](entry);}
__container.scrollTop=__container.scrollHeight;};if(__textarea){__textarea.value=__textarea_value;__textarea.selectionEnd=__textarea.selectionStart=__textarea_value.length;__textarea.focus();};}
var handleEval=function(xml,runtime_id,obj_id,callback){var value_type=xml.getNodeData('data-type');var status=xml.getNodeData('status');if(status=='completed'){var return_value=xml.getElementsByTagName('string')[0];if(return_value||/null|undefined/.test(value_type)){var value=return_value&&return_value.firstChild&&
return_value.firstChild.nodeValue||'';if(!obj_id){switch(value_type){case 'string':{value='"'+value+'"';break;}
case 'null':case 'undefined':{value=value_type;break;}}}
if(callback){callback(runtime_id,obj_id);}
cons_out_render_return_val
(console_output_data[console_output_data.length]={type:"return-value",obj_id:obj_id,runtime_id:runtime_id,value:value});__container.scrollTop=__container.scrollHeight;}
else if(return_value=xml.getElementsByTagName('object-id')[0]){var object_id=return_value.textContent;var object_ref_name="$"+object_id;var tag=tagManager.setCB(null,handleEval,[runtime_id,object_id,callback]);var script_string="return Object.prototype.toString.call("+object_ref_name+")";services['ecmascript-debugger'].eval(tag,runtime_id,'','',script_string,[object_ref_name,object_id]);}}
else
{var error_id=xml.getNodeData('object-id');if(error_id){var tag=tagManager.setCB(null,handleError);services['ecmascript-debugger'].examineObjects(tag,runtime_id,error_id);}}}
var handleError=function(xml){var return_value=xml.getElementsByTagName('string')[0];if(return_value){cons_out_render_return_val
(console_output_data[console_output_data.length]={type:"return-value",value:return_value.firstChild.nodeValue});__container.scrollTop=__container.scrollHeight;}}
var markup="\
    <div class='padding'>\
      <div class='console-output'></div>\
      <div class='console-input' handler='console-focus-input'>\
        <span class='commandline-prefix'>&gt;&gt;&gt; </span>\
        <div><textarea handler='commandline' rows='1' title='hold shift to add a new line'></textarea></div>\
      </div>\
    </div>";var templates={};templates.consoleInput=function(entry){var lines_count=entry.msg.split(/\r?\n/).length;var line_head='>>>';while(--lines_count>1){line_head+='\n...';}
return[['div',line_head],['pre',entry.msg]];}
eventHandlers.click['console-focus-input']=function(event,ele){ele.getElementsByTagName('textarea')[0].focus();}
var dir_obj=function(rt_id,obj_id){messages.post('active-inspection-type',{inspection_type:'object'});topCell.showView(views.inspection.id);messages.post('object-selected',{rt_id:rt_id,obj_id:obj_id});}
var command_map={"clear":function(rt_id,frame_id,thread_id,script_string){console_output_data=[];cons_out_update();},"dir":function(rt_id,frame_id,thread_id,script_string){var tag=tagManager.setCB(null,handleEval,[rt_id,null,dir_obj]);services['ecmascript-debugger'].eval(tag,rt_id,thread_id,frame_id,script_string);}};var submit=function(input){var
rt_id=runtimes.getSelectedRuntimeId(),frame_id='',thread_id='',script_string='',command='',opening_brace=0,closing_brace=0,tag=0;if(rt_id){if(__frame_index>-1){frame_id=__frame_index;thread_id=stop_at.getThreadId();}
script_string=submit_buffer.join('');opening_brace=script_string.indexOf('(');command=(opening_brace!=-1&&script_string.slice(0,opening_brace)||'').
replace(/ +$/,'').replace(/^ +/,'');closing_brace=script_string.lastIndexOf(')');if(command&&command in command_map&&closing_brace!=-1){command_map[command](rt_id,frame_id,thread_id,script_string.slice(opening_brace+1,closing_brace));}
else if(!/^\s*$/.test(script_string)){tag=tagManager.setCB(null,handleEval,[rt_id]);services['ecmascript-debugger'].eval(tag,rt_id,thread_id,frame_id,script_string);}
submit_buffer=[];}
else
{alert(ui_strings.S_INFO_NO_RUNTIME_SELECTED);}}
var line_buffer_push=function(line){line=line.replace(/\r\n/g,"");var index=line_buffer.indexOf(line);if(index!=-1){line_buffer.splice(index,1);}
line_buffer[line_buffer.length]=line;if(line_buffer.length>100){line_buffer=line_buffer.slice(line_buffer.length-100);}
line_buffer_cursor=line_buffer.length;}
eventHandlers.keydown['commandline']=function(event){switch(event.keyCode){case 46:case 8:{__is_tab=false;}
case 16:case 17:case 18:{break;}
case 9:{__is_tab=true;break;}
default:{if(__is_tab){if(__selection_start==event.target.selectionStart&&
__selection_end==event.target.selectionEnd){event.target.selectionStart=__selection_end;}
__is_tab=false;}}}}
eventHandlers.keyup['commandline']=function(event){if(event.keyCode==38||event.keyCode==40){event.preventDefault();return;}
const CRLF="\r\n";var value=event.target.value;var lastCRLFIndex=value.lastIndexOf(CRLF);if(lastCRLFIndex!=-1){if(value.length-2!=lastCRLFIndex){value=value.slice(0,lastCRLFIndex)+value.slice(lastCRLFIndex+2)+CRLF;}
cons_out_render_input
(console_output_data[console_output_data.length]={type:"input-value",value:(submit_buffer.length?"... ":">>> ")+value});line_buffer_push(submit_buffer[submit_buffer.length]=value);if(!event.shiftKey){submit();}
__prefix.textContent=submit_buffer.length?"... ":">>> ";event.target.value='';__container.scrollTop=__container.scrollHeight;__textarea.scrollTop=0;}
__textarea_value=event.target.value;}
eventHandlers.keypress['commandline']=function(event){var target=event.target,key_code=event.keyCode;if(!(event.shiftKey||event.ctrlKey||event.altKey)){switch(key_code){case 38:case 40:{if(!event.which){line_buffer_cursor+=key_code==38?-1:1;line_buffer_cursor=line_buffer_cursor<0?line_buffer.length-1:line_buffer_cursor>line_buffer.length-1?0:line_buffer_cursor;__textarea_value=event.target.value=(line_buffer.length?line_buffer[line_buffer_cursor]:'').replace(/\r\n/g,'');event.preventDefault();break;}}
case 16:case 9:{break;}
default:{__selection_start=-1;}}}
if(key_code==9){event.preventDefault();if(__selection_start==-1){__selection_start=target.selectionStart;}
var cur_str=target.value.slice(0,__selection_start);var suggest=autocomplete.getSuggest(cur_str,event.shiftKey,arguments);if(suggest){target.value=cur_str+suggest;target.selectionStart=__selection_start;target.selectionEnd=__selection_end=target.value.length;}}}
var autocomplete=new function(){var str_input='';var path='';var id='';var scope=null;var current_path='';var match=[];var match_cur=0;var local_frame_index=0;var _shift_key=false;const
SCRIPT="(function(){var a = '', b= ''; for( a in %s ){ b += a + '_,_'; }; return b; })()",KEY=0,DEPTH=3;var get_scope=function(path,old_args){var
rt_id=runtimes.getSelectedRuntimeId(),frame_id='',thread_id='';if(rt_id){if(!path&&__frame_index==-1){path='this';}
if(__frame_index.toString()+rt_id+path==current_path){return scope;}
if(__frame_index>-1){frame_id=__frame_index;thread_id=stop_at.getThreadId();if(!path){var selectedObject=frame_inspection_data.getSelectedObject()
var data=frame_inspection_data.getData(selectedObject.rt_id,selectedObject.obj_id,-1,arguments);if(data){var i=2,prop=null;scope=[];for(;prop=data[i];i++){if(prop[DEPTH]==0){scope[scope.length]=prop[KEY];}}
current_path=__frame_index.toString()+rt_id+path;return scope;}
else
{return null;}}}
var tag=tagManager.setCB(null,handleEvalScope,[__frame_index,rt_id,path,old_args]);services['ecmascript-debugger'].eval(tag,rt_id,thread_id,frame_id,SCRIPT.replace(/%s/,path));}
else
{alert('select a window');}
return null;}
var handleEvalScope=function(xml,__frame_index,rt_id,path,old_args){var status=xml.getNodeData('status');if(status=='completed'){var return_value=xml.getElementsByTagName('string')[0];if(return_value){scope=return_value.textContent.split('_,_');current_path=__frame_index.toString()+rt_id+path;if(!old_args[0].__call_count){old_args[0].__call_count=1;old_args.callee.call(null,old_args[0]);}}}
else
{str_input=current_path='';opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+"getting scope failed in autocomplete view-commandline");}}
this._move_match_cursor=function(shift_key,delta){if(shift_key){match_cur-=delta||1;if(match_cur<0){match_cur=match.length?match.length-1:0;}}
else
{match_cur+=delta||1;if(match_cur>=match.length){match_cur=0;}}
return shift_key;}
this.getSuggest=function(str,shift_key,old_args){if(match.length&&shift_key!=_shift_key){_shift_key=this._move_match_cursor(shift_key,2);}
if(!str||str!=str_input){var last_bracket=str.lastIndexOf('['),last_brace=str.lastIndexOf('(');last_brace=str.lastIndexOf(')')<=last_brace?last_brace:-1;last_bracket=str.lastIndexOf(']')<=last_bracket?last_bracket:-1;str=str.slice(Math.max(last_brace,last_bracket,str.lastIndexOf('='))+1).replace(/^ +/,'').replace(/ $/,'');var
last_dot=str.lastIndexOf('.'),new_path='',new_id='',ret='';if(last_dot>-1){new_path=str.slice(0,last_dot);new_id=str.slice(last_dot+1);}
else
{new_id=str;}
if(path!=new_path||!scope){match=[];if(!(scope=get_scope(new_path,old_args))){return '';}
path=new_path;}
if(!match.length||id!=new_id){match=[];match_cur=0;var prop='',i=0;for(;prop=scope[i];i++){if(prop.indexOf(new_id)==0){match[match.length]=prop;}}
id=new_id;}
str_input=str;}
ret=match[match_cur]||'';this._move_match_cursor(shift_key);return ret.slice(id.length);}
this.clear=function(frame_index){if(frame_index>-1||frame_index!=local_frame_index){local_frame_index=-1;str_input='';path='';id='';scope=null;current_path='';match=[];match_cur=0;}};};this.createView=function(container){checkToolbarVisibility();container.innerHTML=markup;container.scrollTop=container.scrollHeight;__container=container;__console_output=container.getElementsByTagName('div')[1];__console_input=container.getElementsByTagName('div')[2];__prefix=__console_input.getElementsByTagName('span')[0];__textarea=container.getElementsByTagName('textarea')[0];cons_out_update();}
this.ondestroy=function(){__console_output=null;__console_input=null;__prefix=null;}
var onFrameSelected=function(msg){__frame_index=msg.frame_index;autocomplete.clear(__frame_index);}
var onConsoleMessage=function(msg){if(settings['command_line'].get('show-ecma-errors')&&msg['source']=='ecmascript'){cons_out_render_return_val
(console_output_data[console_output_data.length]={type:"return-value",value:msg['context']+'\n'+msg['description']});if(__container){__container.scrollTop=__container.scrollHeight;}}}
var checkToolbarVisibility=function(msg){var isMultiRuntime=host_tabs.isMultiRuntime();if(toolbar_visibility!=isMultiRuntime){topCell.setTooolbarVisibility('command_line',toolbar_visibility=isMultiRuntime);}}
messages.addListener('frame-selected',onFrameSelected);messages.addListener('console-message',onConsoleMessage);messages.addListener('active-tab',checkToolbarVisibility);this.init(id,name,container_class,html,default_handler);}
cls.CommandLineView.prototype=ViewBase;new cls.CommandLineView('command_line',ui_strings.M_VIEW_LABEL_COMMAND_LINE,'scroll','','cmd-focus');new Settings
('command_line',{"show-ecma-errors":true,},{"show-ecma-errors":ui_strings.S_SWITCH_SHOW_ECMA_ERRORS_IN_COMMAND_LINE},{checkboxes:["show-ecma-errors"]});eventHandlers.click['cmd-focus']=function(event,target){target.getElementsByTagName('textarea')[0].focus();}
cls.CndRtSelect=function(id,class_name){var selected_value="";this.getSelectedOptionText=function(){var selected_rt_id=runtimes.getSelectedRuntimeId();if(selected_rt_id){var rt=runtimes.getRuntime(selected_rt_id);if(rt){return rt['title']||helpers.shortenURI(rt['uri']).uri;}}
return '';}
this.getSelectedOptionValue=function(){}
this.templateOptionList=function(select_obj){var active_window_id=runtimes.getActiveWindowId();if(active_window_id){var
_runtimes=runtimes.getRuntimes(active_window_id),rt=null,i=0;for(;(rt=_runtimes[i])&&!rt['selected'];i++);if(!rt&&_runtimes[0]){opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'no runtime selected')
return;}
return templates.runtimes(_runtimes,'runtime');}}
this.checkChange=function(target_ele){var rt_id=target_ele.getAttribute('rt-id');if(rt_id&&rt_id!=runtimes.getSelectedRuntimeId()){runtimes.setSelectedRuntimeId(rt_id)}
return true;}
this.init(id,class_name);}
cls.CndRtSelect.prototype=new CstSelect();new cls.CndRtSelect('cmd-runtime-select','cmd-line-runtimes');new ToolbarConfig
('command_line',null,null,null,[{handler:'select-window',title:ui_strings.S_BUTTON_LABEL_SELECT_WINDOW,type:'dropdown',class:'window-select-dropdown',template:window['cst-selects']['cmd-runtime-select'].getTemplate()}]);var cls=window.cls||(window.cls={});cls.InspectionView=function(id,name,container_class){var self=this;var cur_data='frame_inspection_data';this.createView=function(container){var
data_model=window[cur_data],selectedObject=data_model.getSelectedObject(),data=null,use_filter=settings['inspection'].get("hide-default-properties");if(selectedObject){data=data_model.getData(selectedObject.rt_id,selectedObject.obj_id,-1,arguments);if(data){delete container.__call_count;container.innerHTML="<examine-objects rt-id='"+selectedObject.rt_id+"' "+"data-id="+cur_data+" "+"obj-id='"+selectedObject.obj_id+"' >"+"<start-search-scope></start-search-scope>"+data_model.prettyPrint(data,-1,use_filter,data_model.filter_type)+"<end-search-scope></end-search-scope>"+"</examine-objects>";messages.post
('list-search-context',{'data_id':cur_data,'rt_id':selectedObject.rt_id,'obj_id':selectedObject.obj_id,'depth':'-1'});}}
else
{container.innerHTML="";}}
this.clearView=function(){}
this.init(id,name,container_class);var onActiveInspectionType=function(msg){cur_data=msg.inspection_type+'_inspection_data';}
messages.addListener('active-inspection-type',onActiveInspectionType);}
cls.InspectionView.prototype=ViewBase;new cls.InspectionView('inspection',ui_strings.M_VIEW_LABEL_FRAME_INSPECTION,'scroll');new Settings
('inspection',{'automatic-update-global-scope':false,'hide-default-properties':true},{'automatic-update-global-scope':ui_strings.S_SWITCH_UPDATE_GLOBAL_SCOPE,'hide-default-properties':ui_strings.S_BUTTON_LABEL_HIDE_DEFAULT_PROPS_IN_GLOBAL_SCOPE},{checkboxes:['hide-default-properties']});new ToolbarConfig
('inspection',null,[{handler:'inspection-text-search',title:ui_strings.S_INPUT_DEFAULT_TEXT_FILTER,label:ui_strings.S_INPUT_DEFAULT_TEXT_FILTER}])
new Switches
('inspection',["hide-default-properties"]);(function(){var listTextSearch=new ListTextSearch();var onViewCreated=function(msg){if(msg.id=='inspection'){listTextSearch.setContainer(msg.container);}}
var onViewDestroyed=function(msg){if(msg.id=='inspection'){listTextSearch.cleanup();}}
var onListSearchContext=function(msg){if(msg.data_id=='inspection'){listTextSearch.onNewContext(msg);}}
messages.addListener('view-created',onViewCreated);messages.addListener('view-destroyed',onViewDestroyed);messages.addListener('list-search-context',onListSearchContext);eventHandlers.input['inspection-text-search']=function(event,target){listTextSearch.setInput(target);listTextSearch.searchDelayed(target.value);}
eventHandlers.keyup['inspection-text-search']=function(event,target){listTextSearch.handleKey(event,target);}})()
var DOM_markup_style=function(id,name,container_class){var self=this;const
ID=0,TYPE=1,NAME=2,DEPTH=3,NAMESPACE=4,VALUE=4,ATTRS=5,ATTR_PREFIX=0,ATTR_KEY=1,ATTR_VALUE=2,CHILDREN_LENGTH=6,PUBLIC_ID=4,SYSTEM_ID=5,INDENT="  ",LINEBREAK='\n';var getIndent=function(count){var ret='';if(count){count--;}
while(count){ret+=INDENT;count--;}
return ret;};var div_padding_value=0;this.updateTarget=function(ele,obj_id){if(ele){var target=document.getElementById('target-element');if(target){target.removeAttribute('id');}
if(/<\//.test(ele.firstChild.nodeValue)){while((ele=ele.previousSibling)&&ele.getAttribute('ref-id')!=obj_id);}
if(ele){ele.id='target-element';}
topCell.statusbar.updateInfo(templates.breadcrumb(dom_data.getCSSPath()));}
else
{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+"missing implementation in updateTarget in views['dom-inspector']");}}
var formatProcessingInstructionValue=function(str,force_lower_case){var r_attrs=str.split(' '),r_attr='',i=0,attrs='',attr=null;for(;i<r_attrs.length;i++){if(r_attr=r_attrs[i]){attr=r_attr.split('=');attrs+=" <key>"+(force_lower_case?attr[0].toLowerCase():attr[0])+"</key>=<value>"+attr[1]+"</value>";}}
return attrs;}
this.createView=function(container){if(container.hasClass('tree-style')){container.removeClass('tree-style');}
var data=dom_data.getData();var
tree="<div class='padding' edit-handler='edit-dom' rt-id='"+dom_data.getDataRuntimeId()+"'>",i=0,node=null,length=data.length;var target=dom_data.getCurrentTarget();var attrs=null,attr=null,k=0,key='';var is_open=0;var has_only_one_child=0;var one_child_id="";var one_child_value=''
var current_depth=0;var child_pointer=0;var child_level=0;var j=0;var children_length=0;var closing_tags=[];var force_lower_case=dom_data.isTextHtml()&&settings[this.id].get('force-lowercase');var show_comments=settings[this.id].get('show-comments');var show_attrs=settings[this.id].get('show-attributes');var node_name='';var tag_head='';var class_name='';var re_formatted=/script|style|#comment/i;var scrollTop=0;var container_scroll_width=0;var container_first_child=null;var style=null;var is_not_script_node=true;if(!data.length){if(!dom_data.getDataRuntimeId()){container.innerHTML="<div class='padding'><div class='info-box'>"+ui_strings.S_INFO_WINDOW_HAS_NO_RUNTIME+"</div></div>";}
else
{container.innerHTML="<div class='padding' edit-handler='edit-dom'><p></p></div>";}
topCell.statusbar.updateInfo('');}
else
{for(;node=data[i];i+=1){while(current_depth>node[DEPTH]){tree+=closing_tags.pop();current_depth--;}
current_depth=node[DEPTH];children_length=node[CHILDREN_LENGTH];child_pointer=0;node_name=(node[NAMESPACE]?node[NAMESPACE]+':':'')+node[NAME];if(force_lower_case){node_name=node_name.toLowerCase();}
switch(node[TYPE]){case 1:{is_not_script_node=node[NAME].toLowerCase()!='script';if(show_attrs){attrs='';for(k=0;attr=node[ATTRS][k];k++){attrs+=" <key>"+(attr[ATTR_PREFIX]?attr[ATTR_PREFIX]+':':'')+(force_lower_case?attr[ATTR_KEY].toLowerCase():attr[ATTR_KEY])+"</key>=<value"+(/^href|src$/i.test(attr[ATTR_KEY])
?" handler='dom-resource-link'"
:"")+">\""+attr[ATTR_VALUE]+"\"</value>";}}
else
{attrs='';}
child_pointer=i+1;is_open=(data[child_pointer]&&(node[DEPTH]<data[child_pointer][DEPTH]));if(is_open){has_only_one_child=1;one_child_value='';child_level=data[child_pointer][DEPTH];for(;data[child_pointer]&&data[child_pointer][DEPTH]==child_level;child_pointer+=1){one_child_value+=data[child_pointer][VALUE];one_child_id=data[child_pointer][ID];if(data[child_pointer][TYPE]!=3){has_only_one_child=0;one_child_value='';break;}}}
if(is_open){if(has_only_one_child){class_name=re_formatted.test(node_name)?" class='pre-wrap'":'';tree+="<div "+(node[ID]==target?"id='target-element'":'')+" style='margin-left:"+16*node[DEPTH]+"px;' "+"ref-id='"+node[ID]+"' handler='spotlight-node' "+class_name+">"+"<node>&lt;"+node_name+attrs+"&gt;</node>"+"<text"+(is_not_script_node?" ref-id='"+one_child_id+"' ":"")+"'>"+one_child_value+"</text>"+"<node>&lt;/"+node_name+"&gt;</node>"+"</div>";i=child_pointer-1;}
else
{tree+="<div "+(node[ID]==target?"id='target-element'":'')+" style='margin-left:"+16*node[DEPTH]+"px;' "+"ref-id='"+node[ID]+"' handler='spotlight-node'>"+(node[CHILDREN_LENGTH]?
"<input handler='get-children' type='button' class='open'>":'')+"<node>&lt;"+node_name+attrs+"&gt;</node>"+"</div>";closing_tags.push("<div style='margin-left:"+(16*node[DEPTH])+"px;' "+"ref-id='"+node[ID]+"' handler='spotlight-node'><node>"+"&lt;/"+node_name+"&gt;"+"</node></div>");}}
else
{tree+="<div "+(node[ID]==target?"id='target-element'":'')+" style='margin-left:"+16*node[DEPTH]+"px;' "+"ref-id='"+node[ID]+"' handler='spotlight-node'>"+(children_length?
"<input handler='get-children' type='button' class='close'>":'')+"<node>&lt;"+node_name+attrs+(children_length?'':'/')+"&gt;</node>"+"</div>";}
break;}
case 7:{tree+="<div style='margin-left:"+16*node[DEPTH]+"px;' "+"class='processing-instruction'>&lt;?"+node[NAME]+' '+formatProcessingInstructionValue(node[VALUE],force_lower_case)+"?&gt;</div>";break;}
case 8:{if(show_comments){if(!/^\s*$/.test(node[VALUE])){tree+="<div style='margin-left:"+16*node[DEPTH]+"px;' "+"class='comment pre-wrap'>&lt;!--"+node[VALUE]+"--&gt;</div>";}}
break;}
case 9:{break;}
case 10:{tree+="<div style='margin-left:"+16*node[DEPTH]+"px;' class='doctype'>"+"&lt;!doctype "+this.getDoctypeName(data)+(node[PUBLIC_ID]?
(" PUBLIC "+"\""+node[PUBLIC_ID]+"\""):"")+(node[SYSTEM_ID]?
(" \""+node[SYSTEM_ID]+"\""):"")+"&gt;</div>";break;}
default:{if(!/^\s*$/.test(node[VALUE])){tree+=
"<div style='margin-left:"+(16*node[DEPTH])+"px;'>"+"<text"+(is_not_script_node?" ref-id='"+node[ID]+"' ":"")+">"+node[VALUE]+"</text>"+"</div>";}}}}
while(closing_tags.length){tree+=closing_tags.pop();}
tree+="</div>";scrollTop=container.scrollTop;container.innerHTML=tree;container.scrollTop=scrollTop;container_scroll_width=container.scrollWidth;container_first_child=container.firstChild;if(container_scroll_width>container_first_child.offsetWidth){if(!div_padding_value){style=getComputedStyle(container_first_child,null);div_padding_value=\
parseInt(style.getPropertyValue('padding-left'))+parseInt(style.getPropertyValue('padding-right'));}
container.firstChild.style.width=(container_scroll_width-div_padding_value)+'px';setTimeout(function(){container.scrollLeft=0;},0);}
topCell.statusbar.updateInfo(templates.breadcrumb(dom_data.getCSSPath()));}}}
var DOM_tree_style=function(id,name,container_class){var self=this;const
ID=0,TYPE=1,NAME=2,DEPTH=3,NAMESPACE=4,VALUE=4,ATTRS=5,ATTR_PREFIX=0,ATTR_KEY=1,ATTR_VALUE=2,CHILDREN_LENGTH=6,PUBLIC_ID=4,SYSTEM_ID=5;var map={'\t':'\\t','\v':'\\v','\f':'\\f','\u0020':'\\u0020','\u00A0':'\\u00A0','\r':'\\r','\n':'\\n','\u2028':'\\u2028','\u2029':'\\u2029'};var _escape=function(string){string=new String(string);var _char='',i=0,ret='';for(;_char=string.charAt(i);i++){ret+=map[_char];}
return ret;}
var nodeNameMap={3:"<span class='text-node'>#text</span>",4:"<span class='cdata-node'>#cdata-section</span>"}
var div_padding_value=0;this.updateTarget=function(ele){if(ele){var target=document.getElementById('target-element');if(target){target.removeAttribute('id');}
ele.id='target-element';topCell.statusbar.updateInfo(templates.breadcrumb(dom_data.getCSSPath()));}
else
{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+"missing implementation in updateTarget in views['dom-inspector']");}}
this.createView=function(container){if(!container.hasClass('tree-style')){container.addClass('tree-style');}
const
ID=0,TYPE=1,NAME=2,DEPTH=3,NAMESPACE=4,VALUE=4,ATTRS=5,ATTR_PREFIX=0,ATTR_KEY=1,ATTR_VALUE=2,CHILDREN_LENGTH=6,PUBLIC_ID=4,SYSTEM_ID=5;var data=dom_data.getData();var target=dom_data.getCurrentTarget();var
tree="<div class='padding' edit-handler='edit-dom' rt-id='"+dom_data.getDataRuntimeId()+"'><div>",i=0,node=null,length=data.length;var scrollTop=document.documentElement.scrollTop;var attrs=null,key='';var is_open=0;var has_only_one_child=0;var one_child_value=''
var current_depth=0;var child_pointer=0;var child_level=0;var j=0;var k=0;var children_length=0;var closing_tags=[];var force_lower_case=dom_data.isTextHtml()&&settings[this.id].get('force-lowercase');var show_comments=settings[this.id].get('show-comments');var show_attrs=settings[this.id].get('show-attributes');var show_white_space_nodes=settings[this.id].get('show-whitespace-nodes');var node_name='';var tag_head='';var current_formatting='';var re_formatted=/script|style/i;var scrollTop=0;var container_scroll_width=0;var container_first_child=null;var style=null;var is_not_script_node=true;var graphic_arr=[];if(!data.length){if(!dom_data.getDataRuntimeId()){container.innerHTML="<div class='padding'><div class='info-box'>"+ui_strings.S_INFO_WINDOW_HAS_NO_RUNTIME+"</div></div>";}
else
{container.innerHTML="<div class='padding' edit-handler='edit-dom'><p></p></div>";}
topCell.statusbar.updateInfo('');}
else
{for(;node=data[i];i+=1){current_depth=node[DEPTH];children_length=node[CHILDREN_LENGTH];child_pointer=0;node_name=(node[NAMESPACE]?node[NAMESPACE]+':':'')+node[NAME];if(force_lower_case){node_name=node_name.toLowerCase();}
switch(node[TYPE]){case 1:{is_not_script_node=node[NAME].toLowerCase()!='script';attrs='';if(show_attrs){for(k=0;attr=node[ATTRS][k];k++){attrs+=" <key>"+(attr[ATTR_PREFIX]?attr[ATTR_PREFIX]+':':'')+(force_lower_case?attr[ATTR_KEY].toLowerCase():attr[ATTR_KEY])+"</key>=<value"+(/^href|src$/i.test(attr[ATTR_KEY])
?" handler='dom-resource-link'"
:"")+">\""+attr[ATTR_VALUE]+"\"</value>";}}
child_pointer=i+1;is_open=(data[child_pointer]&&(node[DEPTH]<data[child_pointer][DEPTH]));if(is_open){has_only_one_child=1;one_child_value='';child_level=data[child_pointer][DEPTH];for(;data[child_pointer]&&data[child_pointer][DEPTH]==child_level;child_pointer+=1){one_child_value+=data[child_pointer][VALUE];if(data[child_pointer][TYPE]!=3){has_only_one_child=0;one_child_value='';break;}}}
if(is_open){tree+="<div "+(node[ID]==target?"id='target-element'":'')+" style='margin-left:"+16*node[DEPTH]+"px;' "+"ref-id='"+node[ID]+"' handler='spotlight-node'>"+(children_length&&!has_only_one_child?
"<input handler='get-children' type='button' class='open'>":'')+"<node>"+node_name+attrs+"</node>"+"</div>";}
else
{tree+="<div "+(node[ID]==target?"id='target-element'":'')+" style='margin-left:"+16*node[DEPTH]+"px;' "+"ref-id='"+node[ID]+"' handler='spotlight-node'>"+(node[CHILDREN_LENGTH]?
"<input handler='get-children' type='button' class='close'>":'')+"<node>"+node_name+attrs+"</node>"+"</div>";}
current_formatting=re_formatted.test(node_name)&&" class='pre-wrap'"||"";break;}
case 8:{if(show_comments){tree+="<div style='margin-left:"+16*node[DEPTH]+"px;' "+"class='comment pre-wrap'><span class='comment-node'>#comment</span>"+node[VALUE]+"</div>";}
break;}
case 9:{tree+="<div style='margin-left:"+16*node[DEPTH]+"px;' "+"><span class='document-node'>#document</span></div>";break;}
case 10:{tree+="<div style='margin-left:"+16*node[DEPTH]+"px;' class='doctype'>"+"<span class='doctype-value'>"+this.getDoctypeName(data)+" "+(node[PUBLIC_ID]?
(" PUBLIC "+"\""+node[PUBLIC_ID]+"\""):"")+(node[SYSTEM_ID]?
(" \""+node[SYSTEM_ID]+"\""):"")+"</span></div>";break;}
default:{if(!(show_white_space_nodes)&&(node[TYPE]==3)){if(!/^\s*$/.test(node[VALUE])){tree+="<div style='margin-left:"+16*node[DEPTH]+"px;'"+current_formatting+">"+(node[NAME]?node[NAME]:nodeNameMap[node[TYPE]])+"<text"+(is_not_script_node?" ref-id='"+node[ID]+"' ":"")+">"+node[VALUE]+"</text>"+"</div>";}}
else
{tree+="<div style='margin-left:"+16*node[DEPTH]+"px;'"+current_formatting+">"+(node[NAME]?node[NAME]:nodeNameMap[node[TYPE]])+"<text"+(is_not_script_node?" ref-id='"+node[ID]+"' ":"")+">"+(/^\s*$/.test(node[VALUE])?_escape(node[VALUE]):node[VALUE])+"</text>"+"</div>";}}}}
tree+="</div></div>";scrollTop=container.scrollTop;container.innerHTML=tree;container.scrollTop=scrollTop;container_scroll_width=container.scrollWidth;container_first_child=container.firstChild;if(container_scroll_width>container_first_child.offsetWidth){if(!div_padding_value){style=getComputedStyle(container_first_child,null);div_padding_value=\
parseInt(style.getPropertyValue('padding-left'))+parseInt(style.getPropertyValue('padding-right'));}
container.firstChild.style.width=(container_scroll_width-div_padding_value)+'px';setTimeout(function(){container.scrollLeft=0;},0);}
topCell.statusbar.updateInfo(templates.breadcrumb(dom_data.getCSSPath()));}}}
var cls=window.cls||(window.cls={});cls.DOMView=function(id,name,container_class){var self=this;const
ID=0,TYPE=1,NAME=2,DEPTH=3,NAMESPACE=4,VALUE=4,ATTRS=5,ATTR_PREFIX=0,ATTR_KEY=1,ATTR_VALUE=2,CHILDREN_LENGTH=6,PUBLIC_ID=4,SYSTEM_ID=5,INDENT="  ",LINEBREAK='\n',VOID_ELEMNTS={'area':1,'base':1,'basefont':1,'bgsound':1,'br':1,'col':1,'embed':1,'frame':1,'hr':1,'img':1,'input':1,'link':1,'meta':1,'param':1,'spacer':1,'wbr':1,'command':1,'event-source':1,'source':1,}
var getIndent=function(count){var ret='';if(count){count--;}
while(count){ret+=INDENT;count--;}
return ret;}
this.scrollTargetIntoView=function(){var target=document.getElementById('target-element');var container=target;while(container&&!/container/.test(container.nodeName)&&
(container=container.parentElement));if(target&&container){target.scrollIntoView();container.scrollTop-=
(container.offsetHeight<100?container.offsetHeight*.7:100)-
(target.offsetTop-container.scrollTop);}}
this.getDoctypeName=function(data){var node=null,i=0;for(;node=data[i];i++){if(node[TYPE]==1){return node[NAME];}}}
this.updateBreadcrumbLink=function(obj_id){var target=document.getElementById('target-element');if(target){target.removeAttribute('id');while(target&&!/container/.test(target.nodeName)&&(target=target.parentElement));if(target){var
divs=target.getElementsByTagName('div'),div=null,i=0;for(;(div=divs[i])&&div.getAttribute('ref-id')!=obj_id;i++);if(div){div.id='target-element';this.scrollTargetIntoView();var rt_id=dom_data.getDataRuntimeId();if(!this.updateBreadcrumbLink.timeout){services['ecmascript-debugger'].spotlight(rt_id,obj_id,true);this.updateBreadcrumbLink.timeout=setTimeout(this.updateBreadcrumbLink.clearSpotlight,800,rt_id);}}}}}
this.updateBreadcrumbLink.timeout=0;this.updateBreadcrumbLink.clearSpotlight=function(rt_id){services['ecmascript-debugger'].clearSpotlight(rt_id);self.updateBreadcrumbLink.timeout=0;}
this.serializer={'text/html':function(data,is_xml){const LINEBREAK='\r\n';var
tree='',i=0,node=null,length=data.length,attrs='',attr=null,k=0,key='',is_open=0,has_only_one_child=0,one_child_value='',current_depth=0,child_pointer=0,child_level=0,j=0,children_length=0,closing_tags=[],force_lower_case=settings[self.id].get('force-lowercase'),node_name='',tag_head='',start_depth=data[0][DEPTH]-1;for(;node=data[i];i++){while(current_depth>node[DEPTH]){tree+=closing_tags.pop();current_depth--;}
current_depth=node[DEPTH];children_length=node[CHILDREN_LENGTH];child_pointer=0;node_name=node[NAME];if(force_lower_case){node_name=node_name.toLowerCase();}
switch(node[TYPE]){case 1:{attrs='';for(k=0;attr=node[ATTRS][k];k++){attrs+=" "+(force_lower_case?attr[ATTR_KEY].toLowerCase():attr[ATTR_KEY])+"=\""+attr[ATTR_VALUE].replace(/"/g,"&quot")+"\"";}
child_pointer=i+1;is_open=(data[child_pointer]&&(node[DEPTH]<data[child_pointer][DEPTH]));if(is_open){has_only_one_child=1;one_child_value='';child_level=data[child_pointer][DEPTH];for(;data[child_pointer]&&data[child_pointer][DEPTH]==child_level;child_pointer++){one_child_value+=data[child_pointer][VALUE];if(data[child_pointer][TYPE]!=3){has_only_one_child=0;one_child_value='';break;}}}
if(is_open){if(has_only_one_child){tree+=LINEBREAK+getIndent(node[DEPTH]-start_depth)+"<"+node_name+attrs+">"+one_child_value+"</"+node_name+">";i=child_pointer-1;}
else
{tree+=LINEBREAK+getIndent(node[DEPTH]-start_depth)+"<"+node_name+attrs+">";if(!(node_name in VOID_ELEMNTS)){closing_tags.push
(LINEBREAK+getIndent(node[DEPTH]-start_depth)+"</"+node_name+">");}}}
else
{tree+=LINEBREAK+getIndent(node[DEPTH]-start_depth)+"<"+node_name+attrs+(is_xml&&"/>"||">"+(node_name in VOID_ELEMNTS?"":"</"+node_name+">"));}
break;}
case 7:{tree+=LINEBREAK+getIndent(node[DEPTH]-start_depth)+"<?"+node[NAME]+(node[VALUE]?' '+node[VALUE]:'')+"?>";break;}
case 8:{tree+=LINEBREAK+getIndent(node[DEPTH]-start_depth)+"<!--"+(node[VALUE]||' ')+"-->";break;}
case 9:{break;}
case 10:{tree+=LINEBREAK+getIndent(node[DEPTH]-start_depth)+"<!doctype "+this.getDoctypeName(data)+(node[PUBLIC_ID]?
(" PUBLIC "+"\""+node[PUBLIC_ID]+"\""):"")+(node[SYSTEM_ID]?
(" \""+node[SYSTEM_ID]+"\""):"")+">";break;}
default:{if(!/^\s*$/.test(node[VALUE])){tree+=LINEBREAK+getIndent(node[DEPTH]-start_depth)+helpers.escapeTextHtml(node[VALUE]);}}}}
while(closing_tags.length){tree+=closing_tags.pop();}
return tree.replace(/^(?:\r\n)+/,'');},'application/xml':function(data){return self.serializer['text/html'](data,true);},}
this.serializeToOuterHTML=function(data){return this.serializer[dom_data.isTextHtml()&&'text/html'||'application/xml'](data);}
this.exportMarkup=function(){var data=dom_data.getData();var tree='',i=0,node=null,length=data.length;var attrs=null,attr=null,k=0,key='';var is_open=0;var has_only_one_child=0;var one_child_value=''
var current_depth=0;var child_pointer=0;var child_level=0;var j=0;var children_length=0;var closing_tags=[];var force_lower_case=settings[this.id].get('force-lowercase');var show_comments=settings[this.id].get('show-comments');var show_attrs=settings[this.id].get('show-attributes');var node_name='';var tag_head='';for(;node=data[i];i+=1){while(current_depth>node[DEPTH]){tree+=closing_tags.pop();current_depth--;}
current_depth=node[DEPTH];children_length=node[CHILDREN_LENGTH];child_pointer=0;node_name=(node[NAMESPACE]?node[NAMESPACE]+':':'')+node[NAME];if(force_lower_case){node_name=node_name.toLowerCase();}
switch(node[TYPE]){case 1:{attrs='';if(show_attrs){for(k=0;attr=node[ATTRS][k];k++){attrs+=" "+(attr[ATTR_PREFIX]?attr[ATTR_PREFIX]+':':'')+(force_lower_case?attr[ATTR_KEY].toLowerCase():attr[ATTR_KEY])+"=\""+attr[ATTR_VALUE]+"\"";}}
child_pointer=i+1;is_open=(data[child_pointer]&&(node[DEPTH]<data[child_pointer][DEPTH]));if(is_open){has_only_one_child=1;one_child_value='';child_level=data[child_pointer][DEPTH];for(;data[child_pointer]&&data[child_pointer][DEPTH]==child_level;child_pointer+=1){one_child_value+=data[child_pointer][VALUE];if(data[child_pointer][TYPE]!=3){has_only_one_child=0;one_child_value='';break;}}}
if(is_open){if(has_only_one_child){tree+=LINEBREAK+getIndent(node[DEPTH])+"&lt;"+node_name+attrs+"&gt;"+one_child_value+"&lt;/"+node_name+"&gt;";i=child_pointer-1;}
else
{tree+=LINEBREAK+getIndent(node[DEPTH])+"&lt;"+node_name+attrs+"&gt;";closing_tags.push(LINEBREAK+getIndent(node[DEPTH])+"&lt;/"+node_name+"&gt;");}}
else
{tree+=LINEBREAK+getIndent(node[DEPTH])+"&lt;"+node_name+attrs+"&gt;"+"&lt;/"+node_name+"&gt;";}
break;}
case 7:{tree+=LINEBREAK+getIndent(node[DEPTH])+"&lt;?"+node[NAME]+(node[VALUE]?' '+node[VALUE]:'')+"?&gt;";break;}
case 8:{if(show_comments){if(!/^\s*$/.test(node[VALUE])){tree+=LINEBREAK+getIndent(node[DEPTH])+"&lt;!--"+node[VALUE]+"--&gt;";}}
break;}
case 9:{break;}
case 10:{tree+=LINEBREAK+getIndent(node[DEPTH])+"&lt;!doctype "+this.getDoctypeName(data)+(node[PUBLIC_ID]?
(" PUBLIC "+"\""+node[PUBLIC_ID]+"\""):"")+(node[SYSTEM_ID]?
(" \""+node[SYSTEM_ID]+"\""):"")+"&gt;";break;}
default:{if(!/^\s*$/.test(node[VALUE])){tree+=LINEBREAK+getIndent(node[DEPTH])+node[VALUE];}}}}
while(closing_tags.length){tree+=closing_tags.pop();}
return tree;}
this.ondestroy=function(){services['ecmascript-debugger'].clearSpotlight(dom_data.getDataRuntimeId());}
var onSettingChange=function(msg){if(msg.id==self.id){switch(msg.key){case 'dom-tree-style':{(settings.dom.get('dom-tree-style')
?DOM_tree_style
:DOM_markup_style).apply(self.constructor.prototype);self.clearAllContainers();self.update();break;}}}}
messages.addListener('setting-changed',onSettingChange);this.init(id,name,container_class);}
cls.DOMView.prototype=ViewBase;new cls.DOMView('dom',ui_strings.M_VIEW_LABEL_DOM,'scroll dom');cls.DOMView.prototype.constructor=cls.DOMView;DOM_markup_style.apply(cls.DOMView.prototype);cls.DocumentSelect=function(id){var selected_value="";this.getSelectedOptionText=function(){var selected_rt_id=dom_data.getDataRuntimeId();if(selected_rt_id){var rt=runtimes.getRuntime(selected_rt_id);if(rt){return rt['title']||helpers.shortenURI(rt['uri']).uri;}}
return '';}
this.getSelectedOptionValue=function(){}
this.templateOptionList=function(select_obj){var active_window_id=runtimes.getActiveWindowId();if(active_window_id){var
_runtimes=runtimes.getRuntimes(active_window_id),rt=null,i=0;for(;(rt=_runtimes[i])&&!rt['selected'];i++);if(!rt&&_runtimes[0]){opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'no runtime selected')
return;}
return templates.runtimes(_runtimes,'dom');}}
this.checkChange=function(target_ele){var rt_id=target_ele.getAttribute('runtime-id');if(rt_id!=dom_data.getDataRuntimeId()){if(rt_id){dom_data.getDOM(rt_id);}
else
{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+"missing runtime id in cls.DocumentSelect.checkChange")}
return true;}
return false;}
this.init(id);}
cls.DocumentSelect.prototype=new CstSelect();new cls.DocumentSelect('document-select','document-options');new Settings
('dom',{'find-with-click':true,'highlight-on-hover':true,'update-on-dom-node-inserted':false,'force-lowercase':true,'show-comments':true,'show-attributes':true,'show-whitespace-nodes':true,'dom-tree-style':false,'show-siblings-in-breadcrumb':false,'show-id_and_classes-in-breadcrumb':true,'scroll-into-view-on-spotlight':true},{'find-with-click':ui_strings.S_SWITCH_FIND_ELEMENT_BY_CLICKING,'highlight-on-hover':ui_strings.S_SWITCH_HIGHLIGHT_BY_MOUSE_OVER,'update-on-dom-node-inserted':ui_strings.S_SWITCH_UPDATE_DOM_ON_NODE_REMOVE,'force-lowercase':ui_strings.S_SWITCH_USE_LOWER_CASE_TAG_NAMES,'show-comments':ui_strings.S_SWITCH_SHOW_COMMENT_NODES,'show-attributes':ui_strings.S_SWITCH_SHOW_ATTRIBUTES,'show-whitespace-nodes':ui_strings.S_SWITCH_SHOW_WHITE_SPACE_NODES,'dom-tree-style':ui_strings.S_SWITCH_SHOW_DOM_INTREE_VIEW,'show-siblings-in-breadcrumb':ui_strings.S_SWITCH_SHOW_SIBLINGS_IN_BREAD_CRUMB,'show-id_and_classes-in-breadcrumb':ui_strings.S_SWITCH_SHOW_ID_AND_CLASSES_IN_BREAD_CRUMB,'scroll-into-view-on-spotlight':ui_strings.S_SWITCH_SCROLL_INTO_VIEW_ON_FIRST_SPOTLIGHT},{checkboxes:['force-lowercase','show-comments','show-attributes','show-whitespace-nodes','find-with-click','highlight-on-hover','update-on-dom-node-inserted','show-siblings-in-breadcrumb','show-id_and_classes-in-breadcrumb','scroll-into-view-on-spotlight']});new ToolbarConfig
('dom',[{handler:'dom-inspection-snapshot',title:ui_strings.S_BUTTON_LABEL_GET_THE_WOHLE_TREE},{handler:'dom-inspection-export',title:ui_strings.S_BUTTON_LABEL_EXPORT_DOM}],[{handler:'dom-text-search',title:ui_strings.S_INPUT_DEFAULT_TEXT_SEARCH}],null,[{handler:'select-window',title:ui_strings.S_BUTTON_LABEL_SELECT_WINDOW,type:'dropdown',class:'window-select-dropdown',template:window['cst-selects']['document-select'].getTemplate()}])
new Switches
('dom',['find-with-click','highlight-on-hover','update-on-dom-node-inserted','show-comments','show-whitespace-nodes','dom-tree-style'])
eventHandlers.click['dom-inspection-snapshot']=function(event,target){dom_data.getSnapshot();};eventHandlers.click['df-show-live-source']=function(event,target){debug_helpers.liveSource.open();};(function(){var textSearch=new TextSearch();var onViewCreated=function(msg){if(msg.id=='dom'){textSearch.setContainer(msg.container);textSearch.setFormInput(views.dom.getToolbarControl(msg.container,'dom-text-search'));}}
var onViewDestroyed=function(msg){if(msg.id=='dom'){textSearch.cleanup();topCell.statusbar.updateInfo();}}
var onActionModeChanged=function(msg){if(msg.id=='dom'&&msg.mode=='default'){textSearch.revalidateSearch();}}
messages.addListener('view-created',onViewCreated);messages.addListener('view-destroyed',onViewDestroyed);messages.addListener('action-mode-changed',onActionModeChanged);eventHandlers.input['dom-text-search']=function(event,target){textSearch.searchDelayed(target.value);}
eventHandlers.keyup['dom-text-search']=function(event,target){if(event.keyCode==13){textSearch.highlight();}}})();messages.post('setting-changed',{id:'dom',key:'dom-tree-style'});eventHandlers.click['breadcrumb-link']=function(event,target){var obj_id=target.getAttribute('obj-id');if(obj_id){dom_data.setCurrentTarget(obj_id);views['dom'].updateBreadcrumbLink(obj_id);}};var cls=window.cls||(window.cls={});cls.DOMAttrsView=function(id,name,container_class){var self=this;this.createView=function(container){var
selectedNode=node_dom_attrs.getSelectedNode(),data=null,use_filter=settings['dom_attrs'].get("hide-null-values");if(selectedNode){delete container.__call_count;data=node_dom_attrs.getData(selectedNode.rt_id,selectedNode.obj_id,-1,arguments);if(data){container.innerHTML="<examine-objects rt-id='"+selectedNode.rt_id+"' "+"data-id='node_dom_attrs' "+"obj-id='"+selectedNode.obj_id+"' >"+"<start-search-scope></start-search-scope>"+node_dom_attrs.prettyPrint(data,-1,use_filter,1)+"<end-search-scope></end-search-scope>"+"</examine-objects>";messages.post('list-search-context',{'data_id':'node_dom_attrs','rt_id':selectedNode.rt_id,'obj_id':selectedNode.obj_id,'depth':'-1'});}}}
this.init(id,name,container_class);}
cls.DOMAttrsView.prototype=ViewBase;new cls.DOMAttrsView('dom_attrs',ui_strings.M_VIEW_LABEL_DOM_ATTR,'scroll dom-attrs');new Settings
('dom_attrs',{"hide-null-values":true},{"hide-null-values":ui_strings.S_SWITCH_HIDE_EMPTY_STRINGS},{checkboxes:["hide-null-values"]});new ToolbarConfig
('dom_attrs',null,[{handler:'dom-attrs-text-search',title:'text search'}])
new Switches
('dom_attrs',["hide-null-values"]);(function(){var listTextSearch=new ListTextSearch();var onViewCreated=function(msg){if(msg.id=='dom_attrs'){listTextSearch.setContainer(msg.container);}}
var onViewDestroyed=function(msg){if(msg.id=='dom_attrs'){listTextSearch.cleanup();}}
var onListSearchContext=function(msg){if(msg.data_id=='node_dom_attrs'){listTextSearch.onNewContext(msg);}}
messages.addListener('view-created',onViewCreated);messages.addListener('view-destroyed',onViewDestroyed);messages.addListener('list-search-context',onListSearchContext);eventHandlers.input['dom-attrs-text-search']=function(event,target){listTextSearch.setInput(target);listTextSearch.searchDelayed(target.value);}
eventHandlers.keyup['dom-attrs-text-search']=function(event,target){listTextSearch.handleKey(event,target)}})();var cls=window.cls||(window.cls={});cls.ThreadsView=function(id,name,container_class){var self=this;var __container=null;var cursor=0;const INDENT=' ',NL='\n';var propsKey=['event_type','stoped_at_queue','threads','rt_id','thread_id','parent-thread-id','thread-type','status','script-id','line-number','stopped-reason'];var propsMap={event_type:function(value){return value+':'+NL||'';},stoped_at_queue:function(value){return value.length&&INDENT+'stoped at queue: '+value.join(' ')+NL||'';},threads:function(value){var ret='',thread=null,i=0,t='',k=0;if(value.length){ret=INDENT+'threads overview:'+NL;for(;thread=value[i];i++){ret+=INDENT+INDENT+'runtime '+thread[0]+': ';for(k=1;t=thread[k];k++){ret+=t+' ';}
ret+=NL;}}
return ret;},rt_id:function(value){return INDENT+'runtime id: '+value+NL||'';},thread_id:function(value){return INDENT+'thread id: '+value+NL||'';},'parent-thread-id':function(value){return value&&value!='0'&&INDENT+'parent thread id: '+value+NL||'';},'thread-type':function(value){return value&&INDENT+'thread type: '+value+NL||'';},'status':function(value){return value&&INDENT+'status: '+value+NL||'';},'script-id':function(value){return value&&INDENT+'script id: '+value+NL||'';},'line-number':function(value){return value&&INDENT+'line number: '+value+NL||'';},'stopped-reason':function(value){return value&&INDENT+'stop reason: '+value+NL||'';}}
this.createView=function(container){var threads=runtimes.getThreads(),thread=null,key='',i=0,j=0;var inner="",thread_inner='';if(!__container||!container.firstChild){container.innerHTML='';__container=container.render(['div','class','padding']);}
for(;thread=threads[cursor];cursor++){thread_inner="<pre>";for(j=0;key=propsKey[j];j++){thread_inner+=propsMap[key](thread[key]);}
inner+=thread_inner+"</pre>";}
__container.innerHTML+=inner;container.scrollTop=container.scrollHeight;}
this.ondestroy=function(){__container=null;cursor=0;}
this.resetCursor=function(){cursor=0;}
this.exportLog=function(){var threads=runtimes.getThreads(),thread=null,key='',i=0,j=0;var log='';for(;thread=threads[i];i++){for(j=0;key=propsKey[j];j++){log+=propsMap[key](thread[key]);}
log+=NL;}
export_data.data=log;topCell.showView('export_data');}
this.init(id,name,container_class);}
cls.ThreadsView.prototype=ViewBase;new cls.ThreadsView('threads',ui_strings.M_VIEW_LABEL_THREAD_LOG,'scroll threads');new Settings
('threads',{'log-threads':false},{'log-threads':ui_strings.S_BUTTON_LABEL_LOG_THREADS},{checkboxes:['log-threads']});new ToolbarConfig
('threads',[{handler:'threads-clear-log',title:ui_strings.S_BUTTON_LABEL_CLEAR_LOG},{handler:'threads-export-log',title:ui_strings.S_BUTTON_LABEL_EXPORT_LOG}])
eventHandlers.click['threads-clear-log']=function(event,target,container){runtimes.clearThreadLog();views.threads.resetCursor();if(container&&container.firstChild){container.firstChild.innerHTML='';}}
eventHandlers.click['threads-export-log']=function(event,target,container){views.threads.exportLog();}
var export_data=new function(){this.data='';};var cls=window.cls||(window.cls={});cls.ExportDataView=function(id,name,container_class){this.ishidden_in_menu=true;this.hidden_in_settings=true;this.requires_view="export_new";this.createView=function(container){container.innerHTML="<div class='padding'><pre>"+export_data.data+"</pre></div>";}
this.init(id,name,container_class);}
cls.ExportDataView.prototype=ViewBase;new cls.ExportDataView('export_data',ui_strings.M_VIEW_LABEL_EXPORT,'scroll export-data');var elementStyle=new function(){const
COMP_STYLE=0,CSS=1,REQ_TYPE_CSS=2,PROP_LIST=1,VAL_LIST=2,PRIORITY_LIST=3,SEARCH_LIST=6,HAS_MATCHING_SEARCH_PROPS=7,SEARCH_DELAY=50,MIN_SEARCH_THERM_LENGTH=3;var categories_data=[];var __selectedElement=null;var __searchMap=[];var __search_is_active=false;var __old_search_therm='';var __setProps=[];var onResetState=function(){__selectedElement=null;__setProps=[];__setPriorities=[];__searchMap=[];__search_is_active=false;__old_search_therm='';}
var default_styles_pointer=0;var searchtimeout=new Timeouts();var __views=['css-inspector'];var id_index_map={'computedStyle':COMP_STYLE,'css':CSS}
var setCategories=function(id,name,handler){return{id:id,name:name,unfolded:settings['css-inspector'].get(id),handler:handler||null}}
var categories=[setCategories('computedStyle',ui_strings.M_VIEW_LABEL_COMPUTED_STYLE),setCategories('css',ui_strings.M_VIEW_LABEL_STYLES,'edit-css')];var searchDelayed=function(value){searchtimeout.set(search,SEARCH_DELAY,value);}
var search=function(search_therm){if(__old_search_therm!=search_therm
&&(__search_is_active||search_therm.length>=MIN_SEARCH_THERM_LENGTH)){doSearch(search_therm);for(i=0;view_id=__views[i];i++){views[view_id].updateCategories({},getUnfoldedKey());}
__old_search_therm=search_therm;}}
this.getSearchTerm=function(){return __old_search_therm;}
var doSearch=function(search_therm){if(search_therm.length>=MIN_SEARCH_THERM_LENGTH){__searchMap=[];var i=0,length=css_index_map.length;for(;i<length;i++){if(css_index_map[i].indexOf(search_therm)!=-1){__searchMap[i]=1;}}
for(i=0,length=categories_data[CSS].length;i<length;i++){searchNodeCascade(categories_data[CSS][i],__searchMap);}
__search_is_active=true;}
else
{for(i=0,length=categories_data[CSS].length;i<length;i++){clearNodeCascade(categories_data[CSS][i],__searchMap);}
__old_search_therm="";__search_is_active=false;}}
var searchNodeCascade=function(node_cascade,search_list){var
dec=null,i=0,declaration_list=node_cascade[1],has_matching_search_props=false;for(;dec=declaration_list[i];i++){searchStyleDeclaration(dec,search_list);has_matching_search_props=has_matching_search_props||dec[HAS_MATCHING_SEARCH_PROPS];}
node_cascade[HAS_MATCHING_SEARCH_PROPS]=has_matching_search_props;}
var searchStyleDeclaration=function(declaration,search_list){var
i=0,length=declaration[PROP_LIST].length,has_matching_search_props=false;declaration[SEARCH_LIST]=[];for(;i<length;i++){if(search_list[declaration[PROP_LIST][i]]){declaration[SEARCH_LIST][i]=1;has_matching_search_props=true;};}
declaration[HAS_MATCHING_SEARCH_PROPS]=has_matching_search_props;}
var clearNodeCascade=function(node_cascade,search_list){var
dec=null,i=0,declaration_list=node_cascade[1];delete node_cascade[0][HAS_MATCHING_SEARCH_PROPS];for(;dec=declaration_list[i];i++){delete dec[HAS_MATCHING_SEARCH_PROPS];}
delete node_cascade[2][HAS_MATCHING_SEARCH_PROPS];}
this.getSearchActive=function(){return __search_is_active;}
this.getSearchMap=function(){return __searchMap.slice(0);}
this.getCategories=function(){return categories;}
this.getCategoryData=function(index){return categories_data[index];}
this.getSetProps=function(){return __setProps.slice(0);}
var getRequestType=function(){return(categories[COMP_STYLE].unfolded||categories[CSS].unfolded)&&REQ_TYPE_CSS||0;}
var getUnfoldedKey=function(){var ret='',i=0;for(;i<2;i++){ret+=categories[i].unfolded?'1':'0';}
return ret;}
this.setUnfoldedCat=function(cat_id,unfolded){var
cat=categories[id_index_map[cat_id]],req_type=0,request_key='',i=0,view_id='';if(cat){cat.unfolded=unfolded;if(unfolded){if(__selectedElement){if((req_type=getRequestType())!=__selectedElement.req_type){__selectedElement.req_type=req_type;getData(__selectedElement.rt_id,__selectedElement.obj_id);}
else
{for(i=0;view_id=__views[i];i++){views[view_id].updateCategories({},getUnfoldedKey());}}}}}
else
{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'elementStyle, cat id does not return a cat');}}
var onElementSelected=function(msg){__selectedElement={rt_id:msg.rt_id,obj_id:msg.obj_id,req_type:getRequestType()};var view_id='',i=0,get_data=false;for(;(view_id=__views[i])&&!(get_data=views[view_id].isvisible());i++);if(get_data&&__selectedElement.req_type){getData(msg.rt_id,msg.obj_id);}}
var getData=function(rt_id,obj_id){if(stylesheets.hasStylesheetsRuntime(rt_id)){var tag=tagManager.setCB(null,handleGetData,[rt_id,obj_id]);services['ecmascript-debugger'].cssGetStyleDeclarations(tag,rt_id,obj_id,'json');}
else
{stylesheets.getStylesheets(rt_id,arguments);}}
var handleGetData=function(xml,rt_id,obj_id){const
STYLE_DECLARATION_LIST=1,STYLE_DEC_HEADER=0,RULE_ORIGIN=0,INDEX_LIST=1,STATUS_LIST=4;var
json=xml.getNodeData('matching-style-declarations'),declarations=null,i=0,view_id='',node_style_cascade=null,style_dec=null,j=0,length=0,k=0;if(json){declarations=eval('('+json+')');categories_data[0]=declarations[0];categories_data[1]=declarations[1];categories_data[1].rt_id=categories_data[0].rt_id=rt_id;__setProps=[];for(i=0;node_style_cascade=categories_data[CSS][i];i++){for(j=0;style_dec=node_style_cascade[STYLE_DECLARATION_LIST][j];j++){if(style_dec[STYLE_DEC_HEADER][RULE_ORIGIN]!=1){length=style_dec[INDEX_LIST].length;for(k=0;k<length;k++){if(style_dec[STATUS_LIST][k]){__setProps[style_dec[INDEX_LIST][k]]=1;}}}}}
if(__old_search_therm){doSearch(__old_search_therm);}
for(i=0;view_id=__views[i];i++){views[view_id].updateCategories({},getUnfoldedKey());}}}
messages.addListener('element-selected',onElementSelected);messages.addListener('reset-state',onResetState);eventHandlers.input['css-inspector-text-search']=function(event,target){searchDelayed(target.value);}}
var action_handler=new function(){var handler=function(event){var ele=event.target,handler=ele.getAttribute('handler');while(!handler&&(ele=ele.parentElement)){handler=ele.getAttribute('handler');}
if(handler&&handlers[handler]){handlers[handler](event,ele);}}
var handlers={};handlers['show-frame']=function(event){var frame=stop_at.getFrame(event.target['ref-id']);if(frame){topCell.showView(views['inspection'].id);messages.post('active-inspection-type',{inspection_type:'frame'});messages.post('frame-selected',{frame_index:event.target['ref-id']});if(event.type=='click'){helpers.setSelected(event);if(views.js_source.isvisible()){if(frame.script_id){var plus_lines=views.js_source.getMaxLines()<=10
?views.js_source.getMaxLines()/2>>0
:10;views.js_source.showLine(frame.script_id,frame.line-plus_lines);views.js_source.showLinePointer(frame.line,frame.id==0);}
else
{views.js_source.clearView();}}}}
else
{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+"missing frame in 'show-frame' handler");}}
handlers['examine-object-2']=function(event,target){var
parent=target.parentNode,parent_parent=parent.parentNode,obj_id=parent.getAttribute('obj-id'),depth=parseInt(parent.getAttribute('depth')),rt_id=parent_parent.getAttribute('rt-id'),data_id=parent_parent.getAttribute('data-id'),margin=parseInt(parent.style.paddingLeft),data=null,cur=parent,i=0,cur_2=parent.nextSibling,cur_3=null,is_expanded=target.disabled
||(cur_2&&parseInt(cur_2.style.paddingLeft)>margin)
||(cur_2&&(cur_2=cur_2.nextSibling)&&parseInt(cur_2.style.paddingLeft)>margin),is_in_search_scope=parent.previousSibling&&parent.previousSibling.nodeName=="start-search-scope",range=null;if(window[data_id]){if(is_expanded){if(!target.disabled){window[data_id].clearData(rt_id,obj_id,depth,parent.getElementsByTagName('key')[0].textContent);range=document.createRange();range.setStartAfter(parent);while((cur=cur.nextSibling)&&(parseInt(cur.style.paddingLeft)>margin||cur.nodeName!="item")){range.setEndAfter(cur);cur_2=cur;if(cur.nodeName=="end-search-scope"){is_in_search_scope=true;}}
if(is_in_search_scope){cur=cur_2;while((cur=cur.nextSibling)&&(parseInt(cur.style.paddingLeft)>=margin||cur.nodeName!="item")){cur_2=cur;}
if(cur_2.nodeName=='end-search-scope'&&!cur_2.nextSibling&&cur_2.previousSibling){range.setEndAfter(cur_2.previousSibling);}
else
{parent_parent.insertAfter(parent_parent.getElementsByTagName('end-search-scope')[0],cur_2);}
cur=parent;while((cur=cur.previousSibling)&&(parseInt(cur.style.paddingLeft)>=margin||cur.nodeName!="item")){cur_2=cur;}
if(cur_3=parent_parent.getElementsByTagName('start-search-scope')[0].previousSibling){cur_3.removeClass('search-scope');}
if(cur){parent_parent.insertAfter(parent_parent.getElementsByTagName('start-search-scope')[0],cur);cur.addClass('search-scope');messages.post('list-search-context',{'data_id':data_id,'rt_id':rt_id,'obj_id':cur.getAttribute('obj-id'),'depth':cur.getAttribute('depth'),'key':cur.getElementsByTagName('key')[0].textContent});}
else
{parent_parent.insertBefore(parent_parent.getElementsByTagName('start-search-scope')[0],parent_parent.firstChild);messages.post('list-search-context',{'data_id':data_id,'rt_id':rt_id,'obj_id':parent_parent.getAttribute('obj-id'),'depth':'-1','key':''});}}
range.deleteContents();parent.removeClass('search-scope');target.style.removeProperty("background-position");}}
else
{if(data=window[data_id].getData(rt_id,obj_id,depth,arguments)){if(data.length){parent_parent.insertAfter(parent_parent.getElementsByTagName('end-search-scope')[0],parent);parent.insertAdjacentHTML('afterEnd',window[data_id].prettyPrint(data,depth,settings['inspection'].get("hide-default-properties"),window[data_id].filter_type));parent_parent.insertAfter(parent_parent.getElementsByTagName('start-search-scope')[0],parent);cur_2=parent_parent.getElementsByClassName('search-scope');while(cur=cur_2[0]){cur.removeClass('search-scope');}
parent.addClass('search-scope');cur=parent;i=parseInt(cur.getAttribute('depth'));while(cur=cur.previousSibling){if(parseInt(cur.getAttribute('depth'))<i){i=parseInt(cur.getAttribute('depth'));cur.addClass('search-scope');if(!i){break;}}}
target.style.backgroundPosition="0px -11px";messages.post('list-search-context',{'data_id':data_id,'rt_id':rt_id,'obj_id':obj_id,'depth':depth,'key':parent.getElementsByTagName('key')[0].textContent});}
else
{target.disabled=true;}}}}}
handlers['show-global-scope']=function(event){var ele=event.target;var runtime=runtimes.getRuntime(ele.previousSibling&&ele.previousSibling.getAttribute('runtime_id')||'');if(runtime){topCell.showView(views.inspection.id);messages.post('active-inspection-type',{inspection_type:'object'});object_inspection_data.showGlobalScope(runtime['runtime-id']);runtimes.setSelectedRuntime(runtime);views.runtimes.update();}}
handlers['show-scripts']=function(event){var runtime_id=event.target.getAttribute('runtime_id');var scripts=runtimes.getScripts(runtime_id);var scripts_container=event.target.parentNode.getElementsByTagName('ul')[0];var script=null,i=0;if(scripts_container){event.target.parentNode.removeChild(scripts_container);event.target.style.removeProperty('background-position');runtimes.setUnfolded(runtime_id,'script',false);}
else
{scripts_container=['ul'];for(;script=scripts[i];i++){scripts_container.push(templates.scriptLink(script));}
scripts_container.splice(scripts_container.length,0,'runtime-id',runtime_id);event.target.parentNode.render(scripts_container);event.target.style.backgroundPosition='0 -11px';runtimes.setUnfolded(runtime_id,'script',true);}}
handlers['show-stylesheets']=function(event,target){var rt_id=target.getAttribute('runtime_id');var sheets=stylesheets.getStylesheets(rt_id,arguments);if(sheets){var container=event.target.parentNode.getElementsByTagName('ul')[0];var sheet=null,i=0;if(container){target.parentNode.removeChild(container);target.style.removeProperty('background-position');runtimes.setUnfolded(rt_id,'css',false);}
else
{container=['ul'];for(;sheet=sheets[i];i++){container.push(templates.sheetLink(sheet,i));}
container.splice(container.length,0,'runtime-id',rt_id);event.target.parentNode.render(container);event.target.style.backgroundPosition='0 -11px';runtimes.setUnfolded(rt_id,'css',true);}}}
handlers['display-stylesheet']=function(event,target){var index=parseInt(target.getAttribute('index'));var rt_id=target.parentNode.getAttribute('runtime-id');var rules=stylesheets.getRulesWithSheetIndex(rt_id,index,arguments);if(rules){stylesheets.setSelectedSheet(rt_id,index,rules);topCell.showView(views.stylesheets.id);helpers.setSelected(event);}}
handlers['show-runtimes']=function(event){var window_id=event.target.parentNode.getAttribute('window_id');var rts=runtimes.getRuntimes(window_id);var runtime_container=event.target.parentNode.getElementsByTagName('ul')[0];var rt=null,i=0;var template_type=event.target.parentNode.parentNode.getAttribute('template-type');if(runtime_container){event.target.parentNode.removeChild(runtime_container);event.target.style.removeProperty('background-position');runtimes.setWindowUnfolded(window_id,false);}
else
{event.target.parentNode.render(templates.runtimes(rts,template_type));event.target.style.backgroundPosition='0 -11px';runtimes.setWindowUnfolded(window_id,true);}}
handlers['display-script']=function(event){var script_id=event.target.getAttribute('script-id');if(script_id){runtimes.setSelectedScript(script_id);views.runtimes.updateSelectedScript(event.target,script_id);topCell.showView(views.js_source.id);}
else
{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+"missing script id in handlers['display-script']")}}
handlers['continue']=function(event){views.js_source.clearView();views.callstack.clearView();views.inspection.clearView();stop_at.__continue(event.target.id.slice(9));}
handlers['set-stop-at']=function(event){stop_at.setUserStopAt(event.target.value,event.target.checked);}
handlers['set-break-point']=function(event){var line=event.target.parentElement.children[0].value;var script_id=views.js_source.getCurrentScriptId();if(line){if(runtimes.hasBreakpoint(script_id,line)){runtimes.removeBreakpoint(script_id,line);views.js_source.removeBreakpoint(line);}
else
{runtimes.setBreakpoint(script_id,line);views.js_source.addBreakpoint(parseInt(line));}}}
handlers['drop-down']=function(event){var ele=event.target;var drop_down=document.getElementById('drop-down-view');var type=ele.getAttribute('ref');if(drop_down){}
else
{switch(type){case 'runtimes':{if(windows.showWindow('runtimes','Runtimes',templates.runtimes_dropdown(ele))){views.runtimes.update();}
break;}
case 'console':{if(windows.showWindow('console','Console',['div','class','window-container','id','console-view'])){views.console.update();}
break;}
case 'environment':{if(windows.showWindow('environment','Environment',['div','class','window-container','id','view-environment'])){views.environment.update();}
break;}
case 'dom-inspector':{if(windows.showWindow('dom-inspector','DOM Inspector',templates.domInspector())){views['dom-inspector'].update();}
break;}
case 'configuration':{if(windows.showWindow('configuration','Stop At',['div','class','window-container','id','configuration'])){views.configuration.update();}
break;}
case 'debug':{if(windows.showWindow
('debug','Debug',['div',['input','type','button','value','clear output','onclick','debug.clear()'],['input','type','button','value','export','onclick','debug.export()'],['pre','id','debug'],'class','window-container','id','debug-container'])){window.debug.output();}
break;}
case 'testing':{if(windows.showWindow('Testing','Testing',['div','class','window-container','id','testing'])){testing.view.update();}
break;}
case 'command-line':{if(windows.showWindow
('command-line','Command Line',['div',['div',['input','type','button','value','eval','onclick',"this.parentNode.parentNode.getElementsByTagName('textarea')[0].value='<eval>\\n  <tag>1</tag>\\n  <runtime-id></runtime-id>\\n  <thread-id></thread-id>\\n  <frame-id></frame-id>\\n  <script-data></script-data>\\n</eval>';"],['input','type','button','value','set breakpoint','onclick',"this.parentNode.parentNode.getElementsByTagName('textarea')[0].value='<add-breakpoint>\\n  <breakpoint-id> x </breakpoint-id>\\n  <source-position>\\n    <script-id> x </script-id>\\n    <line-number> x </line-number>\\n  </source-position>\\n</add-breakpoint>';"],['input','type','button','value','examine obj','onclick',"this.parentNode.parentNode.getElementsByTagName('textarea')[0].value='<examine-objects>\\n  <tag>1</tag>\\n  <runtime-id>x</runtime-id>\\n  <object-id>x</object-id>\\n</examine-objects>';"],['input','type','button','value','post','style','margin-left:10px','onclick','services[\'ecmascript-debugger\'].postCommandline()'],'style','text-align: right'],['div',['textarea'],'id','command-line-container'],'class','window-container','id','command-line'])){window.debug.output();}
break;}}}}
handlers['get-children']=function(event){var container=event.target.parentNode;var level=(parseInt(container.style.marginLeft)||0)/16;var level_next=(container.nextSibling&&parseInt(container.nextSibling.style.marginLeft)||0)/16;var ref_id=container.getAttribute('ref-id');if(level_next>level){dom_data.closeNode(ref_id);}
else
{dom_data.getChildernFromNode(ref_id,event.ctrlKey?'subtree':'children');}}
handlers['spotlight-node']=function(event,current_target){var rt_id=dom_data.getDataRuntimeId();var obj_id=current_target.getAttribute('ref-id');if(obj_id&&!handlers['spotlight-node'].timeout){services['ecmascript-debugger'].spotlight(rt_id,obj_id,settings.dom.get('scroll-into-view-on-spotlight')&&obj_id!=dom_data.getCurrentTarget());handlers['spotlight-node'].timeout=setTimeout(handlers['spotlight-node'].clearSpotlight,800,rt_id);dom_data.setCurrentTarget(obj_id);views['dom'].updateTarget(current_target,obj_id);}}
handlers['spotlight-node'].timeout=0;handlers['spotlight-node'].clearSpotlight=function(rt_id){services['ecmascript-debugger'].clearSpotlight(rt_id);handlers['spotlight-node'].timeout=0;}
handlers['create-all-runtimes']=function(){services['ecmascript-debugger'].createAllRuntimes();}
handlers['update-global-scope']=function(event){handlers['show-frame']({'target':{'ref-id':0}});}
handlers['dom-inspection-export']=function(event){export_data.data=views['dom'].exportMarkup();topCell.showView('export_data');}
handlers['inspect-object-link']=function(event,target){var rt_id=target.getAttribute('rt-id');var obj_id=target.getAttribute('obj-id');messages.post('active-inspection-type',{inspection_type:'object'});topCell.showView(views.inspection.id);messages.post('object-selected',{rt_id:rt_id,obj_id:obj_id});}
handlers['dom-resource-link']=function(event,target){var
url=target.textContent,rt_id=target.parentNode.parentNode.parentNode.getAttribute('rt-id')
||target.parentNode.parentNode.parentNode.parentNode.getAttribute('rt-id');window.open(helpers.resolveURLS(runtimes.getURI(rt_id),url.slice(1,url.length-1)),"_blank");}
this.post=function(handler,event){if(handlers[handler]){handlers[handler](event);}}
document.addEventListener('click',handler,false);}
var change_handler=new function(){var handler=function(event){var handler=event.target.id;if(handler&&handlers[handler]){handlers[handler](event);}}
var handlers={};handlers['radio-markup-view']=handlers['radio-dom-view']=handlers['checkbox-show-attributes']=handlers['checkbox-force-lower-case']=handlers['checkbox-show-comments']=handlers['checkbox-show-white-space-nodes']=function(){views['dom-inspector'].update();}
handlers['checkbox-highlight-on-hover']=dom_data.highlight_on_hover;handlers['checkbox-find-element-with-click']=dom_data.set_click_handler;this.post=function(handler,event){if(handlers[handler]){handlers[handler](event);}}
document.addEventListener('change',handler,false);}
var scroll_handler=new function(){var handler=function(event){var handler=event.target&&event.target.getAttribute&&event.target.getAttribute('handler');if(handler&&handlers[handler]){handlers[handler](event);}}
var handlers={};handlers['scroll-js-source']=function(event){views.js_source.scroll(event);}
document.addEventListener('scroll',handler,false);}
var tagManager=new function(){var counter=1;var tags={};this.setCB=function(obj,methode,args_list){var tag=(counter++).toString();tags[tag]={obj:obj,methode:methode,args:args_list?args_list:[]};if(window.__debug_event_flow__){tags[tag].time=new Date().getTime();}
if(window.__profiling__){window.__times__[0]=new Date().getTime();}
return tag;}
this.handleResponse=function(response){var tag=response.getNodeData('tag'),cb=null;if(tag&&(cb=tags[tag])){delete tags[tag];if(window.__debug_event_flow__){debug.output('tag: '+((new Date().getTime())-cb.time));}
cb.methode.apply(cb.obj,[response].concat(cb.args));return true;}
else
{return false;}}}
var BaseEditor=new function(){this.edit=this.oninput=this.submit=this.cancel=this.onclick=this.nav_next=this.nav_previous=function(){return null};var _init=function(instance){this.context_enter=null;this.context_cur=null;this.base_style={'font-family':'','line-height':0,'font-size':0}
this.char_width=0;this.line_height=0;this.cssText='';this.textarea_container=null;this.textarea=null;this.host_element_border_padding_left=0;this.host_element_border_padding_top=0;this.getInputHandler=function(){return function(event){instance.oninput(event);}}}
this.textarea_container_name="textarea-container";this.get_base_style=function(ele){var
style=getComputedStyle(ele,null),props=['font-family','line-height','font-size'],prop=null,i=0,span=document.createElement('test-element'),cssText='display:block;position:absolute;left:-100px;top:0;white-space:pre;';for(;prop=props[i];i++){this.base_style[prop]=style.getPropertyValue(prop);cssText+=prop+':'+this.base_style[prop]+';';}
span.textContent='1234567890';document.documentElement.appendChild(span);span.style.cssText=cssText;this.char_width=span.offsetWidth/10;this.base_style['line-height']=(this.line_height=span.offsetHeight)+'px';document.documentElement.removeChild(span);this.host_element_border_padding_left=parseInt(style.getPropertyValue('padding-left'))+parseInt(style.getPropertyValue('border-left-width'));this.host_element_border_padding_top=parseInt(style.getPropertyValue('padding-top'))+parseInt(style.getPropertyValue('border-top-width'));cssText='';for(prop in this.base_style){cssText+=prop+':'+this.base_style[prop]+';';}
this.textarea_container=document.createElement(this.textarea_container_name);this.textarea=this.textarea_container.
appendChild(document.createElement('textarea-inner-container')).
appendChild(document.createElement('textarea'));this.textarea.style.cssText=cssText;this.textarea.oninput=this.getInputHandler();}
this.__is_active=function(){return false};this.__defineGetter__("is_active",function(){return this.__is_active()});this.base_init=function(instance){_init.apply(instance,[instance]);}}
var DOMAttrAndTextEditor=function(nav_filters){this.base_init(this);this.type="dom-attr-text-editor";this.textarea_container_name="textarea-container-inline";this.context_enter={type:'',rt_id:'',obj_id:'',text:'',key:'',value:'',has_value:false,is_new:false}
this.context_cur={type:'',rt_id:'',obj_id:'',text:'',key:'',value:'',has_value:false,is_new:false}
var map={'\t':'\\t','\v':'\\v','\f':'\\f','\u0020':'\\u0020','\u00A0':'\\u00A0','\r':'\\r','\n':'\\n','\u2028':'\\u2028','\u2029':'\\u2029'};var _escape=function(string){string=new String(string);var _char='',i=0,ret='';for(;_char=string.charAt(i);i++){ret+=map[_char];}
return ret;}
var re_encoded=/^(?:\\t|\\v|\\f|\\u0020|\\u00A0|\\r|\\n|\\u2028|\\u2029)+$/;var decode_escape=function(string){var
match=null,ret='',re=/\\t|\\v|\\f|\\u0020|\\u00A0|\\r|\\n|\\u2028|\\u2029/g,decode_map={'\\t':'\t','\\v':'\v','\\f':'\f','\\u0020':'\u0020','\\u00A0':'\u00A0','\\r':'\r','\\n':'\n','\\u2028':'\u2028','\\u2029':'\u2029'};while(match=re.exec(string)){ret+=decode_map[match[0]];}
return ret;}
var crlf_encode=function(str){return str.replace(/\r\n/g,"\\n");}
this.edit=function(event,ref_ele){var
ele=ref_ele||event.target,parent_parent=null,enter_state={type:'',rt_id:'',obj_id:'',text:'',key:'',value:'',has_value:false},prop='';if(!this.base_style['font-size']){this.get_base_style(ele);}
if(this.textarea_container.parentElement){opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+"this.textarea_container.parentElement is not null in submit");}
switch(enter_state.type=ele.nodeName){case "key":{parent_parent=ele.parentElement.parentElement;enter_state.rt_id=parent_parent.parentElement.getAttribute('rt-id')
||parent_parent.parentElement.parentElement.getAttribute('rt-id');enter_state.obj_id=parent_parent.getAttribute('ref-id');enter_state.key=ele.textContent;enter_state.has_value=ele.nextElementSibling&&ele.nextElementSibling.nodeName=="value";enter_state.value=enter_state.has_value
&&ele.nextElementSibling.textContent.replace(/^"|"$/g,"")||"";this.textarea.value=ele.textContent;ele.textContent="";ele.appendChild(this.textarea_container);break;}
case "value":{parent_parent=ele.parentElement.parentElement;enter_state.rt_id=parent_parent.parentElement.getAttribute('rt-id')
||parent_parent.parentElement.parentElement.getAttribute('rt-id');enter_state.obj_id=parent_parent.getAttribute('ref-id');enter_state.key=ele.previousElementSibling
&&ele.previousElementSibling.nodeName=="key"
&&ele.previousElementSibling.textContent
||"";enter_state.value=ele.textContent.replace(/^"|"$/g,"");this.textarea.value=ele.textContent.replace(/^"|"$/g,"");ele.textContent='"';ele.appendChild(this.textarea_container);ele.appendChild(document.createTextNode('"'));break;}
case "text":{parent_parent=ele.parentElement;enter_state.rt_id=parent_parent.parentElement.getAttribute('rt-id')
||parent_parent.parentElement.parentElement.getAttribute('rt-id');enter_state.obj_id=ele.getAttribute('ref-id');if(re_encoded.test(ele.textContent)){enter_state.text=decode_escape(ele.textContent);}
else
{enter_state.text=ele.textContent;}
this.textarea.value=enter_state.text;ele.textContent="";ele.appendChild(this.textarea_container);break;}}
this.max_width=parseInt(getComputedStyle(parent_parent,null).getPropertyValue('width'));this.set_textarea_dimensions();this.context_enter=enter_state;for(prop in enter_state){this.context_cur[prop]=enter_state[prop];}
if(event){this.textarea.focus();}
this.textarea.selectionStart=0;this.textarea.selectionEnd=this.textarea.value.length;}
this.oninput=function(event){var
script="",state=this.context_cur;if(this.textarea_container.parentElement){this.set_textarea_dimensions();switch(state.type){case "key":{state.key=this.textarea.value
if(state.value){script='node.setAttribute("'+crlf_encode(state.key)+'","'+crlf_encode(state.value)+'")';services['ecmascript-debugger'].eval(0,state.rt_id,'','',script,["node",state.obj_id]);}
break;}
case "value":{script='node.setAttribute("'+crlf_encode(state.key)+'","'+crlf_encode((state.value=this.textarea.value))+'")';services['ecmascript-debugger'].eval(0,state.rt_id,'','',script,["node",state.obj_id]);break;}
case "text":{script='node.nodeValue = "'+crlf_encode(state.text=this.textarea.value)+'"';services['ecmascript-debugger'].eval(0,state.rt_id,'','',script,["node",state.obj_id]);break;}}}}
this.submit=function(check_value){var
script="",state=this.context_cur,nav_target=this.textarea_container.parentElement,cur=null;if(nav_target){switch(state.type){case "key":{if(state.key&&(!check_value||state.value)){dom_data.update(state);nav_target.textContent=state.key;}
else
{nav_target=this.remove_attribute();}
break;}
case "value":{if(state.key&&state.value){dom_data.update(state);nav_target.textContent='"'+state.value+'"';}
else
{nav_target=this.remove_attribute();}
break;}
case "text":{dom_data.update(state);if(settings.dom.get('dom-tree-style')&&/^\s*$/.test(state.text)){nav_target.textContent=_escape(state.text);}
else
{nav_target.textContent=state.text;}
break;}}}
return nav_target;}
this.cancel=function(){var
script="",state=this.context_enter,nav_target=null;if(this.textarea_container.parentElement){if(this.context_cur.is_new){}
else
{nav_target=this.textarea_container.parentElement;switch(state.type){case "key":{if(state.key){script='node.setAttribute("'+crlf_encode(state.key)+'","'+crlf_encode(state.value)+'")';services['ecmascript-debugger'].eval(0,state.rt_id,'','',script,["node",state.obj_id]);nav_target.textContent=state.key;break}}
case "value":{if(state.value){script='node.setAttribute("'+crlf_encode(state.key)+'","'+crlf_encode(state.value)+'")';services['ecmascript-debugger'].eval(0,state.rt_id,'','',script,["node",state.obj_id]);nav_target.textContent='"'+state.value+'"';break;}
nav_target=nav_target.parentNode;this.remove_attribute();nav_target=(nav_target.lastElementChild||nav_target).
getNextWithFilter(nav_target.parentElement.parentElement,nav_filters.left_right)
||nav_target.lastElementChild
||nav_target.getPreviousWithFilter(nav_target.parentElement.parentElement,nav_filters.left_right);break;}
case "text":{script='node.nodeValue = "'+crlf_encode(state.text)+'"';services['ecmascript-debugger'].eval(0,state.rt_id,'','',script,["node",state.obj_id]);if(settings.dom.get('dom-tree-style')&&/^\s*$/.test(state.text)){nav_target.textContent=_escape(state.text);}
else
{nav_target.textContent=state.text;}
break;}}}}
return nav_target;}
this.nav_previous=function(event,action_id){var
state=this.context_cur,nav_target=this.textarea_container.parentElement,nav_target_parent=nav_target.parentElement,next=nav_target.previousElementSibling,next_next=next&&next.previousElementSibling,submit_success=this.submit(true),container=nav_target_parent.parentElement.parentElement;switch(state.type){case "key":case "value":{(next&&(submit_success||next.parentElement))
||(next=next_next)
||(next=nav_target_parent.getPreviousWithFilter(container,nav_filters.attr_text));break;}
case "text":{next=nav_target.getPreviousWithFilter(container,nav_filters.attr_text);}}
if(next||(next=submit_success&&nav_target)||(next=nav_target_parent)){if(next.nodeName=='node'){next.firstChild.splitText(next.firstChild.nodeValue.length-1);next=this.create_new_edit(next.firstChild);}
else if(next.parentElement!=nav_target_parent
&&next.nodeName=='value'
&&next==next.parentElement.lastElementChild){next=this.create_new_edit(next);}
if(next){this.edit({},next);}}
return next;}
this.nav_next=function(event,action_id){var
state=this.context_cur,nav_target=this.textarea_container.parentElement,nav_target_parent=nav_target.parentElement,next=nav_target.nextElementSibling,next_next=next&&next.nextElementSibling,submit_success=this.submit(),container=nav_target_parent.parentElement.parentElement;switch(state.type){case "key":case "value":{(submit_success&&(next||(next=this.create_new_edit(submit_success))))
||(next&&next.parentElement)||(next=next_next)
||(next=(nav_target_parent.lastElementChild||nav_target_parent).getNextWithFilter(container,nav_filters.attr_text));break;}
case "text":{next=nav_target.getNextWithFilter(container,nav_filters.attr_text);}}
if(next||(next=submit_success&&nav_target)||(next=nav_target_parent)){if(next.nodeName=='node'){next.firstChild.splitText(next.firstChild.nodeValue.length-1);next=this.create_new_edit(next.firstChild);}
this.edit({},next);}
return next;}
this.set_textarea_dimensions=function(){var
max_content_length=Math.max.apply(null,this.textarea.value.split('\r\n').map(function(item){return item.length})),width=this.char_width*(max_content_length+1);this.textarea.style.width=(width<this.max_width?width:this.max_width)+"px";this.textarea.style.height=this.textarea.scrollHeight+'px';}
this.create_new_edit=function(ref_node){var
name=ref_node.nodeName,parent=ref_node.parentNode,cur=parent.insertBefore
(document.createTextNode(name=='key'&&'='||' '),ref_node.nextSibling);return parent.insertBefore
(document.createElement(name=='key'&&'value'||'key'),cur.nextSibling);}
this.remove_attribute=function(){var
script='node.removeAttribute("'+this.context_enter.key+'")',state=this.context_cur,nav_target=this.textarea_container.parentElement,nav_target_parent=nav_target.parentElement,pair_target=nav_target.nodeName=='key'&&'next'||'previous',check=nav_target.nodeName=='key'&&'value'||'key';if(this.context_enter.key){services['ecmascript-debugger'].eval(0,state.rt_id,'','',script,["node",state.obj_id]);state.key=this.context_enter.key;delete state.value;dom_data.update(state);}
nav_target.textContent="";cur=nav_target[pair_target+"ElementSibling"];if(cur&&cur.nodeName==check){nav_target_parent.removeChild(cur);}
cur=nav_target[pair_target+"Sibling"];if(cur&&/=/.test(cur.nodeValue)){nav_target_parent.removeChild(cur);}
cur=nav_target.previousSibling;if(cur&&/ +/.test(cur.nodeValue)){if(/^ +$/.test(cur.nodeValue)){nav_target_parent.removeChild(cur);}
else
{cur.nodeValue=cur.nodeValue.replace(/ +$/,'');}}
nav_target_parent.removeChild(nav_target);nav_target_parent.normalize();return null;}
this.onclick=function(event){event.preventDefault();event.stopPropagation();if(!this.textarea_container.contains(event.target)){this.submit(true);return false;}
return true;}}
DOMAttrAndTextEditor.prototype=BaseEditor;var DOMMarkupEditor=function(){this.base_init(this);this.type="dom-markup-editor";this.context_enter={rt_id:'',obj_id:'',parent_obj_id:'',outerHTML:'',host_target:''}
this.context_cur={rt_id:'',obj_id:'',parent_obj_id:'',outerHTML:'',host_target:''}
this.edit=function(event,ref_ele){var
ele=ref_ele||event.target,rt_id=ele.parentElement.parentElement.getAttribute('rt-id')
||ele.parentElement.parentElement.parentElement.getAttribute('rt-id'),obj_id=ele.parentElement.getAttribute('ref-id'),script='',tag='',prop='',container=ele;while(container
&&!/container/.test(container.nodeName)
&&(container=container.parentElement));if(container){container.firstChild.style.position='relative';container.firstChild.render(['fade-out']);this.context_enter={rt_id:rt_id,obj_id:obj_id,parent_obj_id:dom_data.getParentElement(obj_id),outerHTML:'',host_target:''};this.context_cur={};for(prop in this.context_enter){this.context_cur[prop]=this.context_enter[prop];}
script=this["return new Host_updater(target)"];tag=tagManager.setCB(this,this.register_host_updater,[rt_id]);services['ecmascript-debugger'].eval(tag,rt_id,'','',script,['target',obj_id]);tag=tagManager.setCB(this,this.handle_get_outer_html,[rt_id,obj_id,ele,event])
services['ecmascript-debugger'].inspectDOM(tag,obj_id,'subtree','json');}}
this.oninput=function(event){var
script="",state=this.context_cur;if(this.textarea_container.parentElement&&state.host_target){this.set_textarea_dimensions();state.outerHTML=this.textarea.value;var script="host_target.outerHTML = '"+encode(state.outerHTML)+"';";services['ecmascript-debugger'].eval
(0,state.rt_id,'','',script,['host_target',state.host_target]);}}
this.submit=function(){var
state=this.context_cur,nav_target=this.textarea_container.parentElement;if(nav_target){var tag=tagManager.setCB(this,this.on_exit_edit,[state,nav_target]);var script="host_target.exit_edit()";services['ecmascript-debugger'].eval
(tag,state.rt_id,'','',script,['host_target',state.host_target]);}
return nav_target;}
this.cancel=function(){var
script="",state=this.context_enter,nav_target=this.textarea_container.parentElement;if(nav_target){if(state.outerHTML!=this.context_cur.outerHTML){var tag=tagManager.setCB(this,this.on_exit_edit,[state,nav_target]);var script="host_target.cancel_edit()";services['ecmascript-debugger'].eval
(tag,state.rt_id,'','',script,['host_target',state.host_target]);}
else
{nav_target.textContent="";this.context_cur=this.context_enter=null;views.dom.update();}}
return nav_target;}
this.nav_next=function(){var
val=this.textarea.value,start=this.textarea.selectionStart,end=this.textarea.selectionEnd,indent='  ';this.textarea.value=val.slice(0,start)+indent+val.slice(end);this.textarea.selectionStart=start+indent.length;this.textarea.selectionEnd=start+indent.length;}
this.set_textarea_dimensions=function(){this.textarea.style.height=this.textarea.scrollHeight+'px';}
this.__is_active=function(){return this.context_enter&&this.context_enter.host_target&&true||false;}
this.onclick=function(event){event.preventDefault();event.stopPropagation();if(!this.textarea_container.contains(event.target)){this.submit(true);return false;}
return true;}
this.on_exit_edit=function(xml,state,nav_target){if(xml.getNodeData('status')=='completed'){nav_target.textContent="";this.context_cur=this.context_enter=null;dom_data.closeNode(state.parent_obj_id,true);dom_data.getChildernFromNode(state.parent_obj_id,'children');}
else
{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'exit markup edit failed in DOMMarkupEditor');}};var encode=function(str){return str.replace(/\r\n/g,"\\n").replace(/'/g,"\\'");};var Host_updater=function(target){var
range_target=document.createRange(),timeout=0,new_str='',enter_node=null,namespace=target.namespaceURI,scripts=null,script=null,script_type_attr='',i=0,update=function(str){if(enter_node){range_target.deleteContents();}
else
{enter_node=range_target.extractContents();};var range_source=document.createRange();var temp=null;if(document.documentElement){temp=namespace
?document.createElementNS(namespace,'df-temp-element')
:document.createElement('df-temp-element');(document.body||document.documentElement).appendChild(temp);if(typeof temp.innerHTML=='string'){temp.innerHTML=new_str;}
else
{innerXML(temp,new_str)}}
else
{var new_source=lexer.lex(new_str),tag=new_source.length&&new_source[0];if(tag){var attrs=tag[2],i=0,attr=null;for(;(attr=attrs[i])&&attr[0]!='xmlns';i++);if(attr){attrs.splice(i,1);temp=document.createElementNS(attr[1],tag[1]);}
else
{temp=document.createElement(tag[1]);}
for(i=0;attr=attrs[i];i++){temp.setAttribute(attr[0],attr[1]);}
document.appendChild(temp);if(typeof temp.innerHTML=='string'){temp.innerHTML=new_source[1];}
else
{innerXML(temp,new_source[1].replace(new RegExp('</'+tag[1]+'>$'),''))}
range_target.selectNode(document.documentElement);temp=null;}};for(scripts=temp.getElementsByTagName('script'),i=0;script=scripts[i];i++){script_attr=script.getAttribute('type');script.setAttribute('type',(script_attr?script_attr+'/':'')+'edited');}
var first=temp&&temp.firstChild;var last=temp&&temp.lastChild;if(first){range_source.selectNodeContents(temp);var fragment=range_source.extractContents();range_target.insertNode(fragment);range_target.setStartBefore(first);range_target.setEndAfter(last);};if(temp&&temp.parentElement){temp.parentNode.removeChild(temp);};timeout=0;},lexer=new function(){const TEXT='TEXT',TAG='TAG';var
source='',cur='',pos=0,text=function(){var ret=[],buffer='',_tag=null;while(cur){if(cur=='<'){cur=source.charAt(pos++);if(buffer){ret[ret.length]=[TEXT,buffer];buffer='';}
_tag=tag();if(_tag&&!/[!?]/.test(_tag[1].charAt(0))){return[_tag,source.slice(pos-1)];}
continue;}
buffer+=cur;cur=source.charAt(pos++);}
return ret;},tag=function(){var buffer='',attrs=[],has_attrs=false;while(cur){if(cur=='>'){cur=source.charAt(pos++);return[TAG,buffer,attrs];}
if(cur==' '){cur=source.charAt(pos++);has_attrs=true;continue;}
if(has_attrs){attrs=attr_key();continue;}
buffer+=cur;cur=source.charAt(pos++);}},attr_key=function(){var attrs=[],attr_key='',buffer='';while(cur){if(cur==' '){if(buffer){attr_key=buffer;buffer='';}
cur=source.charAt(pos++);continue;}
if(cur=='='){if(buffer){attr_key=buffer;buffer='';}
cur=source.charAt(pos++);attrs[attrs.length]=[attr_key,set_attr_delimiter()];attr_key='';continue;}
if(cur=='>'){if(buffer){attr_key=buffer;buffer='';}
if(attr_key){attrs[attrs.length]=[attr_key];}
return attrs;}
buffer+=cur;cur=source.charAt(pos++);}},set_attr_delimiter=function(){var delimiter='';while(cur){if(cur==' '){cur=source.charAt(pos++);continue;}
if(cur=='\''||cur=='"'){delimiter=cur;cur=source.charAt(pos++);return attr_value(delimiter);}
return attr_value(' ');}},attr_value=function(delimiter){var buffer='';while(cur){if(cur==delimiter){cur=source.charAt(pos++);return buffer;}
if(cur=='>'&&delimiter==' '){return buffer;}
buffer+=cur;cur=source.charAt(pos++);}};this.lex=function(_source){source=_source;pos=0;cur=source.charAt(pos++);return text();}},innerXML=function(ele,str){var
parser=new DOMParser(),source="<temp-root xmlns=\""+namespace+"\">"+str+"</temp-root>",doc=parser.parseFromString(source,"application/xml");if(doc.documentElement.nodeName=="temp-root"){range=doc.createRange();range.selectNodeContents(doc.documentElement);ele.appendChild(range.extractContents());}
else
{ele.textContent="<parseerror/>";}};range_target.selectNode(target);this.__defineSetter__
("outerHTML",function(str){new_str=str;timeout||(timeout=setTimeout(update,100));});this.cancel_edit=function(){timeout&&(timeout=clearTimeout(timeout));if(enter_node){range_target.deleteContents();range_target.insertNode(enter_node);}
this.exit_edit();};this.exit_edit=function(){if(timeout){timeout=clearTimeout(timeout);update();};lexer=range_target=timeout=new_str=enter_node=update=null;};};this["return new Host_updater(target)"]="return new ("+Host_updater.toString()+")(target)";this.register_host_updater=function(xml,rt_id){var
status=xml.getNodeData('status'),obj_id=xml.getNodeData('object-id');if(status=='completed'&&obj_id){this.context_enter.host_target=this.context_cur.host_target=obj_id;}
else
{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+"failed register_host_updater in DOMMarkupEditor");}}
this.handle_get_outer_html=function(xml,rt_id,obj_id,ele,event){var json=xml.getNodeData('jsondata');if(json){var
outerHTML=views['dom'].serializeToOuterHTML(eval('('+json+')')),parent=ele.parentNode,parent_parent=parent.parentElement,margin=parseInt(parent.style.marginLeft),next=null;this.context_enter.outerHTML=this.context_cur.outerHTML=outerHTML;if(!this.base_style['font-size']){this.get_base_style(ele);}
if(this.textarea_container.parentElement){opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+"this.textarea_container.parentElement is not null in submit");}
this.textarea.value=outerHTML;parent.innerHTML="";parent.appendChild(this.textarea_container);while((next=parent.nextElementSibling)&&parseInt(next.style.marginLeft)>margin){parent_parent.removeChild(next);};if(next&&parseInt(next.style.marginLeft)==margin&&/<\//.test(next.textContent)){parent_parent.removeChild(next);}
this.set_textarea_dimensions();if(event){this.textarea.focus();}
this.textarea.selectionEnd=this.textarea.selectionStart=0;}
else
{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+"get subtree failed in DOMMarkupEditor handleGetSubtree")}}}
DOMMarkupEditor.prototype=BaseEditor;var cls=window.cls||(window.cls={});cls.DOMInspectorActions=function(id){this.view_id=id;var self=this;var view_container=null;var view_container_first_child=null;var nav_target=null;var selection=null;var range=null;const SCROLL_IN_PADDING=30;var _is_script_node=function(target){switch(target.nodeName){case 'value':case 'key':{return/^<?script/i.test(target.parentNode.firstChild.nodeValue);}
case 'text':{return!target.hasAttribute('ref-id');}
case 'node':{return(target.firstChild&&/^<?\/?script/i.test(target.firstChild.nodeValue));}
default:{return false;}}}
var nav_filters={attr_text:function(ele){if(!_is_script_node(ele)){switch(ele.nodeName.toLowerCase()){case 'text':case 'key':case 'value':{return true;}
case 'node':{return!ele.getElementsByTagName('key')[0];}}}
return false;},left_right:function(ele){return \
(!_is_script_node(ele)&&
(/^key|value|input|node$/.test(ele.nodeName.toLowerCase())||
"text"==ele.nodeName&&ele.textContent.length));},up_down:function(ele,start_ele){return \
("input"==ele.nodeName.toLowerCase()&&!ele.parentNode.contains(start_ele))||
(!_is_script_node(ele)&&
("node"==ele.nodeName&&
(ele.textContent.slice(0,2)!="</"||
(ele.parentNode.getElementsByTagName('node')[0]==ele))&&
"input"!=ele.parentNode.firstElementChild.nodeName.toLowerCase()))||
(self.is_dom_type_tree&&
"text"==ele.nodeName.toLowerCase()&&
!ele.parentNode.contains(start_ele));}}
this.editor=null;this.is_dom_type_tree=false;this.editors={"dom-attr-text-editor":new DOMAttrAndTextEditor(nav_filters),"dom-markup-editor":new DOMMarkupEditor(nav_filters)};this.set_editor=function(type){if(this.editor){this.editor.submit()}
if(!this.editor||this.editor.type!=type){this.editor=this.editors[type];}}
this.getFirstTarget=function(){return \
view_container
&&(document.getElementById('target-element')||view_container).
getElementsByTagName('input')[0];}
this.resetTarget=function(new_container){if(view_container&&nav_target){var
tag_name=nav_target.nodeName.toLowerCase(),count=0,new_container_elements=new_container.firstChild.getElementsByTagName(tag_name),old_container_elements=view_container_first_child.getElementsByTagName(tag_name),index=old_container_elements.indexOf(nav_target);while(!(nav_target=new_container_elements[index-count])&&count++<index);view_container=new_container;view_container_first_child=new_container.firstChild;this.setSelected(nav_target||(nav_target=this.getFirstTarget()));}}
var onViewCreated=function(msg){if(msg.id==self.view_id){self.resetTarget(msg.container);self.is_dom_type_tree=msg.container.hasClass('tree-style');}}
this.setContainer=function(event,container){messages.addListener('view-created',onViewCreated);view_container=container;view_container_first_child=container.firstChild;selection=getSelection();range=document.createRange();this.is_dom_type_tree=container.hasClass('tree-style');if(event.type=='click'&&/^node|key|value|text|input$/i.test(event.target.nodeName)){nav_target=event.target;}
if(!nav_target){nav_target=this.getFirstTarget();}
this.setSelected(nav_target);}
this.setSelected=function(new_target){var firstChild=null,raw_delta=0,delta=0;if(new_target){if(nav_target){nav_target.blur();}
selection.collapse(view_container,0);nav_target=new_target;raw_delta=new_target.offsetTop-view_container.scrollTop;delta=raw_delta+new_target.offsetHeight+SCROLL_IN_PADDING-view_container.offsetHeight;if(delta<0&&(delta=raw_delta-SCROLL_IN_PADDING)>0){delta=0;}
view_container.scrollTop+=delta;switch(new_target.nodeName.toLowerCase()){case 'node':case 'value':{firstChild=new_target.firstChild;range.setStart(firstChild,this.is_dom_type_tree?0:1);range.setEnd(firstChild,firstChild.nodeValue.length-(this.is_dom_type_tree&&!firstChild.nextSibling?0:1))
selection.addRange(range);break;}
case 'key':case 'text':{range.selectNodeContents(new_target);selection.addRange(range);break;}
case 'input':{nav_target.focus();break;}}}
return new_target;}
this.target_enter=function(event,action_id){if(nav_target){nav_target.releaseEvent
((/^input|node$/i.test(nav_target.nodeName)
||nav_target.getAttribute('handler'))&&"click"||"dblclick");}
return false;}
this.target_ctrl_enter=function(event,action_id){if(nav_target){switch(nav_target.nodeName.toUpperCase()){case "NODE":{nav_target.releaseEvent("dblclick");break;}
case "INPUT":{nav_target.releaseEvent("click",{ctrlKey:true});break;}}}
return false;}
this.keyhandler_onclick=function(event){var target=event.target;var is_in_container=view_container&&view_container.contains(target);if(is_in_container){if(target!=nav_target&&/^input|node|key|value|text$/i.test(target.nodeName)){this.setSelected(target);}}
return!is_in_container;}
this.blur=function(event){selection.collapse(document.documentElement,0);view_container=null;view_container_first_child=null;nav_target=null;selection=null;range=null;messages.removeListener('view-created',onViewCreated);}
this.nav_up=function(event,action_id){if(!this.setSelected(nav_target.getPreviousWithFilter(view_container,nav_filters.up_down))){view_container.scrollTop=0;}
return true;}
this.nav_down=function(event,action_id){if(!this.setSelected(nav_target.getNextWithFilter(view_container,nav_filters.up_down))){view_container.scrollTop=view_container.scrollHeight;}
return true;}
this.nav_left=function(event,action_id){this.setSelected(nav_target.getPreviousWithFilter(view_container,nav_filters.left_right));return true;}
this.nav_right=function(event,action_id){this.setSelected(nav_target.getNextWithFilter(view_container,nav_filters.left_right));return true;}
this.editDOM=function(event,target){if(!_is_script_node(event.target)){switch(event.target.nodeName){case 'span':{if(/^(?:key|value|text|node)$/.test(event.target.parentElement.nodeName)){event.target.parentElement.releaseEvent('dblclick');}
break;}
case 'key':case 'value':case 'text':{event.preventDefault();event.stopPropagation();key_identifier.setModeEdit(self);document.documentElement.addClass('modal');self.setSelected(event.target.parentNode);self.set_editor("dom-attr-text-editor");self.editor.edit(event,event.target);break;}
case 'node':{var new_target=event.target;if(/^<\//.test(new_target.textContent)){new_target=event.target.getPreviousWithFilter
(event.target.parentNode.parentNode,self.makeFilterGetStartTag(event.target));if(!new_target){opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'failed getting start tag in this.editDOM in action_dom.js')
return;}}
event.preventDefault();event.stopPropagation();key_identifier.setModeEdit(self);document.documentElement.addClass('modal');self.setSelected(new_target.parentNode);self.set_editor("dom-markup-editor");self.editor.edit(event,new_target);break;}}}}
this.enter_edit_mode=function(event,action_id){if(this.editor.type=="dom-attr-text-editor"){this.setSelected(this.editor.submit()||this.getFirstTarget());key_identifier.setModeDefault(self);document.documentElement.removeClass('modal');return false;}
else
{return true;}}
this.ctrl_enter_edit_mode=function(event,action_id){if(this.editor.type=="dom-attr-text-editor"){return false;}
else
{this.setSelected(this.editor.submit()||this.getFirstTarget());key_identifier.setModeDefault(self);document.documentElement.removeClass('modal');return false;}}
this.nav_next_edit_mode=function(event,action_id){if(this.editor.type=="dom-attr-text-editor"){if(!this.editor.nav_next(event,action_id)){key_identifier.setModeDefault(this);document.documentElement.removeClass('modal');}
return false;}
else
{this.editor.nav_next(event,action_id);}
return false;}
this.nav_previous_edit_mode=function(event,action_id){if(this.editor.type=="dom-attr-text-editor"){if(!this.editor.nav_previous(event,action_id)){key_identifier.setModeDefault(this);document.documentElement.removeClass('modal');}
return false;}
else
{return true}}
this.escape_edit_mode=function(event,action_id){if(this.editor.type=="dom-attr-text-editor"){this.setSelected(this.editor.cancel()||this.getFirstTarget());}
else
{this.editor.cancel();}
key_identifier.setModeDefault(this);document.documentElement.removeClass('modal');return false;}
this.edit_onclick=function(event){if(this.editor){if(this.editor.onclick(event)){}
else
{key_identifier.setModeDefault(self);document.documentElement.removeClass('modal');}}
return false;}
this.makeFilterGetStartTag=function(start_node){var start_tag=start_node.textContent.replace(/[\/>]/g,'');var margin_left=start_node.parentElement.style.marginLeft;return function(node){return(node.nodeName=='node'
&&node.textContent.indexOf(start_tag)==0
&&node.parentElement.style.marginLeft==margin_left);}}
this.select_all=function(event,action_id){var selection=getSelection();var range=document.createRange();selection.collapse(view_container,0);range.selectNodeContents(view_container);selection.addRange(range);}
this.init(id);};cls.DOMInspectorActions.prototype=BaseActions;new cls.DOMInspectorActions('dom');cls.DOMInspectorKeyhandler=function(id){var __actions=actions[id];this[this.NAV_UP]=function(event,action_id){return __actions.nav_up(event,action_id);}
this[this.NAV_DOWN]=function(event,action_id){return __actions.nav_down(event,action_id);}
this[this.NAV_LEFT]=function(event,action_id){return __actions.nav_left(event,action_id);}
this[this.NAV_RIGHT]=function(event,action_id){return __actions.nav_right(event,action_id);}
this[this.ENTER]=function(event,action_id){return __actions.target_enter(event,action_id);}
this[this.CTRL_ENTER]=function(event,action_id){return __actions.target_ctrl_enter(event,action_id);}
this[this.CTRL_A]=function(event,action_id){return __actions.select_all(event,action_id);}
this.focus=function(event,container){__actions.setContainer(event,container);}
this.blur=function(event){__actions.blur(event);}
this.onclick=function(event){return __actions.keyhandler_onclick(event);}
this.init(id);};cls.DOMInspectorKeyhandler.prototype=BaseKeyhandler;new cls.DOMInspectorKeyhandler('dom');cls.DOMInspectorEditKeyhandler=function(id){var __actions=actions[id]
this[this.NAV_PREVIOUS]=function(event,action_id){return __actions.nav_previous_edit_mode(event,action_id);}
this[this.NAV_NEXT]=function(event,action_id){return __actions.nav_next_edit_mode(event,action_id);}
this[this.ENTER]=function(event,action_id){return __actions.enter_edit_mode(event,action_id);}
this[this.CTRL_ENTER]=function(event,action_id){return __actions.ctrl_enter_edit_mode(event,action_id);}
this[this.ESCAPE]=function(event,action_id){return __actions.escape_edit_mode(event,action_id);}
this.blur=function(event){if(__actions.editor){__actions.editor.submit();}}
this.onclick=function(event){return __actions.edit_onclick(event);}
this.init(id);};cls.DOMInspectorEditKeyhandler.prototype=BaseEditKeyhandler;new cls.DOMInspectorEditKeyhandler('dom');eventHandlers.dblclick['edit-dom']=function(event,target){actions['dom'].editDOM(event,target);}
var composite_view_convert_table={"true":{'console_new':'console_new','settings_new':'settings_new','js_panel':'js_panel','js_new':'js_panel','dom_panel':'dom_panel','dom_new':'dom_panel','network_panel':'network_panel','export_new':'export_new'},"false":{'console_new':'console_new','settings_new':'settings_new','js_panel':'js_new','js_new':'js_new','dom_panel':'dom_new','dom_new':'dom_new','network_panel':'network_panel','export_new':'export_new'}}
var client=new function(){var self=this;var services=[];var services_dict={};var services_avaible={};var _client_id=0;var quit_callback=null;this.addService=function(service){services[services.length]=service;services_dict[service.name]=service;}
var host_connected=function(_services){
	services_avaible=eval("({\""+_services.replace(/,/g,"\":1,\"")+"\":1})");var service=null,i=0,service_name='',has_stp_version=false;for(service_name in services_avaible){if(service_name.slice(0,4)=='stp-'){has_stp_version=true;break;}}
	for(service_name in services_avaible){if(service_name.slice(0,5)=='core-'){if(service_name=='core-2-4'&&!has_stp_version){service_name='core-2-3';}
	handle_fallback.apply(new XMLHttpRequest(),[service_name]);return;}}
	if('window-manager' in services_avaible){for(;service=services[i];i++){if(service.name in services_avaible){opera.scopeEnableService(service.name);service.onconnect();}
	else
	{alert(ui_strings.S_INFO_SERVICE_NOT_AVAILABLE.replace(/%s/,service.name));}}}
	else
	{handle_fallback.apply(new XMLHttpRequest(),["protocol-3"]);}
}
var receive = function(service,msg) {
	//alert(arguments.callee.caller);
	var xml_doc=(new DOMParser()).parseFromString(msg,"application/xml");if(xml_doc){services_dict[service].onreceive(xml_doc);}
}
this.onquit_timeout=0;this.reset_onquit_timeout=function(){self.onquit_timeout=0;self.scopeSetupClient();}
var get_quit_callback=function(client_id){return function(msg){if(client_id==_client_id){quit(msg);}}}
var quit=function(msg){if(!self.onquit_timeout){messages.post('reset-state');messages.post('host-state',{state:'inactive'});for(var view_id in views){if(!views[view_id].do_not_reset){views[view_id].clearAllContainers();}}
self.onquit_timeout=setTimeout(self.reset_onquit_timeout,500);}}
var post_scope=function(service,msg){if(ini.debug){debug.logCommand(msg);}
opera.scopeTransmit(service,"<?xml version=\"1.0\"?>"+msg)}
var receive_dragonkeeper=function(xml,xhr){if(xml.documentElement.nodeName!='timeout'){services_dict[xhr.getResponseHeader("X-Scope-Message-Service")].onreceive(xml);}
proxy.GET("/scope-message?time"+new Date().getTime(),receive_dragonkeeper);}
var command_name="/";var post_proxy=function(service,msg){if(ini.debug){debug.logCommand(msg);}
proxy.POST(command_name+service,msg);}
var bindCB=function(service){var service_name=service.name;var boundGetEvent=function(xml){if(xml.documentElement.nodeName!='timeout'){service.onreceive(xml);}
proxy.GET("/"+service_name,boundGetEvent);}
return boundGetEvent;}
var proxy_onsetup=function(xhr){var
service=null,i=0,is_event_loop=false,server_name=xhr.getResponseHeader("Server"),has_stp_version=false;for(i=0;(service=this.services[i])&&
!(has_stp_version=service.slice(0,4)=='stp-');i++);for(i=0;(service=this.services[i])&&service.slice(0,5)!='core-';i++);if(service){if(service=='core-2-4'&&!has_stp_version){service='core-2-3';}
handle_fallback.apply(new XMLHttpRequest(),[service]);}
else
{for(i=0;(service=this.services[i])&&!(service=='window-manager');i++);if(service=='window-manager'){for(i=0;service=services[i];i++){if(!proxy.enable(service.name)){alert
('Could not find an Opera session to connect to.\n'+'Please try the following:\n'+'1. Open another Opera instance\n'+'2. In that Opera instance, open opera:config and check "Enable Debugging" and "Enable Script Debugging" under "Developer Tools"\n'+'3. Restart that Opera instance');}
else
{if(server_name&&server_name.indexOf("Dragonkeeper")!=-1){if(!is_event_loop){command_name="/send-command/";is_event_loop=true;setTimeout(function(){proxy.GET("/scope-message?time="+new Date().getTime(),receive_dragonkeeper);},10,service);}
setTimeout(function(service){service.onconnect();},10,service);}
else
{setTimeout(function(service){service.onconnect();proxy.GET("/"+service.name,bindCB(service));},10,service);}}}}
else
{handle_fallback.apply(new XMLHttpRequest(),["protocol-3"]);}}}
var handle_fallback=function(version){var
href=location.href,root_path=href.slice(0,href.indexOf('/app')>-1?href.indexOf('/app'):href.indexOf('/src')),file_name=href.slice(href.lastIndexOf('/')+1),type=href.indexOf('cutting-edge')>-1&&'cutting-edge'||'default',search=location.search;file_name=file_name.indexOf('.')>-1&&file_name||'';this.onload=function(){if(this.status!=200){opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+"could not load fallback urls. (during local development this is OK!)")
return;}
var fallback_urls=eval("("+this.responseText+")");if(fallback_urls&&fallback_urls[type]&&version in fallback_urls[type]){if(confirm(ui_strings.S_CONFIRM_LOAD_COMPATIBLE_VERSION)){location=root_path+fallback_urls[type][version]+file_name+search;}}
else
{alert(ui_strings.S_INFO_NO_COMPATIBLE_VERSION);}}
this.open('GET',root_path+'/app/fall-back-urls.json');this.send();}
this.scopeSetupClient=function(){_client_id++;quit_callback=get_quit_callback(_client_id);var port=settings.debug_remote_setting.get('debug-remote')
&&settings.debug_remote_setting.get('port')
||0;if(port){alert(ui_strings.S_INFO_WAITING_FOR_CONNECTION.replace(/%s/,port));}
opera.scopeAddClient(host_connected,receive,quit_callback,port);}
this.post=function(){};this.beforeUIFrameworkSetup=function(){var args=location.search,params={},arg='',i=0,ele=null;var no_params=true;var host=location.host.split(':');var layouts=ui_framework.layouts;if(args){args=args.slice(1).split(';');for(;arg=args[i];i++){arg=arg.split('=');params[arg[0]]=arg[1]?arg[1]:true;no_params=false;}}
if(params.debug||params['event-flow']){Debug.init();if(params.debug)ini.debug=true;if(params['event-flow'])window.__debug_event_flow__=true;}
if(params['log-events']){if(!ini.debug){ini.debug=true;Debug.init();}
debug.setEventFilter(params['log-events']);}
if(params['log-commands']){if(!ini.debug){ini.debug=true;Debug.init();}
debug.setCommandFilter(params['log-commands']);}
if(params['profiling']){Debug.init();window.__profiling__=true;window.__times__=[];}
if(params['test']){Debug.init();window.__testing__=true;window.__times_spotlight__=[];}
if(params['profile-dom']){Debug.init();window.__times_dom=[];}
if(!ini.debug||!params['error-console']){}
settings.general.set('show-views-menu',ini.debug)
if(opera.scopeAddClient){self.post=post_scope;self.scopeSetupClient();}
else
{if(host[1]){self.post=post_proxy;proxy.onsetup=proxy_onsetup;proxy.configure(host[0],host[1]);}
else
{alert(ui_strings.S_INFO_WRONG_START);}}
new CompositeView('network_panel',ui_strings.M_VIEW_LABEL_NETWORK,layouts.network_rough_layout);new CompositeView('console_new',ui_strings.M_VIEW_LABEL_COMPOSITE_ERROR_CONSOLE,layouts.console_rough_layout);new CompositeView('js_new',ui_strings.M_VIEW_LABEL_COMPOSITE_SCRIPTS,layouts.js_rough_layout);new CompositeView('dom_new',ui_strings.M_VIEW_LABEL_COMPOSITE_DOM,layouts.dom_rough_layout);new CompositeView('export_new',ui_strings.M_VIEW_LABEL_COMPOSITE_EXPORTS,layouts.export_rough_layout);new CompositeView('js_panel',ui_strings.M_VIEW_LABEL_COMPOSITE_SCRIPTS,layouts.js_rough_layout_panel);new CompositeView('dom_panel',ui_strings.M_VIEW_LABEL_COMPOSITE_DOM,layouts.dom_rough_layout_panel);new CompositeView('settings_new',ui_strings.S_BUTTON_LABEL_SETTINGS,layouts.settings_rough_layout);if(window.opera.attached!=settings.general.get('window-attached')){window.opera.attached=settings.general.get('window-attached')||false;}}
this.afterUIFrameworkSetup=function(){this.setupTopCell();if(window.opera.attached){topCell.tab.changeStyleProperty("padding-right",80);}
else
{topCell.toolbar.changeStyleProperty("padding-right",30);}
document.documentElement.render(templates.window_controls(window.opera.attached))
messages.post('setting-changed',{id:'general',key:'show-views-menu'});var is_disbaled=null,tabs=ui_framework.layouts.console_rough_layout.children[0].tabs,tab='';for(i=0;tab=tabs[i];i++){is_disbaled=!settings.console.get(tab);views[tab].ishidden_in_menu=is_disbaled;topCell.disableTab(tab,is_disbaled);}}
this.setupTopCell=function(){for(var tabs=viewport.getElementsByTagName('tab'),i=0;tab=tabs[i];i++){if(tab.hasClass('active')){messages.post("hide-view",{id:tab.getAttribute('ref-id')});}}
viewport.innerHTML='';new TopCell
(window.opera.attached?ui_framework.layouts.panel_layout:ui_framework.layouts.main_layout,null,null,TopToolbar,TopStatusbar);windowsDropDown.update();var view_id=global_state&&global_state.ui_framework.last_selected_tab;if(view_id&&views[view_id]&&!views[view_id].isvisible()){window.topCell.showView(view_id);}
if(global_state.ui_framework.spin_state){messages.post("host-state",{state:global_state.ui_framework.spin_state});}}
this.onquit=function(){messages.post('host-state',{state:'inactive'});}
ui_framework.beforeSetup=function(){self.beforeUIFrameworkSetup();}
ui_framework.afterSetup=function(){self.afterUIFrameworkSetup();}}
ui_framework.layouts.console_rough_layout={dir:'v',width:700,height:700,children:[{height:200,tabs:['console-all','console-script','console-css','console-xml','console-java','console-m2','console-network','console-html','console-xslt','console-svg','console-bittorrent','console-voice','console-widget','console-dragonfly']}]}
ui_framework.layouts.environment_rough_layout={dir:'v',width:700,height:700,children:[{height:200,tabs:['environment']}]}
ui_framework.layouts.export_rough_layout={dir:'v',width:700,height:700,children:[{height:200,tabs:['export_data']}]}
ui_framework.layouts.settings_rough_layout={dir:'v',width:700,height:700,children:[{height:200,tabs:['settings_view']}]}
ui_framework.layouts.dom_rough_layout={dir:'h',width:700,height:700,children:[{width:700,tabs:['dom','stylesheets']},{width:250,tabs:['css-inspector','dom_attrs','css-layout']}]}
ui_framework.layouts.dom_rough_layout_panel={dir:'h',width:700,height:700,children:[{width:700,tabs:['dom','stylesheets']},{width:250,tabs:['css-inspector','dom_attrs','css-layout']}]}
ui_framework.layouts.js_rough_layout={dir:'h',width:700,height:700,children:[{width:700,children:[{height:350,tabs:['js_source']},{height:250,tabs:['command_line']}]},{width:250,children:[{height:250,tabs:['callstack','threads']},{height:1000,tabs:['inspection']}]}]}
ui_framework.layouts.js_rough_layout_panel={dir:'h',width:700,height:700,children:[{width:700,children:[{height:150,tabs:['js_source','command_line']}]},{width:250,children:[{height:250,tabs:['callstack','inspection','threads']}]}]}
ui_framework.layouts.network_rough_layout={dir:'v',width:1000,height:1000,children:[{height:1000,tabs:['request_list']}]}
ui_framework.layouts.main_layout={id:'main-view',tabs:['dom_new','js_new','network_panel','console_new','settings_new']}
ui_framework.layouts.panel_layout={id:'main-view',tabs:['dom_panel','js_panel','network_panel','console_new','settings_new']}
var cls=window.cls||(window.cls={});cls.WindowManagerService=function(name){var self=this;this.onreceive=function(xml){if(ini.debug){debug.logEvents(xml);}
if(self[xml.documentElement.nodeName]){self[xml.documentElement.nodeName](xml)}
else
{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+"window manager not handled: "+new XMLSerializer().serializeToString(xml))}}
this['active-window']=function(msg){window_manager_data.set_active_window(msg.getNodeData("window-id"));}
this['list-windows-reply']=function(msg){var
window_list=[],windows=msg.getElementsByTagName('window'),win=null,i=0;for(;win=windows[i];i++){window_list[i]=this.parseWindow(win);}
window_manager_data.set_window_list(window_list);}
this['updated-window']=function(msg){window_manager_data.update_list(this.parseWindow(msg.getElementsByTagName('window')[0]));}
this['window-closed']=function(msg){window_manager_data.remove_window(msg.getNodeData('window-id'));}
this.getActiveWindow=function(){this.post("<get-active-window />");}
this.getWindowList=function(){this.post("<list-windows />");}
this.set_debug_context=function(win_id){var msg="<filter>"+"<clear />"+"<include>"+"<window-id>"+win_id+"</window-id>"+"</include>"+"</filter>";this.post(msg);}
this.onconnect=function(xml){get_context();}
var get_context=function(){if(!window_manager_data.active_window){self.getActiveWindow();}
else if(!window_manager_data.debug_context){window_manager_data.setDebugContext(window_manager_data.active_window);}
if(!window_manager_data.window_list){self.getWindowList();}
if(!window_manager_data.active_window||!window_manager_data.window_list){if(check_counter++<20){setTimeout(get_context,100);}
else
{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+"get active window failed in get_context in WindowManagerService");}}},check_counter=0;this.parseWindow=function(win){var
win_obj={},children=win.childNodes,child=null,first_child=null,i=0;for(;child=children[i];i++){win_obj[child.nodeName]=(first_child=child.firstChild)&&first_child.nodeValue||"undefined";}
return win_obj;}
this.initBase(name);if(!client){opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'client does not exist');return;}
client.addService(this);}
cls.WindowManagerService.prototype=ServiceBase;new cls.WindowManagerService('window-manager');var window_manager_data=new function(){this.active_window=null;this.window_list=null;this.debug_context=0;var view="window_manager";var self=this;var reset_state_handler=function(msg){self.active_window=null;self.window_list=null;self.debug_context=0;update_views();}
var update_views=function(){windowsDropDown.update();views["window_manager"].update();}
this.set_active_window_as_debug_context=function(){if(this.active_window&&this.active_window!=this.debug_context){this.setDebugContext(this.active_window);update_views();}}
this.set_active_window=function(win_id){if(!this.window_list||this.has_window_id_in_list(win_id)){this.active_window=win_id;update_views();}}
this.getDebugContextTitle=function(){var cursor=null,i=0;if(this.window_list){for(;(cursor=this.window_list[i])&&cursor['window-id']!=this.debug_context;i++);}
return cursor&&cursor['title']||'';}
this.has_window_id_in_list=function(id){var cursor=null,i=0;if(this.window_list){for(;(cursor=this.window_list[i])&&!(cursor['window-id']==id);i++);}
return cursor&&true||false;}
this.set_window_list=function(window_list){this.window_list=!settings.general.get('show-only-normal-and-gadget-type-windows')&&window_list
||window_list.filter(this.window_filter);if(this.active_window&&!this.has_window_id_in_list(this.active_window)){this.active_window=0;this.setDebugContext(this.window_list[0]['window-id']);opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'active window id does not exist');}
update_views();}
this.setDebugContext=function(win_id){services['window-manager'].set_debug_context(win_id);this.debug_context=win_id;runtimes.setActiveWindowId(win_id);update_views();setTimeout
(function(){runtimes.createAllRuntimesOnDebugContextChange(win_id);},100)}
this.window_filter=function(win){return win["window-type"]in{"normal":1,"gadget":1};}
this.update_list=function(win_obj){var
id=win_obj["window-id"],win=null,i=0;if(!settings.general.get('show-only-normal-and-gadget-type-windows')
||this.window_filter(win_obj)){if(this.window_list){for(;(win=this.window_list[i])&&!(id==win["window-id"]);i++){}}
else
{this.window_list=[];}
this.window_list[i]=win_obj;update_views();}
else
{this.remove_window(id);}}
this.remove_window=function(win_id){var
win=null,i=0;if(this.window_list){for(;win=this.window_list[i];i++){if(win_id==win["window-id"]){this.window_list.splice(i,1);if(win_id==this.active_window){if(this.window_list.length){this.setDebugContext(this.window_list[0]['window-id'])}}
break;}}}
update_views();}
window.messages.addListener('reset-state',reset_state_handler);}
var cls=window.cls||(window.cls={});cls.WindowManagerTestView=function(id,name,container_class){var self=this;this.createView=function(container){var
win_list=window_manager_data.window_list,win=null,props=['window-id','title','window-type','opener-id'],prop='',i=0,j=0,debug_context=window_manager_data.debug_context,markup=\
"<h2>active window: "+window_manager_data.active_window+"</h2>"+"<h2>debug context: "+debug_context+"</h2>"+"<h2>window list</h2>";if(win_list){markup+="<form handler='set-debug-context'>";for(;win=win_list[i];i++){markup+=
"<ul window-id='"+win['window-id']+"'>"+"<li><input type='radio'"+(debug_context&&debug_context==win['window-id']
?"checked='checked'"
:"")+"></li>";for(j=0;prop=props[j];j++){markup+="<li>"+prop+": "+win[prop]+"</li>";}
markup+="</ul>";}
markup+="</form>";}
else
{markup+="<p>window list null</p>";}
container.innerHTML="<div class='padding'>"+markup+"</div>";}
this.init(id,name,container_class);}
cls.WindowManagerTestView.prototype=ViewBase;new cls.WindowManagerTestView('window_manager','Test Window Manager','scroll windows-manager');eventHandlers.click['get-active-window']=function(event,target){services['window-manager'].getActiveWindow();}
eventHandlers.click['list-windows']=function(event,target){services['window-manager'].getWindowList();}
eventHandlers.click['set-filter-active-window']=function(event,target){services['window-manager'].setFilterActiveWindow();}
eventHandlers.click['set-debug-context']=function(event,target){if(/input/i.test(event.target.nodeName)){var
container=event.target.parentElement.parentElement,win_id=container.getAttribute('window-id');if(win_id){window_manager_data.setDebugContext(win_id);}}}
var windowsDropDown=new function(){this.update=function(){var toolbar=topCell.toolbar.getElement();if(toolbar){var
select=toolbar.getElementsByTagName('select')[0],win_list=window_manager_data.window_list,active_window=window_manager_data.active_window,debug_context=window_manager_data.debug_context,win=null,props=['window-id','title','window-type','opener-id'],prop='',i=0,id='',markup="";if(win_list&&select){for(;win=win_list[i];i++){id=win['window-id'];markup+='<option value="'+id+'"'+(id==debug_context?' selected="selected"':'')+'>'+win['title']+'</option>';}
select.innerHTML=markup;}}}}
eventHandlers.change['select-window']=function(event,target){if(target.value){window_manager_data.setDebugContext(target.value);}}
cls.DebuggerMenu=function(id,class_name){var selected_value="";this._action_entries=[{handler:'reload-window',text:ui_strings.S_MENU_RELOAD_DEBUG_CONTEXT}];this.getSelectedOptionValue=function(){}
this.templateOptionList=function(select_obj){var
win_list=window_manager_data.window_list,active_window=window_manager_data.active_window,debug_context=window_manager_data.debug_context,win=null,ret=[],opt=null,i=0;if(active_window&&active_window!=debug_context){ret[ret.length]=["cst-option",ui_strings.S_MENU_SELECT_ACTIVE_WINDOW,"opt-index",i,"value",active_window,"unselectable","on"]}
ret=ret.concat(select_obj._action_entries.map(this._action_entry));ret[ret.length]=["hr"];for(;win=win_list[i];i++){ret[ret.length]=["cst-option",win['title'],"opt-index",i,"value",win['window-id'],"class",win['window-id']==debug_context?"selected":"","unselectable","on"]}
return ret;}
this.checkChange=function(target_ele){var win_id=target_ele.getAttribute('value');if(win_id!=window_manager_data.debug_context){window_manager_data.setDebugContext(win_id);return true;}}
this.getTemplate=function(){var select=this;return function(){return["cst-select",["cst-drop-down"],"cst-id",select.getId(),"handler",select.getId(),"unselectable","on","class",select.class_name]}}
this.init(id,class_name);this.select_template=this.getTemplate();}
cls.DebuggerMenu.prototype=new CstSelectWithAction();new cls.DebuggerMenu('debugger-menu','debugger-menu');var cls=window.cls||(window.cls={});
cls.ErrorConsoleService = function(name){
	var self=this;
	var messages=[];
	var lastId=0;
	this.onreceive=function(xml){
		if(ini.debug){debug.logEvents(xml);
	}
	if(self[xml.documentElement.nodeName]){
		self[xml.documentElement.nodeName](xml)
	}
	else{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'error in console, genericEventListener');}}
	var parseLogEntry=function(xml){
		var message={"id":""+(++lastId)};
		var children=xml.documentElement.childNodes;
		for(var n=0,e;e=children[n];n++){
			switch(e.nodeName){
				case "time":message.time=new Date(parseFloat(e.textContent)) break;
				case "description":
					var parts=e.textContent.split("\n");
					if(parts.length){
						if(parts[0]=="Error:"){
							message.title=parts[1].substr(6);
						} else{
							message.title=parts[0];
						}
					} else{
						message.title=""
					}
					var matcher=/[lL]ine (\d*)/g;
					matcher.lastIndex=0;
					var linematch=matcher.exec(e.textContent);
					if(linematch){
						message.line=linematch[1];
					} else{
						message.line=null;
					}
			default:message[e.nodeName]=e.textContent;}
		}
		return message;
	}
	this['message'] = function(message) {
		//alert(arguments.callee.caller);
		window.ErrorConsoleData.addEntry(parseLogEntry(message));
	}
	this.initBase(name);
	if(!client) {
		opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'client must be created in ecma console.js');return;
	}
	client.addService(this);
}
cls.ErrorConsoleService.prototype = ServiceBase;
new cls.ErrorConsoleService('console-logger');
var ErrorConsoleData=new function(){var msgs=[];var toggled=[];var dragonfly_msgs=[];var __views=['console-dragonfly'];var __selected_rt_url='';var url_self=location.host+location.pathname;var updateViews=function(){var view='',i=0;for(;view=__views[i];i++){views[view].update();}}
this.addView=function(view_id){__views[__views.length]=view_id;}
this.addEntry=function(entry){if(!entry.uri||entry.uri.indexOf(url_self)==-1){msgs.push(entry);}
else
{dragonfly_msgs.push(entry);}
messages.post('console-message',entry);updateViews();}
this.clear=function(source){if(source){var fun=function(e){return e.source!=source}
msgs=msgs.filter(fun)}
else{msgs=[];toggled=[];}
updateViews();}
this.toggleEntry=function(logid){if(toggled.indexOf(logid)==-1){toggled.push(logid);}
else{toggled.splice(toggled.indexOf(logid),1);}}
var getMessagesWithoutFilter=function(source){if(source){var fun=function(e){return e.source==source}
return msgs.filter(fun)}
return msgs;}
var getMessagesWithFilter=function(source){var fun=function(e){return e.uri==__selected_rt_url&&
(!source||e.source==source)}
return msgs.filter(fun)}
this.getMessages=function(source,filter){return filter||settings.console.get('use-selected-runtime-as-filter')
?getMessagesWithFilter(source,filter)
:getMessagesWithoutFilter(source);}
this.getMessage=function(id){if(!msgs){return null}
else
{var filterFun=function(e){return e.id==id;}
return msgs.filter(filterFun)[0]||null;}}
this.clearDragonflyMessages=function(){dragonfly_msgs=[];updateViews();}
this.getDragonflyMessages=function(){return dragonfly_msgs;}
this.getToggled=function(){return toggled;}
var onSettingChange=function(msg){if(msg.id=='console'){switch(msg.key){case 'expand-all-entries':{toggled=[];updateViews();break;}
case 'use-selected-runtime-as-filter':{updateViews();break;}
default:{var is_disabled=!settings[msg.id].get(msg.key);views[msg.key].ishidden_in_menu=is_disabled;topCell.disableTab(msg.key,is_disabled);}}}}
messages.addListener('setting-changed',onSettingChange);var onRuntimeSelecetd=function(msg){var rt=runtimes.getRuntime(msg.id);__selected_rt_url=rt&&rt.uri||'';}
messages.addListener('runtime-selected',onRuntimeSelecetd);};var ErrorConsoleView=function(id,name,container_class,source){container_class=container_class?container_class:'scroll error-console';name=name?name:'missing name '+id;var _expand_all_state=null;var _table_ele=null;this.createView=function(container){var entries=ErrorConsoleData.getMessages(source);var expand_all=settings.console.get('expand-all-entries');if(!_table_ele||!entries.length||expand_all!=_expand_all_state){_expand_all_state=expand_all;this.renderFull(container,entries,expand_all);}
else
{this.renderUpdate(entries.slice(-1),expand_all);}
this.renderFull}
this.renderFull=function(container,messages,expand_all){container.clearAndRender(templates.error_log_table(messages,expand_all,ErrorConsoleData.getToggled(),this.id));_table_ele=container.getElementsByTagName("table")[0];}
this.renderUpdate=function(entries,expandAll){for(var n=0,cur;cur=entries[n];n++){_table_ele.render(templates.error_log_row(cur,expandAll,ErrorConsoleData.getToggled(),this.id));}}
this.ondestroy=function(){delete _table_ele;_table_ele=null;}
this.init(id,name,container_class);}
ErrorConsoleView.prototype=ViewBase;ErrorConsoleView.roughViews=[{id:'console-all',name:ui_strings.M_VIEW_LABEL_ERROR_ALL},{id:'console-script',name:ui_strings.M_VIEW_LABEL_ERROR_SCRIPT,source:'ecmascript'},{id:'console-css',name:ui_strings.M_VIEW_LABEL_ERROR_CSS,source:'css'},{id:'console-java',name:ui_strings.M_VIEW_LABEL_ERROR_JAVA,source:'java'},{id:'console-m2',name:ui_strings.M_VIEW_LABEL_ERROR_M2,source:'m2'},{id:'console-network',name:ui_strings.M_VIEW_LABEL_ERROR_NETWORK,source:'network'},{id:'console-xml',name:ui_strings.M_VIEW_LABEL_ERROR_XML,source:'xml'},{id:'console-html',name:ui_strings.M_VIEW_LABEL_ERROR_HTML,source:'html'},{id:'console-xslt',name:ui_strings.M_VIEW_LABEL_ERROR_XSLT,source:'xslt'},{id:'console-svg',name:ui_strings.M_VIEW_LABEL_ERROR_SVG,source:'svg'},{id:'console-bittorrent',name:ui_strings.M_VIEW_LABEL_ERROR_BITTORRENT,source:'bittorrent'},{id:'console-voice',name:ui_strings.M_VIEW_LABEL_ERROR_VOICE,source:'ecmascript'},{id:'console-widget',name:ui_strings.M_VIEW_LABEL_ERROR_WIDGET,source:'widget'}]
ErrorConsoleView.roughViews.bindClearSource=function(source){return function(event,target){ErrorConsoleData.clear(source);}}
ErrorConsoleView.roughViews.createViews=function(){var r_v=null,i=0,handler_id='';for(;r_v=this[i];i++){new ErrorConsoleView(r_v.id,r_v.name,r_v.container_class,r_v.source);ErrorConsoleData.addView(r_v.id);handler_id='clear-error-console'+(r_v.source?'-'+r_v.source:'');new ToolbarConfig
(r_v.id,[{handler:handler_id,title:ui_strings.S_BUTTON_LABEL_CLEAR_LOG,class_name:'clear-log'}],[{handler:'console-text-search-'+r_v.id,title:ui_strings.S_INPUT_DEFAULT_TEXT_SEARCH}]);new Switches
(r_v.id,['console.expand-all-entries',]);eventHandlers.click[handler_id]=this.bindClearSource(r_v.source?r_v.source:'');(function(){var textSearch=new TextSearch();var view_id=r_v.id;var onViewCreated=function(msg){if(msg.id==view_id){textSearch.setContainer(msg.container);textSearch.setFormInput(views.console.getToolbarControl(msg.container,'console-text-search-'+view_id));}}
var onViewDestroyed=function(msg){if(msg.id==view_id){textSearch.cleanup();}}
messages.addListener('view-created',onViewCreated);messages.addListener('view-destroyed',onViewDestroyed);eventHandlers.input['console-text-search-'+view_id]=function(event,target){textSearch.searchDelayed(target.value);}
eventHandlers.keyup['console-text-search-'+view_id]=function(event,target){if(event.keyCode==13){textSearch.highlight();}}})();}}
ErrorConsoleView.roughViews.createViews();cls.ConsoleDragonflyView=function(id,name,container_class){this.createView=function(container){container.clearAndRender(templates.error_log_messages(ErrorConsoleData.getDragonflyMessages()));container.scrollTop=container.scrollHeight;}
this.init(id,name,container_class);}
cls.ConsoleDragonflyView.prototype=ViewBase;new cls.ConsoleDragonflyView('console-dragonfly',ui_strings.M_VIEW_LABEL_ERROR_DRAGONFLY,'scroll error-console');new ToolbarConfig
('console-dragonfly',[{handler:'clear-error-console-dragonfly',title:ui_strings.S_BUTTON_LABEL_CLEAR_LOG}]);eventHandlers.click['clear-error-console-dragonfly']=function(){ErrorConsoleData.clearDragonflyMessages();}
eventHandlers.click['error-log-list-expand-collapse']=function(event,target){var logid=target.getAttribute("data-logid");ErrorConsoleData.toggleEntry(logid);if(target.hasClass("expanded")){target.parentNode.removeChild(target.nextSibling);target.swapClass("expanded","collapsed");}
else
{var entry=ErrorConsoleData.getMessage(logid);var row=document.render(templates.error_log_detail_row(entry));target.parentNode.insertAfter(row,target);target.swapClass("collapsed","expanded");row.scrollSoftIntoContainerView();}}
cls.ConsoleView=function(id,name,container_class){this.ishidden_in_menu=true;this.createView=function(container){}
this.init(id,name,container_class);}
cls.ConsoleView.prototype=ViewBase;new cls.ConsoleView('console',ui_strings.M_VIEW_LABEL_CONSOLE,'scroll');new Settings
('console',{'console-all':true,'console-script':true,'console-css':true,'console-xml':false,'console-java':false,'console-m2':false,'console-network':false,'console-html':false,'console-xslt':false,'console-svg':false,'console-bittorrent':false,'console-voice':false,'console-widget':false,'console-dragonfly':false,'use-selected-runtime-as-filter':false,'expand-all-entries':false},{'console-all':ui_strings.S_SWITCH_SHOW_TAB_ALL,'console-script':ui_strings.S_SWITCH_SHOW_TAB_SCRIPT,'console-css':ui_strings.S_SWITCH_SHOW_TAB_CSS,'console-xml':ui_strings.S_SWITCH_SHOW_TAB_XML,'console-java':ui_strings.S_SWITCH_SHOW_TAB_JAVA,'console-m2':ui_strings.S_SWITCH_SHOW_TAB_M2,'console-network':ui_strings.S_SWITCH_SHOW_TAB_NETWORK,'console-html':ui_strings.S_SWITCH_SHOW_TAB_HTML,'console-xslt':ui_strings.S_SWITCH_SHOW_TAB_XSLT,'console-svg':ui_strings.S_SWITCH_SHOW_TAB_SVG,'console-bittorrent':ui_strings.S_SWITCH_SHOW_TAB_BITTORRENT,'console-voice':ui_strings.S_SWITCH_SHOW_TAB_VOICE,'console-widget':ui_strings.S_SWITCH_SHOW_TAB_WIDGET,'console-dragonfly':ui_strings.S_SWITCH_SHOW_TAB_DRAGONFLY,'use-selected-runtime-as-filter':' use selected runtime as filter','expand-all-entries':ui_strings.S_SWITCH_EXPAND_ALL},{checkboxes:['console-all','console-script','console-css','console-xml','console-java','console-m2','console-network','console-html','console-xslt','console-svg','console-bittorrent','console-voice','console-widget','console-dragonfly']});window.templates=window.templates||{}
window.templates.error_log_table=function(entries,allExpanded,expandedList,viewId){var rowClosure=function(e){return window.templates.error_log_row(e,allExpanded,expandedList,viewId);}
return["table",["tr",[['th'," "],['th',ui_strings.S_COLUMN_LABEL_FILE],['th',ui_strings.S_COLUMN_LABEL_LINE],['th',ui_strings.S_COLUMN_LABEL_ERROR]]],entries.map(rowClosure)]}
window.templates.error_log_row=function(entry,allExpanded,toggledList,viewId){if(allExpanded){var expanded=true;if(toggledList.indexOf(entry.id)!=-1){expanded=false;}}
else{var expanded=toggledList.indexOf(entry.id)!=-1}
var rows=[["tr",[["td",["button","","type","button","data-logid",entry.id,"data-viewid",viewId]],["td",entry.uri],["td",(entry.line==null?"?":entry.line)],["td",entry.title]],"class",(expanded?"expanded":"collapsed"),"handler","error-log-list-expand-collapse","data-logid",entry.id,"data-viewid",viewId]]
if(expanded){rows.push(templates.error_log_detail_row(entry));}
return rows;}
window.templates.error_log_detail_row=function(entry){return["tr",[["td",["a",entry.uri,"href",entry.uri,"target","_blank"],["pre",entry.description],"colspan","4"]]]}
var cls=window.cls||(window.cls={});
cls.ECMAScriptDebuggerService = function(name){
	var self=this;this.onconnect=function(){this.createAllRuntimes();}
	this.onreceive = function(xml) {
		//alert(arguments.callee.caller);
		if(ini.debug){
			debug.logEvents(xml);
		}
		var is_handled=false;if(tagManager.handleResponse(xml)){
			is_handled=true;
		} else if(events[xml.documentElement.nodeName]){
			events[xml.documentElement.nodeName](xml);is_handled=true;
		}
		if(ini.debug&&!is_handled){debug.output('not implemented: '+new XMLSerializer().serializeToString(xml));}
	}
	this.onquit=function(){}
	var environment={}
	this.getEnvironment=function(){return environment;}
	var events={};
	events['hello'] = function(xml){
		messages.post('host-state',{state:'ready'});var children=xml.documentElement.childNodes,child=null,i=0;for(;child=children[i];i++){environment[child.nodeName]=child.textContent;}
		views.environment.update();if(ini.protocol_version==environment['protocol-version']){
			stop_at.setInitialSettings();self.createAllRuntimes();
		} else {
			viewport.render(['div',['h2','The debugger works with protocol version '+ini.protocol_version+', but the Opera version you are connecting to uses version '+environment['protocol-version'],'class','failed'],'class','info']);
		}
	}
	events['new-script']=function(xml){runtimes.handle(xml);}
	events['handle-event']=function(xml){host_tabs.handleEventHandler(xml);}
	events['runtimes-reply']=runtimes.handleRuntimesReplay;events['runtime-started']=runtimes.handleRuntimeStarted;events['runtime-stopped']=runtimes.handleRuntimeStoped;events['thread-started']=runtimes.handleThreadStarted;events['thread-stopped-at']=runtimes.handleThreadStopedAt;events['thread-finished']=runtimes.handleThreadFinished;this.initBase(name);if(!client){opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'client must be created in ecma debugger.js');return;}
	client.addService(this);var service="ecmascript-debugger";var self=this;var addBreakpointWithSourcePosition=function(script_id,line){var msg="<source-position>";msg+="<script-id>"+script_id+"</script-id>";msg+="<line-number>"+line+"</line-number>"
	msg+="</source-position>";return msg;}
	this.postCommandline=function(msg){var msg=document.getElementById('command-line-debug').getElementsByTagName('textarea')[0].value;this.post(msg);}
	this.addBreakpoint=function(msg_how,id){var msg="<add-breakpoint>";msg+="<breakpoint-id>"+id+"</breakpoint-id>";msg+=msg_how;msg+="</add-breakpoint>";this.post(msg);}
	this.removeBreakpoint=function(id){var msg="<remove-breakpoint>";msg+="<breakpoint-id>"+id+"</breakpoint-id>";msg+="</remove-breakpoint>";this.post(msg);}
	this.setBreakpoint=function(script_id,line_nr,breakpoint_id){self.addBreakpoint(addBreakpointWithSourcePosition(script_id,line_nr),breakpoint_id);}
	this.getRuntime=function(){var msg="<runtimes>";msg+="<tag>"+arguments[0]+"</tag>";var i=1,r_t=0;for(;r_t=arguments[i];i++){msg+="<runtime-id>"+r_t+"</runtime-id>";}
	msg+="</runtimes>";this.post(msg);}
	this.backtrace=function(tag,stopAt){var msg="<backtrace>";msg+="<tag>"+tag+"</tag>";msg+="<runtime-id>"+stopAt['runtime-id']+"</runtime-id>";msg+="<thread-id>"+stopAt['thread-id']+"</thread-id>";msg+="<maxframes>"+ini.max_frames+"</maxframes>";msg+="</backtrace>";this.post(msg);}
	this.__continue=function(stopAt,mode){var msg="<continue>";msg+="<runtime-id>"+stopAt['runtime-id']+"</runtime-id>";msg+="<thread-id>"+stopAt['thread-id']+"</thread-id>";msg+="<mode>"+mode+"</mode>";msg+="</continue>";this.post(msg);}
	this.continue_run=function(rt_id,thread_id){var msg="<continue>";msg+="<runtime-id>"+rt_id+"</runtime-id>";msg+="<thread-id>"+thread_id+"</thread-id>";msg+="<mode>run</mode>";msg+="</continue>";this.post(msg);}
	this.setConfiguration=function(){var msg="<set-configuration>",type='',bol='',i=0;for(;(type=arguments[i++])&&(bol=arguments[i]);i++){msg+="<stop-at>"+(bol=='yes'?"<yes/>":"<no/>")+"<stop-type>"+type+"</stop-type>"+"</stop-at>";}
	msg+="</set-configuration>";this.post(msg);}
	this.addEventHandler=function(id,object_id,event,namespace){var msg="<add-event-handler>"+"<handler-id>"+id+"</handler-id>"+"<object-id>"+object_id+"</object-id>"+"<namespace>"+(namespace?namespace:"null")+"</namespace>"+"<event-type>"+event+"</event-type>"+"</add-event-handler>";this.post(msg);}
	this.removeEventHandler=function(id){var msg="<remove-event-handler>"+"<handler-id>"+id+"</handler-id>"+"</remove-event-handler>";this.post(msg);}
	this.getDocumentFromRuntime=function(tag,runtime){var msg="<eval>"+"<tag>"+tag+"</tag>"+"<runtime-id>"+runtime+"</runtime-id>"+"<thread-id></thread-id>"+"<frame-id></frame-id>"+"<script-data>return window.document</script-data>"+"</eval>";this.post(msg);}
	this.spotlight=function(runtime,node_id,scroll_into_view){var msg="<spotlight-object>"+"<object-id>"+node_id+"</object-id>"+(scroll_into_view?"<scroll-into-view/>":"")+"</spotlight-object>";this.post(msg);}
	this.clearSpotlight=function(runtime){var msg="<spotlight-object>"+"<object-id>0</object-id>"+"</spotlight-object>";this.post(msg);}
	this.examineObjects=function(){var msg="<examine-objects>",i=2;msg+="<tag>"+arguments[0]+"</tag>";msg+="<runtime-id>"+arguments[1]+"</runtime-id>";for(;i<arguments.length;i++){msg+="<object-id>"+arguments[i]+"</object-id>";}
	msg+="</examine-objects>";this.post(msg);}
	this.eval=function(tag,runtime_id,thread_id,frame_id,script_data,name_id_pairs){var msg="<eval>"+"<tag>"+tag+"</tag>"+"<runtime-id>"+runtime_id+"</runtime-id>"+"<thread-id>"+thread_id+"</thread-id>"+"<frame-id>"+frame_id+"</frame-id>"+"<script-data xml:space=\"preserve\"><![CDATA["+script_data+"]]></script-data>";if(name_id_pairs){var i=0,length=name_id_pairs.length;for(;i<length;i++){msg+="<property>"+"<property-name>"+name_id_pairs[i++]+"</property-name>"+"<value-data>"+"<data-type>object-id</data-type>"+"<object-id>"+name_id_pairs[i]+"</object-id>"+"</value-data>"+"</property>";}}
	msg+="</eval>";this.post(msg);}
	this.createAllRuntimes=function(tag){this.post("<runtimes><tag>"+(tag||'')+"</tag><create-all-runtimes/></runtimes>");}
	this.getMatchingCSSRules=function(tag,obj_id,rt_id){var msg="<get-matching-css-rules>"+"<tag>"+tag+"</tag>"+"<runtime-id>"+obj_id+"</runtime-id>"+"<object-id>"+rt_id+"</object-id>"+"</get-matching-css-rules>";this.post(msg);}
	this.inspectDOM=function(tag,obj_id,tarversal,format){var msg="<inspect-dom>"+"<tag>"+tag+"</tag>"+"<object-id>"+obj_id+"</object-id>"+"<traversal>"+tarversal+"</traversal>"+"<format>"+format+"</format>"+"</inspect-dom>";this.post(msg);}
	this.getAllStylesheets=function(tag,rt_id,format){var msg="<css-get-all-stylesheets>"+"<tag>"+tag+"</tag>"+"<runtime-id>"+rt_id+"</runtime-id>"+(format?"<format>json</format>":"")+"</css-get-all-stylesheets>";this.post(msg);}
	this.getCSSRules=function(tag,rt_id,obj_id,format){var msg="<css-get-stylesheet>"+"<tag>"+tag+"</tag>"+"<runtime-id>"+rt_id+"</runtime-id>"+"<stylesheet-id>"+obj_id+"</stylesheet-id>"+(format?"<format>json</format>":"")+"</css-get-stylesheet>";this.post(msg);}
	this.getIndexMap=function(tag,format){var msg="<css-get-index-map>"+"<tag>"+tag+"</tag>"+(format?"<format>json</format>":"")+"</css-get-index-map>";this.post(msg);}
	this.cssGetStyleDeclarations=function(tag,rt_id,obj_id,format){var msg="<css-get-style-declarations>"+"<tag>"+tag+"</tag>"+"<runtime-id>"+rt_id+"</runtime-id>"+"<object-id>"+obj_id+"</object-id>"+(format?"<format>json</format>":"")+"</css-get-style-declarations>";this.post(msg);}
}
cls.ECMAScriptDebuggerService.prototype=ServiceBase;
new cls.ECMAScriptDebuggerService('ecmascript-debugger');

var cls=window.cls||(window.cls={});var cls=window.cls||(window.cls={});cls.HTTPLoggerService=function(name){var self=this;var view="http_logger";this.onreceive=function(xml){if(ini.debug){debug.logEvents(xml);}
if(self[xml.documentElement.nodeName]){self[xml.documentElement.nodeName](xml)}
else
{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+"http-logger not handled: "+new XMLSerializer().serializeToString(xml))}}
this['request']=function(msg){var data=this.parseRequest(msg);HTTPLoggerData.addRequest(data);}
this['response']=function(msg){var data=this.parseResponse(msg);HTTPLoggerData.addResponse(data);}
this.onconnect=function(xml){}
var onAplicationsetup=function(){}
this.parseRequest=function(request){var retval={};var children=request.documentElement.childNodes;for(var n=0,ele;ele=children[n];n++){if(ele.nodeName=="header"){retval.raw=ele.textContent;var hd=this.parseRequestHeader(ele);retval.headers=hd.headers;retval.method=hd.method;retval.path=hd.path;retval.query=hd.query;retval.queryDict=hd.queryDict;retval.protocol=hd.protocol;}
else
{if(ele.nodeName=="time"){retval[ele.nodeName]=Math.round(parseFloat(ele.textContent))}else{retval[ele.nodeName]=ele.textContent;}}}
retval.host=retval.headers.Host;retval.url=retval.headers.Host+retval.path;return retval;}
this.parseResponse=function(response){var retval={};var children=response.documentElement.childNodes;for(var n=0,ele;ele=children[n];n++){if(ele.nodeName=="header"){retval.raw=ele.textContent;var hd=this.parseResponseHeader(ele);if(!hd){opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+"could not parse response header")
continue;}
retval.protocol=hd.protocol;retval.status=hd.status;retval.statusClass=retval.status?retval.status.charAt(0):"0";retval.reason=hd.reason;retval.headers=hd.headers;}
else
{if(ele.nodeName=="time"){retval[ele.nodeName]=Math.round(parseFloat(ele.textContent))}else{retval[ele.nodeName]=ele.textContent;}}}
return retval;}
this.parseRequestHeader=function(ele){var retval={};var txt=ele.textContent;var lines=txt.split("\n");var requestline=lines.shift();reqparts=requestline.match(/(\w*?) (.*) (.*)/);if(!reqparts||reqparts.length!=4){opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+"Could not parse request:\n"+txt);return null;}
retval.method=reqparts[1];retval.query="";retval.path=reqparts[2];var i;if((i=retval.path.indexOf("?"))>0){retval.query=retval.path.slice(i);retval.queryDict={};retval.query.substr(1).split("&").forEach(function(e){var offset=e.indexOf("=");if(offset<1){return}
var key=e.substr(0,offset);var val=e.substr(offset+1);retval.queryDict[key]=val;})
retval.path=retval.path.slice(0,i);}
retval.protocol=reqparts[3];retval.headers=this.parseHeaders(lines);return retval;}
this.parseResponseHeader=function(ele){var retval={};var txt=ele.textContent;var lines=txt.split("\n");var respline=lines.shift();respparts=respline.match(/(\w*?) (\w*?) (.*)/);if(!respparts||respparts.length!=4){opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+"Could not parse response:\n"+respline);return null;}
retval.protocol=respparts[1];retval.status=respparts[2];retval.reason=respparts[3];retval.headers=this.parseHeaders(lines);return retval;}
this.parseHeaders=function(lines){var headers={};var headerList=[];for(var n=0,line;line=lines[n];n++){if(line.indexOf(" ")==0||line.indexOf("\t")==0){value="line".replace(/^[ \t]+/," ");if(headerList.length){old=headerList.pop();headerList.push([old[0],old[1]+value]);}else{opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+"this header is malformed\n"+line)}}
else
{var parts=line.match(/([\w-]*?): (.*)/);if(!parts||parts.length!=3){opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+"Could not parse header!:\n"+line)
continue;}
var name=parts[1];var value=parts[2];headerList.push([name,value]);}}
for(var n=0,tuple;tuple=headerList[n];n++){var name=tuple[0];var value=tuple[1];if(name in headers){if(typeof headers[name]=="string"){headers[name]=[headers[name],parts[1]];}
else
{headers[name].push(value);}}
else
{headers[name]=value;}}
return headers;}
this.initBase(name);if(!client){opera.postError(ui_strings.DRAGONFLY_INFO_MESSAGE+'client does not exist');return;}
client.addService(this);}
cls.HTTPLoggerService.prototype=ServiceBase;new cls.HTTPLoggerService('http-logger');window.HTTPLoggerData=new function(){var requestList=[];var requestMap={};var selectedRequestId=null;var lastModifiedRequestId=null;var activeRuntime=null;_views=["request_info_raw","response_info_raw","request_info_headers","response_info_headers","request_overview","response_info_body","request_list"];this.getLog=function(){return requestList;}
this.getRequestById=function(id){if(id in requestMap){return requestMap[id]}
else{return null}}
this.clearLog=function(){requestList=[];requestMap={};selectedRequestId=null;_updateViews();}
this.clearLogAllButLast=function(){if(requestList.length){var r=requestList.pop();requestList=[r];requestMap={}
requestMap[r.id]=r;}
_updateViews();}
this.addRequest=function(request){var r={id:request["request-id"],"request":request,response:null,duration:null}
requestList.push(r);requestMap[r.id]=r;lastModifiedRequestId=r.id;_updateViews();}
this.addResponse=function(response){var r=requestMap[response["request-id"]];if(r){r.response=response;if(r.request.time&&r.response.time){r.duration=r.response.time-r.request.time;}
else
{r.duration=0;}
lastModifiedRequestId=r.id;_updateViews();}}
this.setSelectedRequestId=function(id){selectedRequestId=id;_updateViews();}
this.clearSelectedRequest=function(){selectedRequestId=null;_updateViews();}
this.getSelectedRequest=function(){if(selectedRequestId&&selectedRequestId in requestMap){return requestMap[selectedRequestId];}
else
{return null;}}
this.getSelectedRequestId=function(){return selectedRequestId;}
this.getLastModifiedRequestId=function(){return lastModifiedRequestId;}
this.onActiveTab=function(msg){var id=msg.activeTab[0];if(activeRuntime==null){activeRuntime=id;}else if(id!=activeRuntime){this.clearLogAllButLast();activeRuntime=id;}else{}}
var _updateViews=function(){for(var n=0,e;e=_views[n];n++){if(e in window.views){window.views[e].update()}}}}
messages.addListener("active-tab",function(msg){HTTPLoggerData.onActiveTab(msg)});cls.RequestListView=function(id,name,container_class){var self=this;this.minUpdateInterval=500;var lastUpdateTime=null;var updateTimer=null;var nextToRendereIndex=null;var keyEntryId=null;var expandedItems=[];var tableBodyEle=null;var viewMap={};new ToolbarConfig
(id,[],[{handler:'http-text-search',title:ui_strings.S_INPUT_DEFAULT_TEXT_SEARCH}]);this.createView=function(container){if(lastUpdateTime&&
(new Date().getTime()-lastUpdateTime)<this.minUpdateInterval){if(!updateTimer){updateTimer=window.setTimeout(function(){self.createView(container)},this.minUpdateInterval);}
return;}
if(updateTimer){window.clearTimeout(updateTimer);updateTimer=null;}
lastUpdateTime=new Date().getTime();this.doCreateView(container);}
this.viewIsValid=function(log){return false;if(log.length&&log[0].id==keyEntryId){return true;}else{if(log.length){keyEntryId=log[0].id}
return false;}}
this.doCreateView=function(container){var log=HTTPLoggerData.getLog();if(!this.viewIsValid(log)){container.clearAndRender(['table',['tbody'],'class','request-table']);nextToRendereIndex=0;}
tableBodyEle=container.getElementsByTagName('tbody')[0];if(log.length){var times=log.map(function(e){return e.response?e.response.time:e.request.time})
var times=times.sort();lastTime=times[times.length-1];}else{lastTime=new Date().getTime();}
var firstTime=log.length?log[0].request.time:lastTime;var isFirst=true;var fun=function(e){var data=window.templates.request_list_row(e,expandedItems,firstTime,lastTime,viewMap,isFirst&log.length>1);isFirst=false;return data;}
var tpls=log.slice(nextToRendereIndex).map(fun);tableBodyEle.render(tpls);nextToRendereIndex=log.length;}
this._getRowForId=function(id){if(!tableBodyEle){return null}
for(var n=0,e;e=tableBodyEle.childNodes[n];n++){if(e.getAttribute('data-requestid')==id){return e;}}
return null;}
this.collapseEntry=function(id){if(!tableBodyEle){return}
for(var n=0,e;e=tableBodyEle.childNodes[n];n++){if(e.getAttribute('data-requestid')==id){e.className=e.className.replace("expanded","collapsed");tableBodyEle.removeChild(e.nextSibling);return}}}
this.expandEntry=function(id){if(!tableBodyEle){return}
for(var n=0,e;e=tableBodyEle.childNodes[n];n++){if(e.getAttribute('data-requestid')==id){var req=HTTPLoggerData.getRequestById(id);var tpl=window.templates.request_details_box(req);var ele=document.render(tpl);if(e.nextSibling){tableBodyEle.insertBefore(ele,e.nextSibling);}
else{tableBodyEle.appendChild(ele);}
e.className=e.className.replace("collapsed","expanded");return;}}}
this.toggleDetails=function(id){var dirty=false;if(expandedItems.indexOf(id)==-1){expandedItems.push(id);dirty=true;}else{expandedItems.splice(expandedItems.indexOf(id),1);}
this.update();if(dirty){var row=this._getRowForId(id).nextSibling
row.scrollSoftIntoContainerView();}}
this.selectDetailView=function(id,name){viewMap[id]=name;this.update();return;var row=this._getRowForId(id);if(!row){return}
row=row.nextSibling;var req=HTTPLoggerData.getRequestById(id);var div=row.getElementsByTagName("div")[0];div.clearAndRender(window.templates.parsed_request_headers(req,"headers"));}
this.ondestroy=function(){keyEntryId=null;}
this.init(id,name,container_class);}
cls.RequestListView.prototype=ViewBase;new cls.RequestListView('request_list',ui_strings.M_VIEW_LABEL_REQUEST_LOG,'scroll');eventHandlers.click['request-list-expand-collapse']=function(event,target){window.views['request_list'].toggleDetails(target.getAttribute("data-requestid"));};eventHandlers.click['select-http-detail-view']=function(event,target){window.views['request_list'].selectDetailView(target.getAttribute("data-requestid"),target.getAttribute("data-viewname"));};(function(){var textSearch=new TextSearch();var onViewCreated=function(msg){if(msg.id=='request_list'){textSearch.setContainer(msg.container);textSearch.setFormInput(views.request_list.getToolbarControl(msg.container,'http-text-search'));}}
var onViewDestroyed=function(msg){if(msg.id=='request_list'){textSearch.cleanup();topCell.statusbar.updateInfo();}}
messages.addListener('view-created',onViewCreated);messages.addListener('view-destroyed',onViewDestroyed);eventHandlers.input['http-text-search']=function(event,target){textSearch.searchDelayed(target.value);}
eventHandlers.keyup['http-text-search']=function(event,target){if(event.keyCode==13){textSearch.highlight();}}})();window.http_header_specification_urls={"Accept":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.1","Accept-Charset":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.2","Accept-Encoding":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.3","Accept-Language":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.4","Accept-Ranges":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.5","Age":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.6","Allow":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.7","Authorization":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.8","Cache-Control":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.9","Connection":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.10","Content-Encoding":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.11","Content-Language":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.12","Content-Length":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.13","Content-Location":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.14","Content-MD5":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.15","Content-Range":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.16","Content-Type":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.17","Date":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.18","Clockless Origin Server Operation":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.18.1","ETag":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.19","Expect":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.20","Expires":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.21","From":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.22","Host":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.23","If-Match":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.24","If-Modified-Since":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.25","If-None-Match":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.26","If-Range":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.27","If-Unmodified-Since":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.28","Last-Modified":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.29","Location":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.30","Max-Forwards":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.31","Pragma":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.32","Proxy-Authenticate":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.33","Proxy-Authorization":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.34","Range":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.35","Byte Ranges":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.35.1","Range Retrieval Requests":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.35.2","Referer":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.36","Retry-After":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.37","Server":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.38","TE":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.39","Trailer":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.40","Transfer-Encoding":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.41","Upgrade":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.42","User-Agent":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.43","Vary":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.44","Via":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.45","Warning":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.46","WWW-Authenticate":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.47","Cookie":"http://www.ietf.org/rfc/rfc2965.txt","Cookie2":"http://www.ietf.org/rfc/rfc2965.txt","Set-Cookie2":"http://www.ietf.org/rfc/rfc2965.txt"}
window.http_method_specification_urls={"options":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.2","get":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.3","head":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.4","post":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.5","put":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.6","delete":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.7","trace":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.8","connect":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.9"}
function http_map_mime_to_type(mime){mime=mime.toLowerCase();if(mime in http_mime_type_map){return http_mime_type_map[mime];}
if(mime.indexOf("image/")==0){return "image";}
if(mime.indexOf("video/")==0){return "video";}
if(mime.indexOf("audio/")==0){return "audio";}
return "unknown";}
window.http_mime_type_map={"text/html":"markup","text/css":"css","application/x-javascript":"javascript","application/xhtml+xml":"markup","application/pdf":"pdf","application/x-shockwave-flash":"flash","application/xml":"xml"}
window.http_file_extension_map={"html":"text/html","htm":"text/html","xml":"application/xml","xhtml":"application/xhtml+xml","xht":"application/xhtml+xml","swf":"application/x-shockwave-flash","png":"image/png","ico":"image/x-icon","gif":"image/gif","jpg":"image/jpeg","jpeg":"image/jpeg","jpe":"image/jpeg","css":"text/css","js":"application/x-javascript"}
function http_get_mime_from_extension(path){var ext=path.split(".").pop().toLowerCase();return http_file_extension_map[ext]||"";}
window.templates=window.templates||(window.templates={});window.templates.header_definition_list=function(headers){var alphaheaders=[];for(name in headers){alphaheaders.push(name)}
alphaheaders=alphaheaders.sort();var dlbody=[];for(var i=0,name;name=alphaheaders[i];i++){var value=headers[name];var dt=['dt',name+": "]
if(name in http_header_specification_urls){dt.push(templates.reference_link(http_header_specification_urls[name]));}
dlbody.push(dt);if(typeof value=="string"){var dd=['dd',value]}
else
{var dd=[];for(var n=0,e;e=value[n];n++){dd.push(['dd',e]);}}
dlbody.push(dd);}
var dl=['dl',dlbody,'class','headerlist'];return dl;}
window.templates.sanitize_url=function(req){var s=req.request.path;if(s==""||s=="/"){return req.request.host;}
var pos=s.lastIndexOf("/");if(pos==s.length-1){return s}
else{return s.slice(pos+1);}}
window.templates.request_list_row=function(r,expandList,firstTime,lastTime,viewMap,isFirst){var expanded=expandList.indexOf(r.id)!=-1;var range=lastTime-firstTime;rangeP=100/range;var cur=r.request.time-firstTime;curP=cur*rangeP;dur=r.response?Math.floor((r.response.time-r.request.time)*rangeP):null
var a=[['tr',['td',["button","","type","button",'data-requestid',r.id,"class","expand-collapse"]],['td',["label","","class",http_map_mime_to_type(http_get_mime_from_extension(r.request.path))]],['td',r.request.method],['td',templates.sanitize_url(r)],['td',(r.response?r.response.status:"-"),'class','status-cell'],['td',(r.response?r.response.reason:"-"),'class','reason-cell'],['td',(r.duration!=undefined?["span",""+r.duration+"ms","style","margin-left: "+Math.floor(curP)+"%; width: "+(dur!=null?dur:50)+"%","class","graph-box"]:""),(isFirst?["span",""+(lastTime-firstTime)+"ms","class","totaltime"]:[]),,'class','time-cell'],'data-requestid',r.id,"handler","request-list-expand-collapse",'class','typeicon mime-'+http_map_mime_to_type(http_get_mime_from_extension(r.request.path))+(expanded?" expanded":" collapsed")+(r.duration==undefined?" in-progress":"")+(r.response?" http-status-"+r.response.statusClass:"")],];if(expanded){a.push(window.templates.request_details_box(r,viewMap[r.id]));}
return a;}
window.templates.request_details_box=function(r,aw){aw=aw||"summary";var content={"summary":window.templates.request_summary,"headers":window.templates.headers_view,"raw":window.templates.response_raw}[aw]||window.templates.request_summary;return['tr',['td',['button',ui_strings.S_BUTTON_SHOW_REQUEST_SUMMARY,"type","button","data-viewname","summary","data-requestid",r.id,"handler","select-http-detail-view"],['button',ui_strings.S_BUTTON_SHOW_REQUEST_HEADERS,"type","button","data-viewname","headers","data-requestid",r.id,"handler","select-http-detail-view"],['button',ui_strings.S_BUTTON_SHOW_REQUEST_RAW,"type","button","data-viewname","raw","data-requestid",r.id,"handler","select-http-detail-view"],["div",content(r)],"colspan","7"]]}
window.templates.response_raw=function(req){return[["h2",ui_strings.M_VIEW_LABEL_RAW_REQUEST_INFO],['code',['pre',(req.request?req.request.raw:ui_strings.S_HTTP_REQUEST_IN_PROGRESS)]],["h2",ui_strings.M_VIEW_LABEL_RAW_RESPONSE_INFO],['code',['pre',(req.response?req.response.raw:ui_strings.S_HTTP_REQUEST_IN_PROGRESS)]]]}
window.templates.headers_view=function(req){return[window.templates.parsed_request_headers(req),window.templates.parsed_response_headers(req)]}
window.templates.parsed_request_headers=function(req){return[["h2",ui_strings.M_VIEW_LABEL_REQUEST_HEADERS],window.templates.header_definition_list(req.request.headers)]}
window.templates.parsed_response_headers=function(req){return[["h2",ui_strings.M_VIEW_LABEL_RESPONSE_HEADERS],req.response?window.templates.header_definition_list(req.response.headers):["span",ui_strings.S_HTTP_REQUEST_IN_PROGRESS]]}
window.templates.request_summary=function(req){pairs=[];for(key in req.request.queryDict){pairs.push([key,req.request.queryDict[key]])}
ret=[["h2",ui_strings.M_VIEW_LABEL_REQUEST_SUMMARY],["dl",[["dt",ui_strings.S_HTTP_LABEL_URL],["dd",(req.request.url+req.request.query)],["dt",ui_strings.S_HTTP_LABEL_RESPONSE],["dd",(req.response?req.response.status+": "+req.response.reason:"-")],["dt",ui_strings.S_HTTP_LABEL_METHOD],["dd",req.request.method+" ",[window.templates.method_spec_link(req)||""]],["dt",ui_strings.S_HTTP_LABEL_HOST],["dd",req.request.headers["Host"||"?"]],["dt",ui_strings.S_HTTP_LABEL_PATH],["dd",req.request.path],["dt",ui_strings.S_HTTP_LABEL_QUERY_ARGS],["dd",(pairs.length?["ul",pairs.sort().map(function(e){return["li",e.join(" = ")]})]:ui_strings.S_NONE)]]]]
return ret;}
window.templates.method_spec_link=function(req){if(req&&req.request.method){var m=req.request.method.toLowerCase();if(m in http_method_specification_urls){return window.templates.reference_link(http_method_specification_urls[m]);}}
return ""}
window.templates.reference_link=function(href,title){return["a"," ","target","_blank","alt","Reference link","href",href,"class","reference-link","title",title||""]}
